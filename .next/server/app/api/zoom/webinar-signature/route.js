(()=>{var a={};a.id=241,a.ids=[241],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8483:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>C,patchFetch:()=>B,routeModule:()=>x,serverHooks:()=>A,workAsyncStorage:()=>y,workUnitAsyncStorage:()=>z});var d={};c.r(d),c.d(d,{POST:()=>w});var e=c(95736),f=c(9117),g=c(4044),h=c(39326),i=c(32324),j=c(261),k=c(54290),l=c(85328),m=c(38928),n=c(46595),o=c(3421),p=c(17679),q=c(41681),r=c(63446),s=c(86439),t=c(51356),u=c(10641),v=c(28225);async function w(a){try{let{meetingNumber:b,role:c=0}=await a.json();if(!b)return u.NextResponse.json({error:"Meeting number is required"},{status:400});let d=process.env.ZOOM_MEETING_SDK_KEY||process.env.ZOOM_SDK_KEY,e=process.env.ZOOM_MEETING_SDK_SECRET||process.env.ZOOM_SDK_SECRET;if(!d||!e)return console.error("Missing Zoom SDK credentials"),u.NextResponse.json({error:"Zoom SDK credentials not configured"},{status:500});let f=Math.round(new Date().getTime()/1e3)-30,g=f+7200,h={iss:d,exp:g,iat:f,aud:"zoom",appKey:d,tokenExp:g,alg:"HS256",mn:b,role:c};console.log("[DEBUG] Generating signature with payload:",{...h,mn:b,role:c});let i=JSON.stringify({alg:"HS256",typ:"JWT"}),j=JSON.stringify(h),k=v.pj.jws.JWS.sign("HS256",i,j,e);return u.NextResponse.json({signature:k,sdkKey:d,meetingNumber:b,role:c})}catch(a){return console.error("Error generating signature:",a),u.NextResponse.json({error:"Failed to generate signature"},{status:500})}}let x=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/zoom/webinar-signature/route",pathname:"/api/zoom/webinar-signature",filename:"route",bundlePath:"app/api/zoom/webinar-signature/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"C:\\Users\\nande\\OneDrive\\Desktop\\projects\\the-school-of-options\\client\\school-of-options\\src\\app\\api\\zoom\\webinar-signature\\route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:y,workUnitAsyncStorage:z,serverHooks:A}=x;function B(){return(0,g.patchFetch)({workAsyncStorage:y,workUnitAsyncStorage:z})}async function C(a,b,c){var d;let e="/api/zoom/webinar-signature/route";"/index"===e&&(e="/");let g=await x.prepare(a,b,{srcPage:e,multiZoneDraftMode:!1});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:y,prerenderManifest:z,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,resolvedPathname:D}=g,E=(0,j.normalizeAppPath)(e),F=!!(z.dynamicRoutes[E]||z.routes[D]);if(F&&!y){let a=!!z.routes[D],b=z.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||x.isDev||y||(G="/index"===(G=D)?"/":G);let H=!0===x.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:z,renderOpts:{experimental:{cacheComponents:!!w.experimental.cacheComponents,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>x.onRequestError(a,b,d,A)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>x.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&B&&C&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await x.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})},A),b}},l=await x.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),y&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(L||b instanceof s.NoFallbackError||await x.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},28225:(a,b)=>{var c,d,e,f={};f.userAgent=!1;var g={},h=h||function(a,b){var c={},d=c.lib={},e=d.Base=function(){function a(){}return{extend:function(b){a.prototype=this;var c=new a;return b&&c.mixIn(b),c.hasOwnProperty("init")||(c.init=function(){c.$super.init.apply(this,arguments)}),c.init.prototype=c,c.$super=this,c},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),f=d.WordArray=e.extend({init:function(a,c){a=this.words=a||[],c!=b?this.sigBytes=c:this.sigBytes=4*a.length},toString:function(a){return(a||h).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes,e=a.sigBytes;if(this.clamp(),d%4)for(var f=0;f<e;f++){var g=c[f>>>2]>>>24-f%4*8&255;b[d+f>>>2]|=g<<24-(d+f)%4*8}else for(var f=0;f<e;f+=4)b[d+f>>>2]=c[f>>>2];return this.sigBytes+=e,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=0xffffffff<<32-c%4*8,b.length=a.ceil(c/4)},clone:function(){var a=e.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;d<b;d+=4)c.push(0x100000000*a.random()|0);return new f.init(c,b)}}),g=c.enc={},h=g.Hex={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push((f>>>4).toString(16)),d.push((15&f).toString(16))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new f.init(c,b/2)}},i=g.Latin1={stringify:function(a){for(var b=a.words,c=a.sigBytes,d=[],e=0;e<c;e++){var f=b[e>>>2]>>>24-e%4*8&255;d.push(String.fromCharCode(f))}return d.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-d%4*8;return new f.init(c,b)}},j=g.Utf8={stringify:function(a){try{return decodeURIComponent(escape(i.stringify(a)))}catch(a){throw Error("Malformed UTF-8 data")}},parse:function(a){return i.parse(unescape(encodeURIComponent(a)))}},k=d.BufferedBlockAlgorithm=e.extend({reset:function(){this._data=new f.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=j.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,g=this.blockSize,h=e/(4*g),i=(h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0))*g,j=a.min(4*i,e);if(i){for(var k=0;k<i;k+=g)this._doProcessBlock(d,k);var l=d.splice(0,i);c.sigBytes-=j}return new f.init(l,j)},clone:function(){var a=e.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=k.extend({cfg:e.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){k.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new l.HMAC.init(a,c).finalize(b)}}});var l=c.algo={};return c}(Math);!function(){var a=h,b=a.lib,c=b.Base,d=b.WordArray,a=a.x64={};a.Word=c.extend({init:function(a,b){this.high=a,this.low=b}}),a.WordArray=c.extend({init:function(a,b){a=this.words=a||[],this.sigBytes=void 0!=b?b:8*a.length},toX32:function(){for(var a=this.words,b=a.length,c=[],e=0;e<b;e++){var f=a[e];c.push(f.high),c.push(f.low)}return d.create(c,this.sigBytes)},clone:function(){for(var a=c.clone.call(this),b=a.words=this.words.slice(0),d=b.length,e=0;e<d;e++)b[e]=b[e].clone();return a}})}(),h.lib.Cipher||function(){var a=h,b=a.lib,c=b.Base,d=b.WordArray,e=b.BufferedBlockAlgorithm,f=a.enc.Base64,g=a.algo.EvpKDF,i=b.Cipher=e.extend({cfg:c.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c),this._xformMode=a,this._key=b,this.reset()},reset:function(){e.reset.call(this),this._doReset()},process:function(a){return this._append(a),this._process()},finalize:function(a){return a&&this._append(a),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(a){return{encrypt:function(b,c,d){return("string"==typeof c?o:n).encrypt(a,b,c,d)},decrypt:function(b,c,d){return("string"==typeof c?o:n).decrypt(a,b,c,d)}}}});b.StreamCipher=i.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var j=a.mode={},k=function(a,b,c){var d=this._iv;d?this._iv=void 0:d=this._prevBlock;for(var e=0;e<c;e++)a[b+e]^=d[e]},l=(b.BlockCipherMode=c.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a,this._iv=b}})).extend();l.Encryptor=l.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize;k.call(this,a,b,d),c.encryptBlock(a,b),this._prevBlock=a.slice(b,b+d)}}),l.Decryptor=l.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,e=a.slice(b,b+d);c.decryptBlock(a,b),k.call(this,a,b,d),this._prevBlock=e}}),j=j.CBC=l,l=(a.pad={}).Pkcs7={pad:function(a,b){for(var c=4*b,c=c-a.sigBytes%c,e=c<<24|c<<16|c<<8|c,f=[],g=0;g<c;g+=4)f.push(e);c=d.create(f,c),a.concat(c)},unpad:function(a){a.sigBytes-=255&a.words[a.sigBytes-1>>>2]}},b.BlockCipher=i.extend({cfg:i.cfg.extend({mode:j,padding:l}),reset:function(){i.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var m=b.CipherParams=c.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),j=(a.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;return((a=a.salt)?d.create([0x53616c74,0x65645f5f]).concat(a).concat(b):b).toString(f)},parse:function(a){var b=(a=f.parse(a)).words;if(0x53616c74==b[0]&&0x65645f5f==b[1]){var c=d.create(b.slice(2,4));b.splice(0,4),a.sigBytes-=16}return m.create({ciphertext:a,salt:c})}},n=b.SerializableCipher=c.extend({cfg:c.extend({format:j}),encrypt:function(a,b,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);return b=e.finalize(b),e=e.cfg,m.create({ciphertext:b,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),a=(a.kdf={}).OpenSSL={execute:function(a,b,c,e){return e||(e=d.random(8)),a=g.create({keySize:b+c}).compute(a,e),c=d.create(a.words.slice(b),4*c),a.sigBytes=4*b,m.create({key:a,iv:c,salt:e})}},o=b.PasswordBasedCipher=n.extend({cfg:n.cfg.extend({kdf:a}),encrypt:function(a,b,c,d){return c=(d=this.cfg.extend(d)).kdf.execute(c,a.keySize,a.ivSize),d.iv=c.iv,(a=n.encrypt.call(this,a,b,c.key,d)).mixIn(c),a},decrypt:function(a,b,c,d){return d=this.cfg.extend(d),b=this._parse(b,d.format),c=d.kdf.execute(c,a.keySize,a.ivSize,b.salt),d.iv=c.iv,n.decrypt.call(this,a,b,c.key,d)}})}(),function(){for(var a=h.lib.BlockCipher,b=h.algo,c=[],d=[],e=[],f=[],g=[],i=[],j=[],k=[],l=[],m=[],n=[],o=0;256>o;o++)n[o]=128>o?o<<1:o<<1^283;for(var p=0,q=0,o=0;256>o;o++){var r=q^q<<1^q<<2^q<<3^q<<4,r=r>>>8^255&r^99;c[p]=r,d[r]=p;var s=n[p],t=n[s],u=n[t],v=257*n[r]^0x1010100*r;e[p]=v<<24|v>>>8,f[p]=v<<16|v>>>16,g[p]=v<<8|v>>>24,i[p]=v,v=0x1010101*u^65537*t^257*s^0x1010100*p,j[r]=v<<24|v>>>8,k[r]=v<<16|v>>>16,l[r]=v<<8|v>>>24,m[r]=v,p?(p=s^n[n[n[u^s]]],q^=n[n[q]]):p=q=1}var w=[0,1,2,4,8,16,32,64,128,27,54],b=b.AES=a.extend({_doReset:function(){for(var a=this._key,b=a.words,d=a.sigBytes/4,a=4*((this._nRounds=d+6)+1),e=this._keySchedule=[],f=0;f<a;f++)if(f<d)e[f]=b[f];else{var g=e[f-1];f%d?6<d&&4==f%d&&(g=c[g>>>24]<<24|c[g>>>16&255]<<16|c[g>>>8&255]<<8|c[255&g]):g=(c[(g=g<<8|g>>>24)>>>24]<<24|c[g>>>16&255]<<16|c[g>>>8&255]<<8|c[255&g])^w[f/d|0]<<24,e[f]=e[f-d]^g}for(d=0,b=this._invKeySchedule=[];d<a;d++)f=a-d,g=d%4?e[f]:e[f-4],b[d]=4>d||4>=f?g:j[c[g>>>24]]^k[c[g>>>16&255]]^l[c[g>>>8&255]]^m[c[255&g]]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,e,f,g,i,c)},decryptBlock:function(a,b){var c=a[b+1];a[b+1]=a[b+3],a[b+3]=c,this._doCryptBlock(a,b,this._invKeySchedule,j,k,l,m,d),c=a[b+1],a[b+1]=a[b+3],a[b+3]=c},_doCryptBlock:function(a,b,c,d,e,f,g,h){for(var i=this._nRounds,j=a[b]^c[0],k=a[b+1]^c[1],l=a[b+2]^c[2],m=a[b+3]^c[3],n=4,o=1;o<i;o++)var p=d[j>>>24]^e[k>>>16&255]^f[l>>>8&255]^g[255&m]^c[n++],q=d[k>>>24]^e[l>>>16&255]^f[m>>>8&255]^g[255&j]^c[n++],r=d[l>>>24]^e[m>>>16&255]^f[j>>>8&255]^g[255&k]^c[n++],m=d[m>>>24]^e[j>>>16&255]^f[k>>>8&255]^g[255&l]^c[n++],j=p,k=q,l=r;p=(h[j>>>24]<<24|h[k>>>16&255]<<16|h[l>>>8&255]<<8|h[255&m])^c[n++],q=(h[k>>>24]<<24|h[l>>>16&255]<<16|h[m>>>8&255]<<8|h[255&j])^c[n++],r=(h[l>>>24]<<24|h[m>>>16&255]<<16|h[j>>>8&255]<<8|h[255&k])^c[n++],m=(h[m>>>24]<<24|h[j>>>16&255]<<16|h[k>>>8&255]<<8|h[255&l])^c[n++],a[b]=p,a[b+1]=q,a[b+2]=r,a[b+3]=m},keySize:8});h.AES=a._createHelper(b)}(),function(){function a(a,b){var c=(this._lBlock>>>a^this._rBlock)&b;this._rBlock^=c,this._lBlock^=c<<a}function b(a,b){var c=(this._rBlock>>>a^this._lBlock)&b;this._lBlock^=c,this._rBlock^=c<<a}var c=h.lib,d=c.WordArray,c=c.BlockCipher,e=h.algo,f=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],g=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],i=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],j=[{0:8421888,0x10000000:32768,0x20000000:8421378,0x30000000:2,0x40000000:512,0x50000000:8421890,0x60000000:8389122,0x70000000:8388608,0x80000000:514,0x90000000:8389120,0xa0000000:33280,0xb0000000:8421376,0xc0000000:32770,0xd0000000:8388610,0xe0000000:0,0xf0000000:33282,0x8000000:0,0x18000000:8421890,0x28000000:33282,0x38000000:32768,0x48000000:8421888,0x58000000:512,0x68000000:8421378,0x78000000:2,0x88000000:8389120,0x98000000:33280,0xa8000000:8421376,0xb8000000:8389122,0xc8000000:8388610,0xd8000000:32770,0xe8000000:514,0xf8000000:8388608,1:32768,0x10000001:2,0x20000001:8421888,0x30000001:8388608,0x40000001:8421378,0x50000001:33280,0x60000001:512,0x70000001:8389122,0x80000001:8421890,0x90000001:8421376,0xa0000001:8388610,0xb0000001:33282,0xc0000001:514,0xd0000001:8389120,0xe0000001:32770,0xf0000001:0,0x8000001:8421890,0x18000001:8421376,0x28000001:8388608,0x38000001:512,0x48000001:32768,0x58000001:8388610,0x68000001:2,0x78000001:33282,0x88000001:32770,0x98000001:8389122,0xa8000001:514,0xb8000001:8421888,0xc8000001:8389120,0xd8000001:0,0xe8000001:33280,0xf8000001:8421378},{0:0x40084010,0x1000000:16384,0x2000000:524288,0x3000000:0x40080010,0x4000000:0x40000010,0x5000000:0x40084000,0x6000000:0x40004000,0x7000000:16,0x8000000:540672,0x9000000:0x40004010,0xa000000:0x40000000,0xb000000:540688,0xc000000:524304,0xd000000:0,0xe000000:16400,0xf000000:0x40080000,8388608:0x40004000,0x1800000:540688,0x2800000:16,0x3800000:0x40004010,0x4800000:0x40084010,0x5800000:0x40000000,0x6800000:524288,0x7800000:0x40080010,0x8800000:524304,0x9800000:0,0xa800000:16384,0xb800000:0x40080000,0xc800000:0x40000010,0xd800000:540672,0xe800000:0x40084000,0xf800000:16400,0x10000000:0,0x11000000:0x40080010,0x12000000:0x40004010,0x13000000:0x40084000,0x14000000:0x40080000,0x15000000:16,0x16000000:540688,0x17000000:16384,0x18000000:16400,0x19000000:524288,0x1a000000:524304,0x1b000000:0x40000010,0x1c000000:540672,0x1d000000:0x40004000,0x1e000000:0x40000000,0x1f000000:0x40084010,0x10800000:540688,0x11800000:524288,0x12800000:0x40080000,0x13800000:16384,0x14800000:0x40004000,0x15800000:0x40084010,0x16800000:16,0x17800000:0x40000000,0x18800000:0x40084000,0x19800000:0x40000010,0x1a800000:0x40004010,0x1b800000:524304,0x1c800000:0,0x1d800000:16400,0x1e800000:0x40080010,0x1f800000:540672},{0:260,1048576:0,2097152:0x4000100,3145728:65796,4194304:65540,5242880:0x4000004,6291456:0x4010104,7340032:0x4010000,8388608:0x4000000,9437184:0x4010100,0xa00000:65792,0xb00000:0x4010004,0xc00000:0x4000104,0xd00000:65536,0xe00000:4,0xf00000:256,524288:0x4010100,1572864:0x4010004,2621440:0,3670016:0x4000100,4718592:0x4000004,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,0xa80000:0x4010000,0xb80000:65796,0xc80000:65792,0xd80000:0x4000104,0xe80000:0x4010104,0xf80000:0x4000000,0x1000000:0x4010100,0x1100000:65540,0x1200000:65536,0x1300000:0x4000100,0x1400000:256,0x1500000:0x4010104,0x1600000:0x4000004,0x1700000:0,0x1800000:0x4000104,0x1900000:0x4000000,0x1a00000:4,0x1b00000:65792,0x1c00000:0x4010000,0x1d00000:260,0x1e00000:65796,0x1f00000:0x4010004,0x1080000:0x4000000,0x1180000:260,0x1280000:0x4010100,0x1380000:0,0x1480000:65540,0x1580000:0x4000100,0x1680000:256,0x1780000:0x4010004,0x1880000:65536,0x1980000:0x4010104,0x1a80000:65796,0x1b80000:0x4000004,0x1c80000:0x4000104,0x1d80000:0x4010000,0x1e80000:4,0x1f80000:65792},{0:0x80401000,65536:0x80001040,131072:4198464,196608:0x80400000,262144:0,327680:4198400,393216:0x80000040,458752:4194368,524288:0x80000000,589824:4194304,655360:64,720896:0x80001000,786432:0x80400040,851968:4160,917504:4096,983040:0x80401040,32768:0x80001040,98304:64,163840:0x80400040,229376:0x80001000,294912:4198400,360448:0x80401040,425984:0,491520:0x80400000,557056:4096,622592:0x80401000,688128:4194304,753664:4160,819200:0x80000000,884736:4194368,950272:4198464,1015808:0x80000040,1048576:4194368,1114112:4198400,1179648:0x80000040,1245184:0,1310720:4160,1376256:0x80400040,1441792:0x80401000,1507328:0x80001040,1572864:0x80401040,1638400:0x80000000,1703936:0x80400000,1769472:4198464,1835008:0x80001000,1900544:4194304,1966080:64,2031616:4096,1081344:0x80400000,1146880:0x80401040,1212416:0,1277952:4198400,1343488:4194368,1409024:0x80000000,1474560:0x80001040,1540096:64,1605632:0x80000040,1671168:4096,1736704:0x80001000,1802240:0x80400040,1867776:4160,1933312:0x80401000,1998848:4194304,2064384:4198464},{0:128,4096:0x1040000,8192:262144,12288:0x20000000,16384:0x20040080,20480:0x1000080,24576:0x21000080,28672:262272,32768:0x1000000,36864:0x20040000,40960:0x20000080,45056:0x21040080,49152:0x21040000,53248:0,57344:0x1040080,61440:0x21000000,2048:0x1040080,6144:0x21000080,10240:128,14336:0x1040000,18432:262144,22528:0x20040080,26624:0x21040000,30720:0x20000000,34816:0x20040000,38912:0,43008:0x21040080,47104:0x1000080,51200:0x20000080,55296:0x21000000,59392:0x1000000,63488:262272,65536:262144,69632:128,73728:0x20000000,77824:0x21000080,81920:0x1000080,86016:0x21040000,90112:0x20040080,94208:0x1000000,98304:0x21040080,102400:0x21000000,106496:0x1040000,110592:0x20040000,114688:262272,118784:0x20000080,122880:0,126976:0x1040080,67584:0x21000080,71680:0x1000000,75776:0x1040000,79872:0x20040080,83968:0x20000000,88064:0x1040080,92160:128,96256:0x21040000,100352:262272,104448:0x21040080,108544:0,112640:0x21000000,116736:0x1000080,120832:262144,124928:0x20040000,129024:0x20000080},{0:0x10000008,256:8192,512:0x10200000,768:0x10202008,1024:0x10002000,1280:2097152,1536:2097160,1792:0x10000000,2048:0,2304:0x10002008,2560:2105344,2816:8,3072:0x10200008,3328:2105352,3584:8200,3840:0x10202000,128:0x10200000,384:0x10202008,640:8,896:2097152,1152:2105352,1408:0x10000008,1664:0x10002000,1920:8200,2176:2097160,2432:8192,2688:0x10002008,2944:0x10200008,3200:0,3456:0x10202000,3712:2105344,3968:0x10000000,4096:0x10002000,4352:0x10200008,4608:0x10202008,4864:8200,5120:2097152,5376:0x10000000,5632:0x10000008,5888:2105344,6144:2105352,6400:0,6656:8,6912:0x10200000,7168:8192,7424:0x10002008,7680:0x10202000,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:0x10000008,5248:0x10002000,5504:8200,5760:0x10202008,6016:0x10200000,6272:0x10202000,6528:0x10200008,6784:8192,7040:2105352,7296:2097160,7552:0,7808:0x10000000,8064:0x10002008},{0:1048576,16:0x2000401,32:1024,48:1049601,64:0x2100401,80:0,96:1,112:0x2100001,128:0x2000400,144:1048577,160:0x2000001,176:0x2100400,192:0x2100000,208:1025,224:1049600,240:0x2000000,8:0x2100001,24:0,40:0x2000401,56:0x2100400,72:1048576,88:0x2000001,104:0x2000000,120:1025,136:1049601,152:0x2000400,168:0x2100000,184:1048577,200:1024,216:0x2100401,232:1,248:1049600,256:0x2000000,272:1048576,288:0x2000401,304:0x2100001,320:1048577,336:0x2000400,352:0x2100400,368:1049601,384:1025,400:0x2100401,416:1049600,432:1,448:0,464:0x2100000,480:0x2000001,496:1024,264:1049600,280:0x2000401,296:0x2100001,312:1,328:0x2000000,344:1048576,360:1025,376:0x2100400,392:0x2000001,408:0x2100000,424:0,440:0x2100401,456:1049601,472:1024,488:0x2000400,504:1048577},{0:0x8000820,1:131072,2:0x8000000,3:32,4:131104,5:0x8020820,6:0x8020800,7:2048,8:0x8020000,9:0x8000800,10:133120,11:0x8020020,12:2080,13:0,14:0x8000020,15:133152,0x80000000:2048,0x80000001:0x8020820,0x80000002:0x8000820,0x80000003:0x8000000,0x80000004:0x8020000,0x80000005:133120,0x80000006:133152,0x80000007:32,0x80000008:0x8000020,0x80000009:2080,0x8000000a:131104,0x8000000b:0x8020800,0x8000000c:0,0x8000000d:0x8020020,0x8000000e:0x8000800,0x8000000f:131072,16:133152,17:0x8020800,18:32,19:2048,20:0x8000800,21:0x8000020,22:0x8020020,23:131072,24:0,25:131104,26:0x8020000,27:0x8000820,28:0x8020820,29:133120,30:2080,31:0x8000000,0x80000010:131072,0x80000011:2048,0x80000012:0x8020020,0x80000013:133152,0x80000014:32,0x80000015:0x8020000,0x80000016:0x8000000,0x80000017:0x8000820,0x80000018:0x8020820,0x80000019:0x8000020,0x8000001a:0x8000800,0x8000001b:0,0x8000001c:133120,0x8000001d:2080,0x8000001e:131104,0x8000001f:0x8020800}],k=[0xf8000001,0x1f800000,0x1f80000,2064384,129024,8064,504,0x8000001f],l=e.DES=c.extend({_doReset:function(){for(var a=this._key.words,b=[],c=0;56>c;c++){var d=f[c]-1;b[c]=a[d>>>5]>>>31-d%32&1}for(d=0,a=this._subKeys=[];16>d;d++){for(var e=a[d]=[],h=i[d],c=0;24>c;c++)e[c/6|0]|=b[(g[c]-1+h)%28]<<31-c%6,e[4+(c/6|0)]|=b[28+(g[c+24]-1+h)%28]<<31-c%6;for(c=1,e[0]=e[0]<<1|e[0]>>>31;7>c;c++)e[c]>>>=4*(c-1)+3;e[7]=e[7]<<5|e[7]>>>27}for(c=0,b=this._invSubKeys=[];16>c;c++)b[c]=a[15-c]},encryptBlock:function(a,b){this._doCryptBlock(a,b,this._subKeys)},decryptBlock:function(a,b){this._doCryptBlock(a,b,this._invSubKeys)},_doCryptBlock:function(c,d,e){this._lBlock=c[d],this._rBlock=c[d+1],a.call(this,4,0xf0f0f0f),a.call(this,16,65535),b.call(this,2,0x33333333),b.call(this,8,0xff00ff),a.call(this,1,0x55555555);for(var f=0;16>f;f++){for(var g=e[f],h=this._lBlock,i=this._rBlock,l=0,m=0;8>m;m++)l|=j[m][((i^g[m])&k[m])>>>0];this._lBlock=i,this._rBlock=h^l}e=this._lBlock,this._lBlock=this._rBlock,this._rBlock=e,a.call(this,1,0x55555555),b.call(this,8,0xff00ff),b.call(this,2,0x33333333),a.call(this,16,65535),a.call(this,4,0xf0f0f0f),c[d]=this._lBlock,c[d+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});h.DES=c._createHelper(l),e=e.TripleDES=c.extend({_doReset:function(){var a=this._key.words;this._des1=l.createEncryptor(d.create(a.slice(0,2))),this._des2=l.createEncryptor(d.create(a.slice(2,4))),this._des3=l.createEncryptor(d.create(a.slice(4,6)))},encryptBlock:function(a,b){this._des1.encryptBlock(a,b),this._des2.decryptBlock(a,b),this._des3.encryptBlock(a,b)},decryptBlock:function(a,b){this._des3.decryptBlock(a,b),this._des2.encryptBlock(a,b),this._des1.decryptBlock(a,b)},keySize:6,ivSize:2,blockSize:2}),h.TripleDES=c._createHelper(e)}(),function(){var a=h.lib.WordArray;h.enc.Base64={stringify:function(a){var b=a.words,c=a.sigBytes,d=this._map;a.clamp(),a=[];for(var e=0;e<c;e+=3)for(var f=(b[e>>>2]>>>24-e%4*8&255)<<16|(b[e+1>>>2]>>>24-(e+1)%4*8&255)<<8|b[e+2>>>2]>>>24-(e+2)%4*8&255,g=0;4>g&&e+.75*g<c;g++)a.push(d.charAt(f>>>6*(3-g)&63));if(b=d.charAt(64))for(;a.length%4;)a.push(b);return a.join("")},parse:function(b){var c=b.length,d=this._map,e=d.charAt(64);e&&-1!=(e=b.indexOf(e))&&(c=e);for(var e=[],f=0,g=0;g<c;g++)if(g%4){var h=d.indexOf(b.charAt(g-1))<<g%4*2,i=d.indexOf(b.charAt(g))>>>6-g%4*2;e[f>>>2]|=(h|i)<<24-f%4*8,f++}return a.create(e,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(a){function b(a,b,c,d,e,f,g){return((a=a+(b&c|~b&d)+e+g)<<f|a>>>32-f)+b}function c(a,b,c,d,e,f,g){return((a=a+(b&d|c&~d)+e+g)<<f|a>>>32-f)+b}function d(a,b,c,d,e,f,g){return((a=a+(b^c^d)+e+g)<<f|a>>>32-f)+b}function e(a,b,c,d,e,f,g){return((a=a+(c^(b|~d))+e+g)<<f|a>>>32-f)+b}for(var f=h.lib,g=f.WordArray,i=f.Hasher,f=h.algo,j=[],k=0;64>k;k++)j[k]=0x100000000*a.abs(a.sin(k+1))|0;f=f.MD5=i.extend({_doReset:function(){this._hash=new g.init([0x67452301,0xefcdab89,0x98badcfe,0x10325476])},_doProcessBlock:function(a,f){for(var g=0;16>g;g++){var h=f+g,i=a[h];a[h]=(i<<8|i>>>24)&0xff00ff|(i<<24|i>>>8)&0xff00ff00}var g=this._hash.words,h=a[f+0],i=a[f+1],k=a[f+2],l=a[f+3],m=a[f+4],n=a[f+5],o=a[f+6],p=a[f+7],q=a[f+8],r=a[f+9],s=a[f+10],t=a[f+11],u=a[f+12],v=a[f+13],w=a[f+14],x=a[f+15],y=g[0],z=g[1],A=g[2],B=g[3],y=b(y,z,A,B,h,7,j[0]),B=b(B,y,z,A,i,12,j[1]),A=b(A,B,y,z,k,17,j[2]),z=b(z,A,B,y,l,22,j[3]),y=b(y,z,A,B,m,7,j[4]),B=b(B,y,z,A,n,12,j[5]),A=b(A,B,y,z,o,17,j[6]),z=b(z,A,B,y,p,22,j[7]),y=b(y,z,A,B,q,7,j[8]),B=b(B,y,z,A,r,12,j[9]),A=b(A,B,y,z,s,17,j[10]),z=b(z,A,B,y,t,22,j[11]),y=b(y,z,A,B,u,7,j[12]),B=b(B,y,z,A,v,12,j[13]),A=b(A,B,y,z,w,17,j[14]),z=b(z,A,B,y,x,22,j[15]),y=c(y,z,A,B,i,5,j[16]),B=c(B,y,z,A,o,9,j[17]),A=c(A,B,y,z,t,14,j[18]),z=c(z,A,B,y,h,20,j[19]),y=c(y,z,A,B,n,5,j[20]),B=c(B,y,z,A,s,9,j[21]),A=c(A,B,y,z,x,14,j[22]),z=c(z,A,B,y,m,20,j[23]),y=c(y,z,A,B,r,5,j[24]),B=c(B,y,z,A,w,9,j[25]),A=c(A,B,y,z,l,14,j[26]),z=c(z,A,B,y,q,20,j[27]),y=c(y,z,A,B,v,5,j[28]),B=c(B,y,z,A,k,9,j[29]),A=c(A,B,y,z,p,14,j[30]),z=c(z,A,B,y,u,20,j[31]),y=d(y,z,A,B,n,4,j[32]),B=d(B,y,z,A,q,11,j[33]),A=d(A,B,y,z,t,16,j[34]),z=d(z,A,B,y,w,23,j[35]),y=d(y,z,A,B,i,4,j[36]),B=d(B,y,z,A,m,11,j[37]),A=d(A,B,y,z,p,16,j[38]),z=d(z,A,B,y,s,23,j[39]),y=d(y,z,A,B,v,4,j[40]),B=d(B,y,z,A,h,11,j[41]),A=d(A,B,y,z,l,16,j[42]),z=d(z,A,B,y,o,23,j[43]),y=d(y,z,A,B,r,4,j[44]),B=d(B,y,z,A,u,11,j[45]),A=d(A,B,y,z,x,16,j[46]),z=d(z,A,B,y,k,23,j[47]),y=e(y,z,A,B,h,6,j[48]),B=e(B,y,z,A,p,10,j[49]),A=e(A,B,y,z,w,15,j[50]),z=e(z,A,B,y,n,21,j[51]),y=e(y,z,A,B,u,6,j[52]),B=e(B,y,z,A,l,10,j[53]),A=e(A,B,y,z,s,15,j[54]),z=e(z,A,B,y,i,21,j[55]),y=e(y,z,A,B,q,6,j[56]),B=e(B,y,z,A,x,10,j[57]),A=e(A,B,y,z,o,15,j[58]),z=e(z,A,B,y,v,21,j[59]),y=e(y,z,A,B,m,6,j[60]),B=e(B,y,z,A,t,10,j[61]),A=e(A,B,y,z,k,15,j[62]),z=e(z,A,B,y,r,21,j[63]);g[0]=g[0]+y|0,g[1]=g[1]+z|0,g[2]=g[2]+A|0,g[3]=g[3]+B|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;c[e>>>5]|=128<<24-e%32;var f=a.floor(d/0x100000000);for(c[(e+64>>>9<<4)+15]=(f<<8|f>>>24)&0xff00ff|(f<<24|f>>>8)&0xff00ff00,c[(e+64>>>9<<4)+14]=(d<<8|d>>>24)&0xff00ff|(d<<24|d>>>8)&0xff00ff00,b.sigBytes=4*(c.length+1),this._process(),c=(b=this._hash).words,d=0;4>d;d++)e=c[d],c[d]=(e<<8|e>>>24)&0xff00ff|(e<<24|e>>>8)&0xff00ff00;return b},clone:function(){var a=i.clone.call(this);return a._hash=this._hash.clone(),a}}),h.MD5=i._createHelper(f),h.HmacMD5=i._createHmacHelper(f)}(Math),function(){var a=h.lib,b=a.WordArray,c=a.Hasher,d=[],a=h.algo.SHA1=c.extend({_doReset:function(){this._hash=new b.init([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0])},_doProcessBlock:function(a,b){for(var c=this._hash.words,e=c[0],f=c[1],g=c[2],h=c[3],i=c[4],j=0;80>j;j++){if(16>j)d[j]=0|a[b+j];else{var k=d[j-3]^d[j-8]^d[j-14]^d[j-16];d[j]=k<<1|k>>>31}k=(e<<5|e>>>27)+i+d[j],k=20>j?k+((f&g|~f&h)+0x5a827999):40>j?k+((f^g^h)+0x6ed9eba1):60>j?k+((f&g|f&h|g&h)-0x70e44324):k+((f^g^h)-0x359d3e2a),i=h,h=g,g=f<<30|f>>>2,f=e,e=k}c[0]=c[0]+e|0,c[1]=c[1]+f|0,c[2]=c[2]+g|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=Math.floor(c/0x100000000),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=c.clone.call(this);return a._hash=this._hash.clone(),a}});h.SHA1=c._createHelper(a),h.HmacSHA1=c._createHmacHelper(a)}(),function(a){for(var b,c=h.lib,d=c.WordArray,e=c.Hasher,c=h.algo,f=[],g=[],i=function(a){return 0x100000000*(a-(0|a))|0},j=2,k=0;64>k;){a:{b=j;for(var l=a.sqrt(b),m=2;m<=l;m++)if(!(b%m)){b=!1;break a}b=!0}b&&(8>k&&(f[k]=i(a.pow(j,.5))),g[k]=i(a.pow(j,1/3)),k++),j++}var n=[],c=c.SHA256=e.extend({_doReset:function(){this._hash=new d.init(f.slice(0))},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],f=c[2],h=c[3],i=c[4],j=c[5],k=c[6],l=c[7],m=0;64>m;m++){if(16>m)n[m]=0|a[b+m];else{var o=n[m-15],p=n[m-2];n[m]=((o<<25|o>>>7)^(o<<14|o>>>18)^o>>>3)+n[m-7]+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+n[m-16]}o=l+((i<<26|i>>>6)^(i<<21|i>>>11)^(i<<7|i>>>25))+(i&j^~i&k)+g[m]+n[m],p=((d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22))+(d&e^d&f^e&f),l=k,k=j,j=i,i=h+o|0,h=f,f=e,e=d,d=o+p|0}c[0]=c[0]+d|0,c[1]=c[1]+e|0,c[2]=c[2]+f|0,c[3]=c[3]+h|0,c[4]=c[4]+i|0,c[5]=c[5]+j|0,c[6]=c[6]+k|0,c[7]=c[7]+l|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,e=8*b.sigBytes;return c[e>>>5]|=128<<24-e%32,c[(e+64>>>9<<4)+14]=a.floor(d/0x100000000),c[(e+64>>>9<<4)+15]=d,b.sigBytes=4*c.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});h.SHA256=e._createHelper(c),h.HmacSHA256=e._createHmacHelper(c)}(Math),function(){var a=h.lib.WordArray,b=h.algo,c=b.SHA256,b=b.SHA224=c.extend({_doReset:function(){this._hash=new a.init([0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4])},_doFinalize:function(){var a=c._doFinalize.call(this);return a.sigBytes-=4,a}});h.SHA224=c._createHelper(b),h.HmacSHA224=c._createHmacHelper(b)}(),function(){function a(){return d.create.apply(d,arguments)}for(var b=h.lib.Hasher,c=h.x64,d=c.Word,e=c.WordArray,c=h.algo,f=[a(0x428a2f98,0xd728ae22),a(0x71374491,0x23ef65cd),a(0xb5c0fbcf,0xec4d3b2f),a(0xe9b5dba5,0x8189dbbc),a(0x3956c25b,0xf348b538),a(0x59f111f1,0xb605d019),a(0x923f82a4,0xaf194f9b),a(0xab1c5ed5,0xda6d8118),a(0xd807aa98,0xa3030242),a(0x12835b01,0x45706fbe),a(0x243185be,0x4ee4b28c),a(0x550c7dc3,0xd5ffb4e2),a(0x72be5d74,0xf27b896f),a(0x80deb1fe,0x3b1696b1),a(0x9bdc06a7,0x25c71235),a(0xc19bf174,0xcf692694),a(0xe49b69c1,0x9ef14ad2),a(0xefbe4786,0x384f25e3),a(0xfc19dc6,0x8b8cd5b5),a(0x240ca1cc,0x77ac9c65),a(0x2de92c6f,0x592b0275),a(0x4a7484aa,0x6ea6e483),a(0x5cb0a9dc,0xbd41fbd4),a(0x76f988da,0x831153b5),a(0x983e5152,0xee66dfab),a(0xa831c66d,0x2db43210),a(0xb00327c8,0x98fb213f),a(0xbf597fc7,0xbeef0ee4),a(0xc6e00bf3,0x3da88fc2),a(0xd5a79147,0x930aa725),a(0x6ca6351,0xe003826f),a(0x14292967,0xa0e6e70),a(0x27b70a85,0x46d22ffc),a(0x2e1b2138,0x5c26c926),a(0x4d2c6dfc,0x5ac42aed),a(0x53380d13,0x9d95b3df),a(0x650a7354,0x8baf63de),a(0x766a0abb,0x3c77b2a8),a(0x81c2c92e,0x47edaee6),a(0x92722c85,0x1482353b),a(0xa2bfe8a1,0x4cf10364),a(0xa81a664b,0xbc423001),a(0xc24b8b70,0xd0f89791),a(0xc76c51a3,0x654be30),a(0xd192e819,0xd6ef5218),a(0xd6990624,0x5565a910),a(0xf40e3585,0x5771202a),a(0x106aa070,0x32bbd1b8),a(0x19a4c116,0xb8d2d0c8),a(0x1e376c08,0x5141ab53),a(0x2748774c,0xdf8eeb99),a(0x34b0bcb5,0xe19b48a8),a(0x391c0cb3,0xc5c95a63),a(0x4ed8aa4a,0xe3418acb),a(0x5b9cca4f,0x7763e373),a(0x682e6ff3,0xd6b2b8a3),a(0x748f82ee,0x5defb2fc),a(0x78a5636f,0x43172f60),a(0x84c87814,0xa1f0ab72),a(0x8cc70208,0x1a6439ec),a(0x90befffa,0x23631e28),a(0xa4506ceb,0xde82bde9),a(0xbef9a3f7,0xb2c67915),a(0xc67178f2,0xe372532b),a(0xca273ece,0xea26619c),a(0xd186b8c7,0x21c0c207),a(0xeada7dd6,0xcde0eb1e),a(0xf57d4f7f,0xee6ed178),a(0x6f067aa,0x72176fba),a(0xa637dc5,0xa2c898a6),a(0x113f9804,0xbef90dae),a(0x1b710b35,0x131c471b),a(0x28db77f5,0x23047d84),a(0x32caab7b,0x40c72493),a(0x3c9ebe0a,0x15c9bebc),a(0x431d67c4,0x9c100d4c),a(0x4cc5d4be,0xcb3e42b6),a(0x597f299c,0xfc657e2a),a(0x5fcb6fab,0x3ad6faec),a(0x6c44198c,0x4a475817)],g=[],i=0;80>i;i++)g[i]=a();c=c.SHA512=b.extend({_doReset:function(){this._hash=new e.init([new d.init(0x6a09e667,0xf3bcc908),new d.init(0xbb67ae85,0x84caa73b),new d.init(0x3c6ef372,0xfe94f82b),new d.init(0xa54ff53a,0x5f1d36f1),new d.init(0x510e527f,0xade682d1),new d.init(0x9b05688c,0x2b3e6c1f),new d.init(0x1f83d9ab,0xfb41bd6b),new d.init(0x5be0cd19,0x137e2179)])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],h=c[2],i=c[3],j=c[4],k=c[5],l=c[6],c=c[7],m=d.high,n=d.low,o=e.high,p=e.low,q=h.high,r=h.low,s=i.high,t=i.low,u=j.high,v=j.low,w=k.high,x=k.low,y=l.high,z=l.low,A=c.high,B=c.low,C=m,D=n,E=o,F=p,G=q,H=r,I=s,J=t,K=u,L=v,M=w,N=x,O=y,P=z,Q=A,R=B,S=0;80>S;S++){var T=g[S];if(16>S)var U=T.high=0|a[b+2*S],V=T.low=0|a[b+2*S+1];else{var U=g[S-15],V=U.high,W=U.low,U=(V>>>1|W<<31)^(V>>>8|W<<24)^V>>>7,W=(W>>>1|V<<31)^(W>>>8|V<<24)^(W>>>7|V<<25),X=g[S-2],V=X.high,Y=X.low,X=(V>>>19|Y<<13)^(V<<3|Y>>>29)^V>>>6,Y=(Y>>>19|V<<13)^(Y<<3|V>>>29)^(Y>>>6|V<<26),V=g[S-7],Z=V.high,$=g[S-16],_=$.high,$=$.low,V=W+V.low,U=U+Z+ +(V>>>0<W>>>0),V=V+Y,U=U+X+ +(V>>>0<Y>>>0),V=V+$,U=U+_+ +(V>>>0<$>>>0);T.high=U,T.low=V}var Z=K&M^~K&O,$=L&N^~L&P,T=C&E^C&G^E&G,aa=D&F^D&H^F&H,W=(C>>>28|D<<4)^(C<<30|D>>>2)^(C<<25|D>>>7),X=(D>>>28|C<<4)^(D<<30|C>>>2)^(D<<25|C>>>7),Y=f[S],ab=Y.high,ac=Y.low,Y=R+((L>>>14|K<<18)^(L>>>18|K<<14)^(L<<23|K>>>9)),_=Q+((K>>>14|L<<18)^(K>>>18|L<<14)^(K<<23|L>>>9))+ +(Y>>>0<R>>>0),Y=Y+$,_=_+Z+ +(Y>>>0<$>>>0),Y=Y+ac,_=_+ab+ +(Y>>>0<ac>>>0),Y=Y+V,_=_+U+ +(Y>>>0<V>>>0),V=X+aa,T=W+T+ +(V>>>0<X>>>0),Q=O,R=P,O=M,P=N,M=K,N=L,L=J+Y|0,K=I+_+ +(L>>>0<J>>>0)|0,I=G,J=H,G=E,H=F,E=C,F=D,D=Y+V|0,C=_+T+ +(D>>>0<Y>>>0)|0}n=d.low=n+D,d.high=m+C+ +(n>>>0<D>>>0),p=e.low=p+F,e.high=o+E+ +(p>>>0<F>>>0),r=h.low=r+H,h.high=q+G+ +(r>>>0<H>>>0),t=i.low=t+J,i.high=s+I+ +(t>>>0<J>>>0),v=j.low=v+L,j.high=u+K+ +(v>>>0<L>>>0),x=k.low=x+N,k.high=w+M+ +(x>>>0<N>>>0),z=l.low=z+P,l.high=y+O+ +(z>>>0<P>>>0),B=c.low=B+R,c.high=A+Q+ +(B>>>0<R>>>0)},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+128>>>10<<5)+30]=Math.floor(c/0x100000000),b[(d+128>>>10<<5)+31]=c,a.sigBytes=4*b.length,this._process(),this._hash.toX32()},clone:function(){var a=b.clone.call(this);return a._hash=this._hash.clone(),a},blockSize:32}),h.SHA512=b._createHelper(c),h.HmacSHA512=b._createHmacHelper(c)}(),function(){var a=h.x64,b=a.Word,c=a.WordArray,a=h.algo,d=a.SHA512,a=a.SHA384=d.extend({_doReset:function(){this._hash=new c.init([new b.init(0xcbbb9d5d,0xc1059ed8),new b.init(0x629a292a,0x367cd507),new b.init(0x9159015a,0x3070dd17),new b.init(0x152fecd8,0xf70e5939),new b.init(0x67332667,0xffc00b31),new b.init(0x8eb44a87,0x68581511),new b.init(0xdb0c2e0d,0x64f98fa7),new b.init(0x47b5481d,0xbefa4fa4)])},_doFinalize:function(){var a=d._doFinalize.call(this);return a.sigBytes-=16,a}});h.SHA384=d._createHelper(a),h.HmacSHA384=d._createHmacHelper(a)}(),function(){var a=h.lib,b=a.WordArray,c=a.Hasher,a=h.algo,d=b.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),e=b.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=b.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),g=b.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),i=b.create([0,0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xa953fd4e]),j=b.create([0x50a28be6,0x5c4dd124,0x6d703ef3,0x7a6d76e9,0]),a=a.RIPEMD160=c.extend({_doReset:function(){this._hash=b.create([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0])},_doProcessBlock:function(a,b){for(var c=0;16>c;c++){var h=b+c,k=a[h];a[h]=(k<<8|k>>>24)&0xff00ff|(k<<24|k>>>8)&0xff00ff00}var l,m,n,o,p,q,r,s,t,u,h=this._hash.words,k=i.words,v=j.words,w=d.words,x=e.words,y=f.words,z=g.words;q=l=h[0],r=m=h[1],s=n=h[2],t=o=h[3],u=p=h[4];for(var A,c=0;80>c;c+=1)A=l+a[b+w[c]]|0,A=(A=(A=(16>c?A+((m^n^o)+k[0]):32>c?A+((m&n|~m&o)+k[1]):48>c?A+(((m|~n)^o)+k[2]):64>c?A+((m&o|n&~o)+k[3]):A+((m^(n|~o))+k[4]))|0)<<y[c]|A>>>32-y[c])+p|0,l=p,p=o,o=n<<10|n>>>22,n=m,m=A,A=q+a[b+x[c]]|0,A=(A=(A=(16>c?A+((r^(s|~t))+v[0]):32>c?A+((r&t|s&~t)+v[1]):48>c?A+(((r|~s)^t)+v[2]):64>c?A+((r&s|~r&t)+v[3]):A+((r^s^t)+v[4]))|0)<<z[c]|A>>>32-z[c])+u|0,q=u,u=t,t=s<<10|s>>>22,s=r,r=A;A=h[1]+n+t|0,h[1]=h[2]+o+u|0,h[2]=h[3]+p+q|0,h[3]=h[4]+l+r|0,h[4]=h[0]+m+s|0,h[0]=A},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;for(b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=(c<<8|c>>>24)&0xff00ff|(c<<24|c>>>8)&0xff00ff00,a.sigBytes=4*(b.length+1),this._process(),b=(a=this._hash).words,c=0;5>c;c++)d=b[c],b[c]=(d<<8|d>>>24)&0xff00ff|(d<<24|d>>>8)&0xff00ff00;return a},clone:function(){var a=c.clone.call(this);return a._hash=this._hash.clone(),a}});h.RIPEMD160=c._createHelper(a),h.HmacRIPEMD160=c._createHmacHelper(a)}(Math),function(){var a=h.enc.Utf8;h.algo.HMAC=h.lib.Base.extend({init:function(b,c){b=this._hasher=new b.init,"string"==typeof c&&(c=a.parse(c));var d=b.blockSize,e=4*d;c.sigBytes>e&&(c=b.finalize(c)),c.clamp();for(var f=this._oKey=c.clone(),g=this._iKey=c.clone(),h=f.words,i=g.words,j=0;j<d;j++)h[j]^=0x5c5c5c5c,i[j]^=0x36363636;f.sigBytes=g.sigBytes=e,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher;return a=b.finalize(a),b.reset(),b.finalize(this._oKey.clone().concat(a))}})}(),function(){var a=h.lib,b=a.Base,c=a.WordArray,a=h.algo,d=a.HMAC,e=a.PBKDF2=b.extend({cfg:b.extend({keySize:4,hasher:a.SHA1,iterations:1}),init:function(a){this.cfg=this.cfg.extend(a)},compute:function(a,b){for(var e=this.cfg,f=d.create(e.hasher,a),g=c.create(),h=c.create([1]),i=g.words,j=h.words,k=e.keySize,e=e.iterations;i.length<k;){var l=f.update(b).finalize(h);f.reset();for(var m=l.words,n=m.length,o=l,p=1;p<e;p++){o=f.finalize(o),f.reset();for(var q=o.words,r=0;r<n;r++)m[r]^=q[r]}g.concat(l),j[0]++}return g.sigBytes=4*k,g}});h.PBKDF2=function(a,b,c){return e.create(c).compute(a,b)}}();var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";function j(a){var b,c,d="";for(b=0;b+3<=a.length;b+=3)c=parseInt(a.substring(b,b+3),16),d+=i.charAt(c>>6)+i.charAt(63&c);for(b+1==a.length?(c=parseInt(a.substring(b,b+1),16),d+=i.charAt(c<<2)):b+2==a.length&&(c=parseInt(a.substring(b,b+2),16),d+=i.charAt(c>>2)+i.charAt((3&c)<<4));(3&d.length)>0;)d+="=";return d}function k(a){var b,c,d,e="",f=0;for(b=0;b<a.length&&"="!=a.charAt(b);++b)(d=i.indexOf(a.charAt(b)))<0||(0==f?(e+=o(d>>2),c=3&d,f=1):1==f?(e+=o(c<<2|d>>4),c=15&d,f=2):2==f?(e+=o(c),e+=o(d>>2),c=3&d,f=3):(e+=o(c<<2|d>>4),e+=o(15&d),f=0));return 1==f&&(e+=o(c<<2)),e}function l(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function m(){return new l(null)}"Microsoft Internet Explorer"==f.appName?(l.prototype.am=function(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;e=((i=g*i+((32767&k)<<15)+c[d]+(0x3fffffff&e))>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=0x3fffffff&i}return e},F=30):"Netscape"!=f.appName?(l.prototype.am=function(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/0x4000000),c[d++]=0x3ffffff&g}return e},F=26):(l.prototype.am=function(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;e=((i=g*i+((16383&k)<<14)+c[d]+e)>>28)+(k>>14)+h*j,c[d++]=0xfffffff&i}return e},F=28),l.prototype.DB=F,l.prototype.DM=(1<<F)-1,l.prototype.DV=1<<F,l.prototype.FV=0x10000000000000,l.prototype.F1=52-F,l.prototype.F2=2*F-52;var n=[];for(H=0,G=48;H<=9;++H)n[G++]=H;for(H=10,G=97;H<36;++H)n[G++]=H;for(H=10,G=65;H<36;++H)n[G++]=H;function o(a){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(a)}function p(a,b){var c=n[a.charCodeAt(b)];return null==c?-1:c}function q(a){var b=m();return b.fromInt(a),b}function r(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function s(a){this.m=a}function t(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function u(a,b){return a&b}function v(a,b){return a|b}function w(a,b){return a^b}function x(a,b){return a&~b}function y(){}function z(a){return a}function A(a){this.r2=m(),this.q3=m(),l.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}s.prototype.convert=function(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a},s.prototype.revert=function(a){return a},s.prototype.reduce=function(a){a.divRemTo(this.m,null,a)},s.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},s.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},t.prototype.convert=function(a){var b=m();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(l.ZERO)>0&&this.m.subTo(b,b),b},t.prototype.revert=function(a){var b=m();return a.copyTo(b),this.reduce(b),b},t.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)},t.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},t.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},l.prototype.copyTo=function(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s},l.prototype.fromInt=function(a){this.t=1,this.s=a<0?-1:0,a>0?this[0]=a:a<-1?this[0]=a+this.DV:this.t=0},l.prototype.fromString=function(a,b){if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else{if(4!=b)return void this.fromRadix(a,b);c=2}this.t=0,this.s=0;for(var c,d=a.length,e=!1,f=0;--d>=0;){var g=8==c?255&a[d]:p(a,d);if(g<0){"-"==a.charAt(d)&&(e=!0);continue}e=!1,0==f?this[this.t++]=g:f+c>this.DB?(this[this.t-1]|=(g&(1<<this.DB-f)-1)<<f,this[this.t++]=g>>this.DB-f):this[this.t-1]|=g<<f,(f+=c)>=this.DB&&(f-=this.DB)}8==c&&(128&a[0])!=0&&(this.s=-1,f>0&&(this[this.t-1]|=(1<<this.DB-f)-1<<f)),this.clamp(),e&&l.ZERO.subTo(this,this)},l.prototype.clamp=function(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t},l.prototype.dlShiftTo=function(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s},l.prototype.drShiftTo=function(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s},l.prototype.lShiftTo=function(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()},l.prototype.rShiftTo=function(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t){b.t=0;return}var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()},l.prototype.subTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=d<0?-1:0,d<-1?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()},l.prototype.multiplyTo=function(a,b){var c=this.abs(),d=a.abs(),e=c.t;for(b.t=e+d.t;--e>=0;)b[e]=0;for(e=0;e<d.t;++e)b[e+c.t]=c.am(0,d[e],b,e,0,c.t);b.s=0,b.clamp(),this.s!=a.s&&l.ZERO.subTo(b,b)},l.prototype.squareTo=function(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()},l.prototype.divRemTo=function(a,b,c){var d=a.abs();if(!(d.t<=0)){var e=this.abs();if(e.t<d.t){null!=b&&b.fromInt(0),null!=c&&this.copyTo(c);return}null==c&&(c=m());var f=m(),g=this.s,h=a.s,i=this.DB-r(d[d.t-1]);i>0?(d.lShiftTo(i,f),e.lShiftTo(i,c)):(d.copyTo(f),e.copyTo(c));var j=f.t,k=f[j-1];if(0!=k){var n=k*(1<<this.F1)+(j>1?f[j-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,s=c.t,t=s-j,u=null==b?m():b;for(f.dlShiftTo(t,u),c.compareTo(u)>=0&&(c[c.t++]=1,c.subTo(u,c)),l.ONE.dlShiftTo(j,u),u.subTo(f,f);f.t<j;)f[f.t++]=0;for(;--t>=0;){var v=c[--s]==k?this.DM:Math.floor(c[s]*o+(c[s-1]+q)*p);if((c[s]+=f.am(0,v,c,t,0,j))<v)for(f.dlShiftTo(t,u),c.subTo(u,c);c[s]<--v;)c.subTo(u,c)}null!=b&&(c.drShiftTo(j,b),g!=h&&l.ZERO.subTo(b,b)),c.t=j,c.clamp(),i>0&&c.rShiftTo(i,c),g<0&&l.ZERO.subTo(c,c)}}},l.prototype.invDigit=function(){if(this.t<1)return 0;var a=this[0];if((1&a)==0)return 0;var b=3&a;return(b=(b=(b=(b=b*(2-(15&a)*b)&15)*(2-(255&a)*b)&255)*(2-((65535&a)*b&65535))&65535)*(2-a*b%this.DV)%this.DV)>0?this.DV-b:-b},l.prototype.isEven=function(){return(this.t>0?1&this[0]:this.s)==0},l.prototype.exp=function(a,b){if(a>0xffffffff||a<1)return l.ONE;var c=m(),d=m(),e=b.convert(this),f=r(a)-1;for(e.copyTo(c);--f>=0;)if(b.sqrTo(c,d),(a&1<<f)>0)b.mulTo(d,e,c);else{var g=c;c=d,d=g}return b.revert(c)},l.prototype.toString=function(a){if(this.s<0)return"-"+this.negate().toString(a);if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var b,c,d=(1<<b)-1,e=!1,f="",g=this.t,h=this.DB-g*this.DB%b;if(g-- >0)for(h<this.DB&&(c=this[g]>>h)>0&&(e=!0,f=o(c));g>=0;)h<b?c=(this[g]&(1<<h)-1)<<b-h|this[--g]>>(h+=this.DB-b):(c=this[g]>>(h-=b)&d,h<=0&&(h+=this.DB,--g)),c>0&&(e=!0),e&&(f+=o(c));return e?f:"0"},l.prototype.negate=function(){var a=m();return l.ZERO.subTo(this,a),a},l.prototype.abs=function(){return this.s<0?this.negate():this},l.prototype.compareTo=function(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(0!=(b=c-a.t))return this.s<0?-b:b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0},l.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+r(this[this.t-1]^this.s&this.DM)},l.prototype.mod=function(a){var b=m();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(l.ZERO)>0&&a.subTo(b,b),b},l.prototype.modPowInt=function(a,b){var c;return c=a<256||b.isEven()?new s(b):new t(b),this.exp(a,c)},l.ZERO=q(0),l.ONE=q(1),y.prototype.convert=z,y.prototype.revert=z,y.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c)},y.prototype.sqrTo=function(a,b){a.squareTo(b)},A.prototype.convert=function(a){if(a.s<0||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var b=m();return a.copyTo(b),this.reduce(b),b},A.prototype.revert=function(a){return a},A.prototype.reduce=function(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);a.compareTo(this.m)>=0;)a.subTo(this.m,a)},A.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},A.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)};var B=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],C=0x4000000/B[B.length-1];function D(){this.i=0,this.j=0,this.S=[]}function E(){var a;a=new Date().getTime(),J[K++]^=255&a,J[K++]^=a>>8&255,J[K++]^=a>>16&255,J[K++]^=a>>24&255,K>=256&&(K-=256)}if(l.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))},l.prototype.toRadix=function(a){if(null==a&&(a=10),0==this.signum()||a<2||a>36)return"0";var b=this.chunkSize(a),c=Math.pow(a,b),d=q(c),e=m(),f=m(),g="";for(this.divRemTo(d,e,f);e.signum()>0;)g=(c+f.intValue()).toString(a).substr(1)+g,e.divRemTo(d,e,f);return f.intValue().toString(a)+g},l.prototype.fromRadix=function(a,b){this.fromInt(0),null==b&&(b=10);for(var c=this.chunkSize(b),d=Math.pow(b,c),e=!1,f=0,g=0,h=0;h<a.length;++h){var i=p(a,h);if(i<0){"-"==a.charAt(h)&&0==this.signum()&&(e=!0);continue}g=b*g+i,++f>=c&&(this.dMultiply(d),this.dAddOffset(g,0),f=0,g=0)}f>0&&(this.dMultiply(Math.pow(b,f)),this.dAddOffset(g,0)),e&&l.ZERO.subTo(this,this)},l.prototype.fromNumber=function(a,b,c){if("number"==typeof b)if(a<2)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(l.ONE.shiftLeft(a-1),v,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(l.ONE.shiftLeft(a-1),this);else{var d=[],e=7&a;d.length=(a>>3)+1,b.nextBytes(d),e>0?d[0]&=(1<<e)-1:d[0]=0,this.fromString(d,256)}},l.prototype.bitwiseTo=function(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;d<f;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()},l.prototype.changeBit=function(a,b){var c=l.ONE.shiftLeft(a);return this.bitwiseTo(c,b,c),c},l.prototype.addTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);c<e;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=d<0?-1:0,d>0?b[c++]=d:d<-1&&(b[c++]=this.DV+d),b.t=c,b.clamp()},l.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()},l.prototype.dAddOffset=function(a,b){if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}},l.prototype.multiplyLowerTo=function(a,b,c){var d,e=Math.min(this.t+a.t,b);for(c.s=0,c.t=e;e>0;)c[--e]=0;for(d=c.t-this.t;e<d;++e)c[e+this.t]=this.am(0,a[e],c,e,0,this.t);for(d=Math.min(a.t,b);e<d;++e)this.am(0,a[e],c,e,0,b-e);c.clamp()},l.prototype.multiplyUpperTo=function(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;--d>=0;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)},l.prototype.modInt=function(a){if(a<=0)return 0;var b=this.DV%a,c=this.s<0?a-1:0;if(this.t>0)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c},l.prototype.millerRabin=function(a){var b=this.subtract(l.ONE),c=b.getLowestSetBit();if(c<=0)return!1;var d=b.shiftRight(c);(a=a+1>>1)>B.length&&(a=B.length);for(var e=m(),f=0;f<a;++f){e.fromInt(B[Math.floor(Math.random()*B.length)]);var g=e.modPow(d,this);if(0!=g.compareTo(l.ONE)&&0!=g.compareTo(b)){for(var h=1;h++<c&&0!=g.compareTo(b);)if(0==(g=g.modPowInt(2,this)).compareTo(l.ONE))return!1;if(0!=g.compareTo(b))return!1}}return!0},l.prototype.clone=function(){var a=m();return this.copyTo(a),a},l.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;else if(0==this.t)return -1}else if(1==this.t)return this[0];else if(0==this.t)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},l.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},l.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},l.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},l.prototype.toByteArray=function(){var a=this.t,b=[];b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(a-- >0)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)d<8?c=(this[a]&(1<<d)-1)<<8-d|this[--a]>>(d+=this.DB-8):(c=this[a]>>(d-=8)&255,d<=0&&(d+=this.DB,--a)),(128&c)!=0&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b},l.prototype.equals=function(a){return 0==this.compareTo(a)},l.prototype.min=function(a){return 0>this.compareTo(a)?this:a},l.prototype.max=function(a){return this.compareTo(a)>0?this:a},l.prototype.and=function(a){var b=m();return this.bitwiseTo(a,u,b),b},l.prototype.or=function(a){var b=m();return this.bitwiseTo(a,v,b),b},l.prototype.xor=function(a){var b=m();return this.bitwiseTo(a,w,b),b},l.prototype.andNot=function(a){var b=m();return this.bitwiseTo(a,x,b),b},l.prototype.not=function(){for(var a=m(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a},l.prototype.shiftLeft=function(a){var b=m();return a<0?this.rShiftTo(-a,b):this.lShiftTo(a,b),b},l.prototype.shiftRight=function(a){var b=m();return a<0?this.lShiftTo(-a,b):this.rShiftTo(a,b),b},l.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this[a])return a*this.DB+function(a){if(0==a)return -1;var b=0;return(65535&a)==0&&(a>>=16,b+=16),(255&a)==0&&(a>>=8,b+=8),(15&a)==0&&(a>>=4,b+=4),(3&a)==0&&(a>>=2,b+=2),(1&a)==0&&++b,b}(this[a]);return this.s<0?this.t*this.DB:-1},l.prototype.bitCount=function(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c)a+=function(a){for(var b=0;0!=a;)a&=a-1,++b;return b}(this[c]^b);return a},l.prototype.testBit=function(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:(this[b]&1<<a%this.DB)!=0},l.prototype.setBit=function(a){return this.changeBit(a,v)},l.prototype.clearBit=function(a){return this.changeBit(a,x)},l.prototype.flipBit=function(a){return this.changeBit(a,w)},l.prototype.add=function(a){var b=m();return this.addTo(a,b),b},l.prototype.subtract=function(a){var b=m();return this.subTo(a,b),b},l.prototype.multiply=function(a){var b=m();return this.multiplyTo(a,b),b},l.prototype.divide=function(a){var b=m();return this.divRemTo(a,b,null),b},l.prototype.remainder=function(a){var b=m();return this.divRemTo(a,null,b),b},l.prototype.divideAndRemainder=function(a){var b=m(),c=m();return this.divRemTo(a,b,c),[b,c]},l.prototype.modPow=function(a,b){var c,d,e=a.bitLength(),f=q(1);if(e<=0)return f;c=e<18?1:e<48?3:e<144?4:e<768?5:6,d=e<8?new s(b):b.isEven()?new A(b):new t(b);var g=[],h=3,i=c-1,j=(1<<c)-1;if(g[1]=d.convert(this),c>1){var k=m();for(d.sqrTo(g[1],k);h<=j;)g[h]=m(),d.mulTo(k,g[h-2],g[h]),h+=2}var l,n,o=a.t-1,p=!0,u=m();for(e=r(a[o])-1;o>=0;){for(e>=i?l=a[o]>>e-i&j:(l=(a[o]&(1<<e+1)-1)<<i-e,o>0&&(l|=a[o-1]>>this.DB+e-i)),h=c;(1&l)==0;)l>>=1,--h;if((e-=h)<0&&(e+=this.DB,--o),p)g[l].copyTo(f),p=!1;else{for(;h>1;)d.sqrTo(f,u),d.sqrTo(u,f),h-=2;h>0?d.sqrTo(f,u):(n=f,f=u,u=n),d.mulTo(u,g[l],f)}for(;o>=0&&(a[o]&1<<e)==0;)d.sqrTo(f,u),n=f,f=u,u=n,--e<0&&(e=this.DB-1,--o)}return d.revert(f)},l.prototype.modInverse=function(a){var b=a.isEven();if(this.isEven()&&b||0==a.signum())return l.ZERO;for(var c=a.clone(),d=this.clone(),e=q(1),f=q(0),g=q(0),h=q(1);0!=c.signum();){for(;c.isEven();)c.rShiftTo(1,c),b?(e.isEven()&&f.isEven()||(e.addTo(this,e),f.subTo(a,f)),e.rShiftTo(1,e)):f.isEven()||f.subTo(a,f),f.rShiftTo(1,f);for(;d.isEven();)d.rShiftTo(1,d),b?(g.isEven()&&h.isEven()||(g.addTo(this,g),h.subTo(a,h)),g.rShiftTo(1,g)):h.isEven()||h.subTo(a,h),h.rShiftTo(1,h);c.compareTo(d)>=0?(c.subTo(d,c),b&&e.subTo(g,e),f.subTo(h,f)):(d.subTo(c,d),b&&g.subTo(e,g),h.subTo(f,h))}return 0!=d.compareTo(l.ONE)?l.ZERO:h.compareTo(a)>=0?h.subtract(a):0>h.signum()&&(h.addTo(a,h),0>h.signum())?h.add(a):h},l.prototype.pow=function(a){return this.exp(a,new y)},l.prototype.gcd=function(a){var b=this.s<0?this.negate():this.clone(),c=a.s<0?a.negate():a.clone();if(0>b.compareTo(c)){var d=b;b=c,c=d}var e=b.getLowestSetBit(),f=c.getLowestSetBit();if(f<0)return b;for(e<f&&(f=e),f>0&&(b.rShiftTo(f,b),c.rShiftTo(f,c));b.signum()>0;)(e=b.getLowestSetBit())>0&&b.rShiftTo(e,b),(e=c.getLowestSetBit())>0&&c.rShiftTo(e,c),b.compareTo(c)>=0?(b.subTo(c,b),b.rShiftTo(1,b)):(c.subTo(b,c),c.rShiftTo(1,c));return f>0&&c.lShiftTo(f,c),c},l.prototype.isProbablePrime=function(a){var b,c=this.abs();if(1==c.t&&c[0]<=B[B.length-1]){for(b=0;b<B.length;++b)if(c[0]==B[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<B.length;){for(var d=B[b],e=b+1;e<B.length&&d<C;)d*=B[e++];for(d=c.modInt(d);b<e;)if(d%B[b++]==0)return!1}return c.millerRabin(a)},l.prototype.square=function(){var a=m();return this.squareTo(a),a},D.prototype.init=function(a){var b,c,d;for(b=0;b<256;++b)this.S[b]=b;for(b=0,c=0;b<256;++b)c=c+this.S[b]+a[b%a.length]&255,d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.i=0,this.j=0},D.prototype.next=function(){var a;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[a+this.S[this.i]&255]},null==J){if(J=[],K=0,void 0!==g&&(void 0!==g.crypto||void 0!==g.msCrypto)){var F,G,H,I,J,K,L,M=g.crypto||g.msCrypto;if(M.getRandomValues){var N=new Uint8Array(32);for(M.getRandomValues(N),L=0;L<32;++L)J[K++]=N[L]}else if("Netscape"==f.appName&&f.appVersion<"5"){var O=g.crypto.random(32);for(L=0;L<O.length;++L)J[K++]=255&O.charCodeAt(L)}}for(;K<256;)L=Math.floor(65536*Math.random()),J[K++]=L>>>8,J[K++]=255&L;K=0,E()}function P(){}function Q(a,b){return new l(a,b)}function R(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function S(a,b){this.x=b,this.q=a}function T(a,b,c,d){this.curve=a,this.x=b,this.y=c,null==d?this.z=l.ONE:this.z=d,this.zinv=null}function U(a,b,c){this.q=a,this.a=this.fromBigInteger(b),this.b=this.fromBigInteger(c),this.infinity=new T(this,null,null)}P.prototype.nextBytes=function(a){var b;for(b=0;b<a.length;++b)a[b]=function(){if(null==I){for(E(),(I=new D).init(J),K=0;K<J.length;++K)J[K]=0;K=0}return I.next()}()},R.prototype.doPublic=function(a){return a.modPowInt(this.e,this.n)},R.prototype.setPublic=function(a,b){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof a)this.n=a,this.e=b;else if(null!=a&&null!=b&&a.length>0&&b.length>0)this.n=Q(a,16),this.e=parseInt(b,16);else throw"Invalid RSA public key"},R.prototype.type="RSA",R.prototype.doPrivate=function(a){if(null==this.p||null==this.q)return a.modPow(this.d,this.n);for(var b=a.mod(this.p).modPow(this.dmp1,this.p),c=a.mod(this.q).modPow(this.dmq1,this.q);0>b.compareTo(c);)b=b.add(this.p);return b.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)},R.prototype.setPrivate=function(a,b,c){if(this.isPrivate=!0,"string"!=typeof a)this.n=a,this.e=b,this.d=c;else if(null!=a&&null!=b&&a.length>0&&b.length>0)this.n=Q(a,16),this.e=parseInt(b,16),this.d=Q(c,16);else throw"Invalid RSA private key"},R.prototype.setPrivateEx=function(a,b,c,d,e,f,g,h){if(this.isPrivate=!0,this.isPublic=!1,null==a)throw"RSASetPrivateEx N == null";if(null==b)throw"RSASetPrivateEx E == null";if(0==a.length)throw"RSASetPrivateEx N.length == 0";if(0==b.length)throw"RSASetPrivateEx E.length == 0";if(null!=a&&null!=b&&a.length>0&&b.length>0)this.n=Q(a,16),this.e=parseInt(b,16),this.d=Q(c,16),this.p=Q(d,16),this.q=Q(e,16),this.dmp1=Q(f,16),this.dmq1=Q(g,16),this.coeff=Q(h,16);else throw"Invalid RSA private key in RSASetPrivateEx"},R.prototype.generate=function(a,b){var c=new P,d=a>>1;this.e=parseInt(b,16);for(var e=new l(b,16),f=a/2-100,g=l.ONE.shiftLeft(f);;){for(;this.p=new l(a-d,1,c),!(0==this.p.subtract(l.ONE).gcd(e).compareTo(l.ONE)&&this.p.isProbablePrime(10)););for(;this.q=new l(d,1,c),!(0==this.q.subtract(l.ONE).gcd(e).compareTo(l.ONE)&&this.q.isProbablePrime(10)););if(0>=this.p.compareTo(this.q)){var h=this.p;this.p=this.q,this.q=h}var i=this.q.subtract(this.p).abs();if(!(i.bitLength()<f||0>=i.compareTo(g))){var j=this.p.subtract(l.ONE),k=this.q.subtract(l.ONE),m=j.multiply(k);if(0==m.gcd(e).compareTo(l.ONE)&&(this.n=this.p.multiply(this.q),this.n.bitLength()==a)){this.d=e.modInverse(m),this.dmp1=this.d.mod(j),this.dmq1=this.d.mod(k),this.coeff=this.q.modInverse(this.p);break}}}this.isPrivate=!0},S.prototype.equals=function(a){return a==this||this.q.equals(a.q)&&this.x.equals(a.x)},S.prototype.toBigInteger=function(){return this.x},S.prototype.negate=function(){return new S(this.q,this.x.negate().mod(this.q))},S.prototype.add=function(a){return new S(this.q,this.x.add(a.toBigInteger()).mod(this.q))},S.prototype.subtract=function(a){return new S(this.q,this.x.subtract(a.toBigInteger()).mod(this.q))},S.prototype.multiply=function(a){return new S(this.q,this.x.multiply(a.toBigInteger()).mod(this.q))},S.prototype.square=function(){return new S(this.q,this.x.square().mod(this.q))},S.prototype.divide=function(a){return new S(this.q,this.x.multiply(a.toBigInteger().modInverse(this.q)).mod(this.q))},S.prototype.sqrt=function(){return new S(this.q,this.x.sqrt().mod(this.q))},T.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},T.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},T.prototype.equals=function(a){return a==this||(this.isInfinity()?a.isInfinity():a.isInfinity()?this.isInfinity():!!a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(l.ZERO)&&a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q).equals(l.ZERO))},T.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(l.ZERO)&&!this.y.toBigInteger().equals(l.ZERO)},T.prototype.negate=function(){return new T(this.curve,this.x,this.y.negate(),this.z)},T.prototype.add=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;var b=a.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(a.z)).mod(this.curve.q),c=a.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(a.z)).mod(this.curve.q);if(l.ZERO.equals(c))return l.ZERO.equals(b)?this.twice():this.curve.getInfinity();var d=new l("3"),e=this.x.toBigInteger(),f=this.y.toBigInteger();a.x.toBigInteger(),a.y.toBigInteger();var g=c.square(),h=g.multiply(c),i=e.multiply(g),j=b.square().multiply(this.z),k=j.subtract(i.shiftLeft(1)).multiply(a.z).subtract(h).multiply(c).mod(this.curve.q),m=i.multiply(d).multiply(b).subtract(f.multiply(h)).subtract(j.multiply(b)).multiply(a.z).add(b.multiply(h)).mod(this.curve.q),n=h.multiply(this.z).multiply(a.z).mod(this.curve.q);return new T(this.curve,this.curve.fromBigInteger(k),this.curve.fromBigInteger(m),n)},T.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var a=new l("3"),b=this.x.toBigInteger(),c=this.y.toBigInteger(),d=c.multiply(this.z),e=d.multiply(c).mod(this.curve.q),f=this.curve.a.toBigInteger(),g=b.square().multiply(a);l.ZERO.equals(f)||(g=g.add(this.z.square().multiply(f)));var h=(g=g.mod(this.curve.q)).square().subtract(b.shiftLeft(3).multiply(e)).shiftLeft(1).multiply(d).mod(this.curve.q),i=g.multiply(a).multiply(b).subtract(e.shiftLeft(1)).shiftLeft(2).multiply(e).subtract(g.square().multiply(g)).mod(this.curve.q),j=d.square().multiply(d).shiftLeft(3).mod(this.curve.q);return new T(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(i),j)},T.prototype.multiply=function(a){if(this.isInfinity())return this;if(0==a.signum())return this.curve.getInfinity();var b,c=a.multiply(new l("3")),d=this.negate(),e=this,f=this.curve.q.subtract(a),g=f.multiply(new l("3")),h=new T(this.curve,this.x,this.y),i=h.negate();for(b=c.bitLength()-2;b>0;--b){e=e.twice();var j=c.testBit(b);j!=a.testBit(b)&&(e=e.add(j?this:d))}for(b=g.bitLength()-2;b>0;--b){h=h.twice();var k=g.testBit(b);k!=f.testBit(b)&&(h=h.add(k?h:i))}return e},T.prototype.multiplyTwo=function(a,b,c){for(var d=a.bitLength()>c.bitLength()?a.bitLength()-1:c.bitLength()-1,e=this.curve.getInfinity(),f=this.add(b);d>=0;)e=e.twice(),a.testBit(d)?e=c.testBit(d)?e.add(f):e.add(this):c.testBit(d)&&(e=e.add(b)),--d;return e},U.prototype.getQ=function(){return this.q},U.prototype.getA=function(){return this.a},U.prototype.getB=function(){return this.b},U.prototype.equals=function(a){return a==this||this.q.equals(a.q)&&this.a.equals(a.a)&&this.b.equals(a.b)},U.prototype.getInfinity=function(){return this.infinity},U.prototype.fromBigInteger=function(a){return new S(this.q,a)},U.prototype.decodePointHex=function(a){switch(parseInt(a.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:var b=a.substr(0,2);a.substr(2);var c=this.fromBigInteger(new l(h,16)),d=this.getA(),e=this.getB(),f=c.square().add(d).multiply(c).add(e).sqrt();return"03"==b&&(f=f.negate()),new T(this,c,f);case 4:case 6:case 7:var g=(a.length-2)/2,h=a.substr(2,g),i=a.substr(g+2,g);return new T(this,this.fromBigInteger(new l(h,16)),this.fromBigInteger(new l(i,16)));default:return null}},S.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},T.prototype.getEncoded=function(a){var b=function(a,b){var c=a.toByteArrayUnsigned();if(b<c.length)c=c.slice(c.length-b);else for(;b>c.length;)c.unshift(0);return c},c=this.getX().toBigInteger(),d=this.getY().toBigInteger(),e=b(c,32);return a?d.isEven()?e.unshift(2):e.unshift(3):(e.unshift(4),e=e.concat(b(d,32))),e},T.decodeFrom=function(a,b){b[0];var c=b.length-1,d=b.slice(1,1+c/2),e=b.slice(1+c/2,1+c);d.unshift(0),e.unshift(0);var f=new l(d),g=new l(e);return new T(a,a.fromBigInteger(f),a.fromBigInteger(g))},T.decodeFromHex=function(a,b){b.substr(0,2);var c=b.length-2,d=b.substr(2,c/2),e=b.substr(2+c/2,c/2),f=new l(d,16),g=new l(e,16);return new T(a,a.fromBigInteger(f),a.fromBigInteger(g))},T.prototype.add2D=function(a){if(this.isInfinity())return a;if(a.isInfinity())return this;if(this.x.equals(a.x))return this.y.equals(a.y)?this.twice():this.curve.getInfinity();var b=a.x.subtract(this.x),c=a.y.subtract(this.y).divide(b),d=c.square().subtract(this.x).subtract(a.x),e=c.multiply(this.x.subtract(d)).subtract(this.y);return new T(this.curve,d,e)},T.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var a=this.curve.fromBigInteger(l.valueOf(2)),b=this.curve.fromBigInteger(l.valueOf(3)),c=this.x.square().multiply(b).add(this.curve.a).divide(this.y.multiply(a)),d=c.square().subtract(this.x.multiply(a)),e=c.multiply(this.x.subtract(d)).subtract(this.y);return new T(this.curve,d,e)},T.prototype.multiply2D=function(a){if(this.isInfinity())return this;if(0==a.signum())return this.curve.getInfinity();var b,c=a.multiply(new l("3")),d=this.negate(),e=this;for(b=c.bitLength()-2;b>0;--b){e=e.twice();var f=c.testBit(b);f!=a.testBit(b)&&(e=e.add2D(f?this:d))}return e},T.prototype.isOnCurve=function(){var a=this.getX().toBigInteger(),b=this.getY().toBigInteger(),c=this.curve.getA().toBigInteger(),d=this.curve.getB().toBigInteger(),e=this.curve.getQ(),f=b.multiply(b).mod(e),g=a.multiply(a).multiply(a).add(c.multiply(a)).add(d).mod(e);return f.equals(g)},T.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},T.prototype.validate=function(){var a=this.curve.getQ();if(this.isInfinity())throw Error("Point is at infinity.");var b=this.getX().toBigInteger(),c=this.getY().toBigInteger();if(0>b.compareTo(l.ONE)||b.compareTo(a.subtract(l.ONE))>0)throw Error("x coordinate out of bounds");if(0>c.compareTo(l.ONE)||c.compareTo(a.subtract(l.ONE))>0)throw Error("y coordinate out of bounds");if(!this.isOnCurve())throw Error("Point is not on the curve.");if(this.multiply(a).isInfinity())throw Error("Point is not a scalar multiple of G.");return!0};var V=function(){var a=RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),b=RegExp("\\\\(?:([^u])|u(.{4}))","g"),c={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"	"};function d(a,b,d){return b?c[b]:String.fromCharCode(parseInt(d,16))}var e=new String(""),f=Object.hasOwnProperty;return function(c,g){var h,i,j,k=c.match(a),l=k[0],m=!1;"{"===l?h={}:"["===l?h=[]:(h=[],m=!0);for(var n=[h],o=1-m,p=k.length;o<p;++o)switch((l=k[o]).charCodeAt(0)){default:(j=n[0])[i||j.length]=+l,i=void 0;break;case 34:if(-1!==(l=l.substring(1,l.length-1)).indexOf("\\")&&(l=l.replace(b,d)),j=n[0],!i)if(j instanceof Array)i=j.length;else{i=l||e;break}j[i]=l,i=void 0;break;case 91:j=n[0],n.unshift(j[i||j.length]=[]),i=void 0;break;case 93:case 125:n.shift();break;case 102:(j=n[0])[i||j.length]=!1,i=void 0;break;case 110:(j=n[0])[i||j.length]=null,i=void 0;break;case 116:(j=n[0])[i||j.length]=!0,i=void 0;break;case 123:j=n[0],n.unshift(j[i||j.length]={}),i=void 0}if(m){if(1!==n.length)throw Error();h=h[0]}else if(n.length)throw Error();if(g){var q=function(a,b){var c=a[b];if(c&&"object"==typeof c){var d=null;for(var e in c)if(f.call(c,e)&&c!==a){var h=q(c,e);void 0!==h?c[e]=h:(d||(d=[]),d.push(e))}if(d)for(var i=d.length;--i>=0;)delete c[d[i]]}return g.call(a,b,c)};h=q({"":h},"")}return h}}();void 0!==c&&c||(c={}),void 0!==c.asn1&&c.asn1||(c.asn1={}),c.asn1.ASN1Util=new function(){this.integerToByteHex=function(a){var b=a.toString(16);return b.length%2==1&&(b="0"+b),b},this.bigIntToMinTwosComplementsHex=function(a){return au(a)},this.getPEMStringFromHex=function(a,b){return af(a,b)},this.newObject=function(a){var b=c.asn1,d=b.ASN1Object,e=b.DERBoolean,f=b.DERInteger,g=b.DERBitString,h=b.DEROctetString,i=b.DERNull,j=b.DERObjectIdentifier,k=b.DEREnumerated,l=b.DERUTF8String,m=b.DERNumericString,n=b.DERPrintableString,o=b.DERTeletexString,p=b.DERIA5String,q=b.DERUTCTime,r=b.DERGeneralizedTime,s=b.DERVisibleString,t=b.DERBMPString,u=b.DERSequence,v=b.DERSet,w=b.DERTaggedObject,x=b.ASN1Util.newObject;if(a instanceof b.ASN1Object)return a;var y=Object.keys(a);if(1!=y.length)throw Error("key of param shall be only one.");var z=y[0];if(-1==":asn1:bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:visstr:bmpstr:seq:set:tag:".indexOf(":"+z+":"))throw Error("undefined key: "+z);if("bool"==z)return new e(a[z]);if("int"==z)return new f(a[z]);if("bitstr"==z)return new g(a[z]);if("octstr"==z)return new h(a[z]);if("null"==z)return new i(a[z]);if("oid"==z)return new j(a[z]);if("enum"==z)return new k(a[z]);if("utf8str"==z)return new l(a[z]);if("numstr"==z)return new m(a[z]);if("prnstr"==z)return new n(a[z]);if("telstr"==z)return new o(a[z]);if("ia5str"==z)return new p(a[z]);if("utctime"==z)return new q(a[z]);if("gentime"==z)return new r(a[z]);if("visstr"==z)return new s(a[z]);if("bmpstr"==z)return new t(a[z]);if("asn1"==z)return new d(a[z]);if("seq"==z){for(var A=a[z],B=[],C=0;C<A.length;C++){var D=x(A[C]);B.push(D)}return new u({array:B})}if("set"==z){for(var A=a[z],B=[],C=0;C<A.length;C++){var D=x(A[C]);B.push(D)}return new v({array:B})}if("tag"==z){var E=a[z];if("[object Array]"!==Object.prototype.toString.call(E)||3!=E.length)return new w(E);var F=x(E[2]);return new w({tag:E[0],explicit:E[1],obj:F})}},this.jsonToASN1HEX=function(a){return this.newObject(a).tohex()}},c.asn1.ASN1Util.oidHexToInt=function(a){for(var b="",c=parseInt(a.substr(0,2),16),d=Math.floor(c/40),b=d+"."+c%40,e="",f=2;f<a.length;f+=2){var g=("00000000"+parseInt(a.substr(f,2),16).toString(2)).slice(-8);e+=g.substr(1,7),"0"==g.substr(0,1)&&(b=b+"."+new l(e,2).toString(10),e="")}return b},c.asn1.ASN1Util.oidIntToHex=function(a){var b=function(a){var b=a.toString(16);return 1==b.length&&(b="0"+b),b};if(!a.match(/^[0-9.]+$/))throw"malformed oid string: "+a;var c="",d=a.split(".");c+=b(40*parseInt(d[0])+parseInt(d[1])),d.splice(0,2);for(var e=0;e<d.length;e++)c+=function(a){var c="",d=new l(a,10).toString(2),e=7-d.length%7;7==e&&(e=0);for(var f="",g=0;g<e;g++)f+="0";d=f+d;for(var g=0;g<d.length-1;g+=7){var h=d.substr(g,7);g!=d.length-7&&(h="1"+h),c+=b(parseInt(h,2))}return c}(d[e]);return c},c.asn1.ASN1Object=function(a){this.params=null,this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw Error("this.hV is null or undefined");if(this.hV.length%2==1)throw Error("value hex must be even length: n=0,v="+this.hV);var a=this.hV.length/2,b=a.toString(16);if(b.length%2==1&&(b="0"+b),a<128)return b;var c=b.length/2;if(c>15)throw Error("ASN.1 length too long to represent by 8x: n = "+a.toString(16));return(128+c).toString(16)+b},this.tohex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.getValueHex=function(){return this.tohex(),this.hV},this.getFreshValueHex=function(){return""},this.setByParam=function(a){this.params=a},void 0!=a&&void 0!=a.tlv&&(this.hTLV=a.tlv,this.isModified=!1)},c.asn1.DERAbstractString=function(a){c.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(a){this.hTLV=null,this.isModified=!0,this.s=a,this.hV=ab(this.s).toLowerCase()},this.setStringHex=function(a){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=a},this.getFreshValueHex=function(){return this.hV},void 0!==a&&("string"==typeof a?this.setString(a):void 0!==a.str?this.setString(a.str):void 0!==a.hex&&this.setStringHex(a.hex))},ay(c.asn1.DERAbstractString,c.asn1.ASN1Object),c.asn1.DERAbstractTime=function(a){c.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(a){return new Date(a.getTime()+6e4*a.getTimezoneOffset())},this.formatDate=function(a,b,c){var d=this.zeroPadding,e=this.localDateToUTC(a),f=String(e.getFullYear());"utc"==b&&(f=f.substr(2,2));var g=f+d(String(e.getMonth()+1),2)+d(String(e.getDate()),2)+d(String(e.getHours()),2)+d(String(e.getMinutes()),2)+d(String(e.getSeconds()),2);if(!0===c){var h=e.getMilliseconds();if(0!=h){var i=d(String(h),3);g=g+"."+(i=i.replace(/[0]+$/,""))}}return g+"Z"},this.zeroPadding=function(a,b){return a.length>=b?a:Array(b-a.length+1).join("0")+a},this.setByParam=function(a){this.hV=null,this.hTLV=null,this.params=a},this.getString=function(){},this.setString=function(a){this.hTLV=null,this.isModified=!0,void 0==this.params&&(this.params={}),this.params.str=a},this.setByDate=function(a){this.hTLV=null,this.isModified=!0,void 0==this.params&&(this.params={}),this.params.date=a},this.setByDateValue=function(a,b,c,d,e,f){var g=new Date(Date.UTC(a,b-1,c,d,e,f,0));this.setByDate(g)},this.getFreshValueHex=function(){return this.hV}},ay(c.asn1.DERAbstractTime,c.asn1.ASN1Object),c.asn1.DERAbstractStructured=function(a){c.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(a){this.hTLV=null,this.isModified=!0,this.asn1Array=a},this.appendASN1Object=function(a){this.hTLV=null,this.isModified=!0,this.asn1Array.push(a)},this.asn1Array=[],void 0!==a&&void 0!==a.array&&(this.asn1Array=a.array)},ay(c.asn1.DERAbstractStructured,c.asn1.ASN1Object),c.asn1.DERBoolean=function(a){c.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",!1==a?this.hTLV="010100":this.hTLV="0101ff"},ay(c.asn1.DERBoolean,c.asn1.ASN1Object),c.asn1.DERInteger=function(a){c.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.params=null,this.setByBigInteger=function(a){this.isModified=!0,this.params={bigint:a}},this.setByInteger=function(a){this.isModified=!0,this.params=a},this.setValueHex=function(a){this.isModified=!0,this.params={hex:a}},this.getFreshValueHex=function(){var a=this.params,b=null;if(null==a)throw Error("value not set");if("object"==typeof a&&void 0!=a.hex)return this.hV=a.hex,this.hV;if("number"==typeof a)b=new l(String(a),10);else if(void 0!=a.int)b=new l(String(a.int),10);else if(void 0!=a.bigint)b=a.bigint;else throw Error("wrong parameter");return this.hV=au(b),this.hV},void 0!=a&&(this.params=a)},ay(c.asn1.DERInteger,c.asn1.ASN1Object),c.asn1.DERBitString=function(a){if(void 0!==a&&void 0!==a.obj){var b=c.asn1.ASN1Util.newObject(a.obj);a.hex="00"+b.tohex()}c.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(a){this.hTLV=null,this.isModified=!0,this.hV=a},this.setUnusedBitsAndHexValue=function(a,b){if(a<0||7<a)throw"unused bits shall be from 0 to 7: u = "+a;this.hTLV=null,this.isModified=!0,this.hV="0"+a+b},this.setByBinaryString=function(a){var b=8-(a=a.replace(/0+$/,"")).length%8;8==b&&(b=0),a+="0000000".substr(0,b);for(var c="",d=0;d<a.length-1;d+=8){var e=parseInt(a.substr(d,8),2).toString(16);1==e.length&&(e="0"+e),c+=e}this.hTLV=null,this.isModified=!0,this.hV="0"+b+c},this.setByBooleanArray=function(a){for(var b="",c=0;c<a.length;c++)!0==a[c]?b+="1":b+="0";this.setByBinaryString(b)},this.newFalseArray=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=!1;return b},this.getFreshValueHex=function(){return this.hV},void 0!==a&&("string"==typeof a&&a.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(a):void 0!==a.hex?this.setHexValueIncludingUnusedBits(a.hex):void 0!==a.bin?this.setByBinaryString(a.bin):void 0!==a.array&&this.setByBooleanArray(a.array))},ay(c.asn1.DERBitString,c.asn1.ASN1Object),c.asn1.DEROctetString=function(a){if(void 0!==a&&void 0!==a.obj){var b=c.asn1.ASN1Util.newObject(a.obj);a.hex=b.tohex()}c.asn1.DEROctetString.superclass.constructor.call(this,a),this.hT="04"},ay(c.asn1.DEROctetString,c.asn1.DERAbstractString),c.asn1.DERNull=function(){c.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ay(c.asn1.DERNull,c.asn1.ASN1Object),c.asn1.DERObjectIdentifier=function(a){c.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(a){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=a},this.setValueOidString=function(a){var b=function(a){var b=function(a){var b=a.toString(16);return 1==b.length&&(b="0"+b),b};try{if(!a.match(/^[0-9.]+$/))return null;var c="",d=a.split("."),e=40*parseInt(d[0],10)+parseInt(d[1],10);c+=b(e),d.splice(0,2);for(var f=0;f<d.length;f++)c+=function(a){var c="",d=parseInt(a,10).toString(2),e=7-d.length%7;7==e&&(e=0);for(var f="",g=0;g<e;g++)f+="0";d=f+d;for(var g=0;g<d.length-1;g+=7){var h=d.substr(g,7);g!=d.length-7&&(h="1"+h),c+=b(parseInt(h,2))}return c}(d[f]);return c}catch(a){return null}}(a);if(null==b)throw Error("malformed oid string: "+a);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=b},this.setValueName=function(a){var b=c.asn1.x509.OID.name2oid(a);if(""!==b)this.setValueOidString(b);else throw Error("DERObjectIdentifier oidName undefined: "+a)},this.setValueNameOrOid=function(a){a.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(a):this.setValueName(a)},this.getFreshValueHex=function(){return this.hV},this.setByParam=function(a){"string"==typeof a?this.setValueNameOrOid(a):void 0!==a.oid?this.setValueNameOrOid(a.oid):void 0!==a.name?this.setValueNameOrOid(a.name):void 0!==a.hex&&this.setValueHex(a.hex)},void 0!==a&&this.setByParam(a)},ay(c.asn1.DERObjectIdentifier,c.asn1.ASN1Object),c.asn1.DEREnumerated=function(a){c.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(a){this.hTLV=null,this.isModified=!0,this.hV=au(a)},this.setByInteger=function(a){var b=new l(String(a),10);this.setByBigInteger(b)},this.setValueHex=function(a){this.hV=a},this.getFreshValueHex=function(){return this.hV},void 0!==a&&(void 0!==a.int?this.setByInteger(a.int):"number"==typeof a?this.setByInteger(a):void 0!==a.hex&&this.setValueHex(a.hex))},ay(c.asn1.DEREnumerated,c.asn1.ASN1Object),c.asn1.DERUTF8String=function(a){c.asn1.DERUTF8String.superclass.constructor.call(this,a),this.hT="0c"},ay(c.asn1.DERUTF8String,c.asn1.DERAbstractString),c.asn1.DERNumericString=function(a){c.asn1.DERNumericString.superclass.constructor.call(this,a),this.hT="12"},ay(c.asn1.DERNumericString,c.asn1.DERAbstractString),c.asn1.DERPrintableString=function(a){c.asn1.DERPrintableString.superclass.constructor.call(this,a),this.hT="13"},ay(c.asn1.DERPrintableString,c.asn1.DERAbstractString),c.asn1.DERTeletexString=function(a){c.asn1.DERTeletexString.superclass.constructor.call(this,a),this.hT="14"},ay(c.asn1.DERTeletexString,c.asn1.DERAbstractString),c.asn1.DERIA5String=function(a){c.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="16"},ay(c.asn1.DERIA5String,c.asn1.DERAbstractString),c.asn1.DERVisibleString=function(a){c.asn1.DERIA5String.superclass.constructor.call(this,a),this.hT="1a"},ay(c.asn1.DERVisibleString,c.asn1.DERAbstractString),c.asn1.DERBMPString=function(a){c.asn1.DERBMPString.superclass.constructor.call(this,a),this.hT="1e"},ay(c.asn1.DERBMPString,c.asn1.DERAbstractString),c.asn1.DERUTCTime=function(a){c.asn1.DERUTCTime.superclass.constructor.call(this,a),this.hT="17",this.params=void 0,this.getFreshValueHex=function(){var a=this.params;if(void 0==this.params&&(a={date:new Date}),"string"==typeof a)if(a.match(/^[0-9]{12}Z$/)||a.match(/^[0-9]{12}\.[0-9]+Z$/))this.hV=Y(a);else throw Error("malformed string for UTCTime: "+a);else if(void 0!=a.str)this.hV=Y(a.str);else if(void 0==a.date&&!0==a.millis){var b=new Date;this.hV=Y(this.formatDate(b,"utc",!0))}else if(void 0!=a.date&&a.date instanceof Date){var c=!0===a.millis;this.hV=Y(this.formatDate(a.date,"utc",c))}else a instanceof Date&&(this.hV=Y(this.formatDate(a,"utc")));if(void 0==this.hV)throw Error("parameter not specified properly for UTCTime");return this.hV},void 0!=a&&this.setByParam(a)},ay(c.asn1.DERUTCTime,c.asn1.DERAbstractTime),c.asn1.DERGeneralizedTime=function(a){c.asn1.DERGeneralizedTime.superclass.constructor.call(this,a),this.hT="18",this.params=a,this.getFreshValueHex=function(){var a=this.params;if(void 0==this.params&&(a={date:new Date}),"string"==typeof a)if(a.match(/^[0-9]{14}Z$/)||a.match(/^[0-9]{14}\.[0-9]+Z$/))this.hV=Y(a);else throw Error("malformed string for GeneralizedTime: "+a);else if(void 0!=a.str)this.hV=Y(a.str);else if(void 0==a.date&&!0==a.millis){var b=new Date;this.hV=Y(this.formatDate(b,"gen",!0))}else if(void 0!=a.date&&a.date instanceof Date){var c=!0===a.millis;this.hV=Y(this.formatDate(a.date,"gen",c))}else a instanceof Date&&(this.hV=Y(this.formatDate(a,"gen")));if(void 0==this.hV)throw Error("parameter not specified properly for GeneralizedTime");return this.hV},void 0!=a&&this.setByParam(a)},ay(c.asn1.DERGeneralizedTime,c.asn1.DERAbstractTime),c.asn1.DERSequence=function(a){c.asn1.DERSequence.superclass.constructor.call(this,a),this.hT="30",this.getFreshValueHex=function(){for(var a="",b=0;b<this.asn1Array.length;b++)a+=this.asn1Array[b].tohex();return this.hV=a,this.hV}},ay(c.asn1.DERSequence,c.asn1.DERAbstractStructured),c.asn1.DERSet=function(a){c.asn1.DERSet.superclass.constructor.call(this,a),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var a=[],b=0;b<this.asn1Array.length;b++){var c=this.asn1Array[b];a.push(c.tohex())}return!0==this.sortFlag&&a.sort(),this.hV=a.join(""),this.hV},void 0!==a&&void 0!==a.sortflag&&!1==a.sortflag&&(this.sortFlag=!1)},ay(c.asn1.DERSet,c.asn1.DERAbstractStructured),c.asn1.DERTaggedObject=function(a){c.asn1.DERTaggedObject.superclass.constructor.call(this);var b=c.asn1,d=W.getV,e=(W.isASN1HEX,b.ASN1Util.newObject);this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.params={tag:"a0",explicit:!0},this.setASN1Object=function(a,b,c){this.params={tag:b,explicit:a,obj:c}},this.getFreshValueHex=function(){var a,c=this.params;if(void 0==c.explicit&&(c.explicit=!0),void 0!=c.tage&&(c.tag=c.tage,c.explicit=!0),void 0!=c.tagi&&(c.tag=c.tagi,c.explicit=!1),void 0!=c.str)this.hV=ab(c.str);else if(void 0!=c.hex)this.hV=c.hex;else if(void 0!=c.obj)c.obj instanceof b.ASN1Object?a=c.obj.tohex():"object"==typeof c.obj&&(a=e(c.obj).tohex()),c.explicit?this.hV=a:this.hV=d(a,0);else throw Error("str, hex nor obj not specified");return void 0==c.tag&&(c.tag="a0"),this.hT=c.tag,this.hTLV=null,this.isModified=!0,this.hV},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},ay(c.asn1.DERTaggedObject,c.asn1.ASN1Object);var W=new function(){};function X(a){for(var b="",c=0;c<a.length;c++){var d=a[c].toString(16);1==d.length&&(d="0"+d),b+=d}return b}function Y(a){return X(function(a){for(var b=[],c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}(a))}function Z(a){return(a=(a=a.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function $(a){return a.length%4==2?a+="==":a.length%4==3&&(a+="="),a=(a=a.replace(/-/g,"+")).replace(/_/g,"/")}function _(a){return a.length%2==1&&(a="0"+a),Z(j(a))}function aa(a){return k($(a))}function ab(a){return ah(ap(a)).toLowerCase()}function ac(a){try{return decodeURIComponent(ai(a))}catch(a){return null}}W.getLblen=function(a,b){if("8"!=a.substr(b+2,1))return 1;var c=parseInt(a.substr(b+3,1));return 0==c?-1:0<c&&c<10?c+1:-2},W.getL=function(a,b){var c=W.getLblen(a,b);return c<1?"":a.substr(b+2,2*c)},W.getVblen=function(a,b){var c;return""==(c=W.getL(a,b))?-1:("8"===c.substr(0,1)?new l(c.substr(2),16):new l(c,16)).intValue()},W.getVidx=function(a,b){var c=W.getLblen(a,b);return c<0?c:b+(c+1)*2},W.getV=function(a,b){var c=W.getVidx(a,b),d=W.getVblen(a,b);return a.substr(c,2*d)},W.getTLV=function(a,b){return a.substr(b,2)+W.getL(a,b)+W.getV(a,b)},W.getTLVblen=function(a,b){return 2+2*W.getLblen(a,b)+2*W.getVblen(a,b)},W.getNextSiblingIdx=function(a,b){return W.getVidx(a,b)+2*W.getVblen(a,b)},W.getChildIdx=function(a,b){var c,d,e,f=[];c=W.getVidx(a,b),d=2*W.getVblen(a,b),"03"==a.substr(b,2)&&(c+=2,d-=2),e=0;for(var g=c;e<=d;){var h=W.getTLVblen(a,g);if((e+=h)<=d&&f.push(g),g+=h,e>=d)break}return f},W.getNthChildIdx=function(a,b,c){return W.getChildIdx(a,b)[c]},W.getIdxbyList=function(a,b,c,d){var e,f;return 0==c.length?void 0!==d&&a.substr(b,2)!==d?-1:b:(e=c.shift())>=(f=W.getChildIdx(a,b)).length?-1:W.getIdxbyList(a,f[e],c,d)},W.getIdxbyListEx=function(a,b,c,d){if(0==c.length)return void 0!==d&&a.substr(b,2)!==d?-1:b;e=c.shift(),f=W.getChildIdx(a,b);for(var e,f,g=0,h=0;h<f.length;h++){var i=a.substr(f[h],2);if("number"==typeof e&&!W.isContextTag(i)&&g==e||"string"==typeof e&&W.isContextTag(i,e))return W.getIdxbyListEx(a,f[h],c,d);!W.isContextTag(i)&&g++}return -1},W.getTLVbyList=function(a,b,c,d){var e=W.getIdxbyList(a,b,c,d);return -1==e||e>=a.length?null:W.getTLV(a,e)},W.getTLVbyListEx=function(a,b,c,d){var e=W.getIdxbyListEx(a,b,c,d);return -1==e?null:W.getTLV(a,e)},W.getVbyList=function(a,b,c,d,e){var f,g;return -1==(f=W.getIdxbyList(a,b,c,d))||f>=a.length?null:(g=W.getV(a,f),!0===e&&(g=g.substr(2)),g)},W.getVbyListEx=function(a,b,c,d,e){var f,g;return -1==(f=W.getIdxbyListEx(a,b,c,d))?null:(g=W.getV(a,f),"03"==a.substr(f,2)&&!1!==e&&(g=g.substr(2)),g)},W.getInt=function(a,b,c){void 0==c&&(c=-1);try{var d=a.substr(b,2);if("02"!=d&&"03"!=d)return c;var e=W.getV(a,b);if("02"==d)return parseInt(e,16);return function(a){if(a.length%2!=0||null==(a=a.toLowerCase()).match(/^[0-9a-f]+$/))return -1;try{var b=a.substr(0,2);if("00"==b)return parseInt(a.substr(2),16);var c=parseInt(b,16);if(c>7)return -1;var d=a.substr(2),e=parseInt(d,16).toString(2);"0"==e&&(e="00000000"),e=e.slice(0,0-c);var f=parseInt(e,2);if(f==NaN)return -1;return f}catch(a){return -1}}(e)}catch(a){return c}},W.getOID=function(a,b,c){void 0==c&&(c=null);try{if("06"!=a.substr(b,2))return c;var d=W.getV(a,b);return at(d)}catch(a){return c}},W.getOIDName=function(a,b,d){void 0==d&&(d=null);try{var e=W.getOID(a,b,d);if(e==d)return d;var f=c.asn1.x509.OID.oid2name(e);if(""==f)return e;return f}catch(a){return d}},W.getString=function(a,b,c){void 0==c&&(c=null);try{var d=W.getV(a,b);return ad(d)}catch(a){return c}},W.hextooidstr=function(a){var b=function(a,b){return a.length>=b?a:Array(b-a.length+1).join("0")+a},c=[],d=parseInt(a.substr(0,2),16);c[0]=new String(Math.floor(d/40)),c[1]=new String(d%40);for(var e=a.substr(2),f=[],g=0;g<e.length/2;g++)f.push(parseInt(e.substr(2*g,2),16));for(var h=[],i="",g=0;g<f.length;g++)128&f[g]?i+=b((127&f[g]).toString(2),7):(h.push(new String(parseInt(i+=b((127&f[g]).toString(2),7),2))),i="");var j=c.join(".");return h.length>0&&(j=j+"."+h.join(".")),j},W.dump=function(a,b,d,e){var f=W.getV,g=W.dump,h=W.getChildIdx,i=a;a instanceof c.asn1.ASN1Object&&(i=a.tohex());var j=function(a,b){return a.length<=2*b?a:a.substr(0,b)+"..(total "+a.length/2+"bytes).."+a.substr(a.length-b,b)};void 0===b&&(b={ommit_long_octet:32}),void 0===d&&(d=0),void 0===e&&(e="");var k=b.ommit_long_octet,l=i.substr(d,2);if("01"==l){var m=f(i,d);return"00"==m?e+"BOOLEAN FALSE\n":e+"BOOLEAN TRUE\n"}if("02"==l){var m=f(i,d);return e+"INTEGER "+j(m,k)+"\n"}if("03"==l){var m=f(i,d);if(!W.isASN1HEX(m.substr(2)))return e+"BITSTRING "+j(m,k)+"\n";var n=e+"BITSTRING, encapsulates\n";return n+g(m.substr(2),b,0,e+"  ")}if("04"==l){var m=f(i,d);if(!W.isASN1HEX(m))return e+"OCTETSTRING "+j(m,k)+"\n";var n=e+"OCTETSTRING, encapsulates\n";return n+g(m,b,0,e+"  ")}if("05"==l)return e+"NULL\n";if("06"==l){var o=f(i,d),p=c.asn1.ASN1Util.oidHexToInt(o),q=c.asn1.x509.OID.oid2name(p),r=p.replace(/\./g," ");return""!=q?e+"ObjectIdentifier "+q+" ("+r+")\n":e+"ObjectIdentifier ("+r+")\n"}if("0a"==l)return e+"ENUMERATED "+parseInt(f(i,d))+"\n";if("0c"==l)return e+"UTF8String '"+ac(f(i,d))+"'\n";if("13"==l)return e+"PrintableString '"+ac(f(i,d))+"'\n";if("14"==l)return e+"TeletexString '"+ac(f(i,d))+"'\n";if("16"==l)return e+"IA5String '"+ac(f(i,d))+"'\n";if("17"==l)return e+"UTCTime "+ac(f(i,d))+"\n";if("18"==l)return e+"GeneralizedTime "+ac(f(i,d))+"\n";if("1a"==l)return e+"VisualString '"+ac(f(i,d))+"'\n";if("1e"==l)return e+"BMPString '"+ao(f(i,d))+"'\n";if("30"==l){if("3000"==i.substr(d,4))return e+"SEQUENCE {}\n";var n=e+"SEQUENCE\n",s=h(i,d),t=b;if((2==s.length||3==s.length)&&"06"==i.substr(s[0],2)&&"04"==i.substr(s[s.length-1],2)){var q=W.oidname(f(i,s[0])),u=JSON.parse(JSON.stringify(b));u.x509ExtName=q,t=u}for(var v=0;v<s.length;v++)n+=g(i,t,s[v],e+"  ");return n}if("31"==l){for(var n=e+"SET\n",s=h(i,d),v=0;v<s.length;v++)n+=g(i,b,s[v],e+"  ");return n}var l=parseInt(l,16);if((128&l)!=0){var w=31&l;if((32&l)!=0){for(var n=e+"["+w+"]\n",s=h(i,d),v=0;v<s.length;v++)n+=g(i,b,s[v],e+"  ");return n}var m=f(i,d);if(W.isASN1HEX(m)){var n=e+"["+w+"]\n";return n+g(m,b,0,e+"  ")}"68747470"==m.substr(0,8)?m=ac(m):"subjectAltName"===b.x509ExtName&&2==w&&(m=ac(m));var n=e+"["+w+"] "+m+"\n";return n}return e+"UNKNOWN("+l+") "+f(i,d)+"\n"},W.parse=function(a){var b=W.parse,d=W.isASN1HEX,e=W.getV,f=W.getTLV,g=W.getChildIdx,h=c.asn1,i=h.ASN1Util.oidHexToInt,j=h.x509.OID.oid2name,k=ac,l={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"},m=a.substr(0,2),n={},o=e(a,0);if("01"==m)return"0101ff"==a?{bool:!0}:{bool:!1};if("02"==m)return{int:{hex:o}};if("03"==m)try{if("00"!=o.substr(0,2))throw"not encap";var p=o.substr(2);if(!d(p))throw"not encap";return{bitstr:{obj:b(p)}}}catch(a){var q=null;if(o.length<=10&&(q=function(a){if("string"!=typeof a||a.length%2!=0||!a.match(/^[0-9a-f]+$/))return null;try{var b=parseInt(a.substr(0,2),16);if(b<0||7<b)return null;for(var c=a.substr(2),d="",e=0;e<c.length;e+=2){var f=c.substr(e,2),g=parseInt(f,16).toString(2);g=("0000000"+g).slice(-8),d+=g}return d.substr(0,d.length-b)}catch(a){return null}}(o)),null==q)return{bitstr:{hex:o}};return{bitstr:{bin:q}}}if("04"==m)try{if(!d(o))throw"not encap";return{octstr:{obj:b(o)}}}catch(a){return{octstr:{hex:o}}}if("05"==m)return{null:""};else if("06"==m){var r=i(o),s=j(r);return""==s?{oid:r}:{oid:s}}else if("0a"==m)if(o.length>4)return{enum:{hex:o}};else return{enum:parseInt(o,16)};else if("30"==m||"31"==m)return n[l[m]]=function(a){for(var c=[],d=g(a,0),e=0;e<d.length;e++){var h=b(f(a,d[e]));c.push(h)}return c}(a),n;else if("14"==m){var t=function(a){return ac(function(a){for(var b=a.match(/.{1,2}/g),c=[],d=0;d<b.length;d++){var e=parseInt(b[d],16);161<=e&&e<=191?(c.push("c2"),c.push(b[d])):192<=e&&e<=255?(c.push("c3"),c.push((e-64).toString(16))):c.push(b[d])}return c.join("")}(a))}(o);return n[l[m]]={str:t},n}else if("1e"==m){var t=ao(o);return n[l[m]]={str:t},n}else if(-1!=":0c:12:13:16:17:18:1a:".indexOf(m)){var t=k(o);return n[l[m]]={str:t},n}else if(m.match(/^8[0-9]$/)){var t=k(o);return null==t|""==t||null!=t.match(/[\x00-\x1F\x7F-\x9F]/)||null!=t.match(/[\u0000-\u001F\u0080–\u009F]/)?{tag:{tag:m,explicit:!1,hex:o}}:{tag:{tag:m,explicit:!1,str:t}}}else if(m.match(/^a[0-9]$/))try{if(!d(o))throw Error("not encap");return{tag:{tag:m,explicit:!0,obj:b(o)}}}catch(a){return{tag:{tag:m,explicit:!0,hex:o}}}else{var u=new c.asn1.ASN1Object;return u.hV=o,{asn1:{tlv:m+u.getLengthHexFromValue()+o}}}},W.isContextTag=function(a,b){a=a.toLowerCase();try{c=parseInt(a,16)}catch(a){return -1}if(void 0===b)if((192&c)==128)return!0;else return!1;try{var c,d,e=b.match(/^\[[0-9]+\]$/);if(null==e||(d=parseInt(b.substr(1,b.length-1),10))>31)return!1;if((192&c)==128&&(31&c)==d)return!0;return!1}catch(a){return!1}},W.isASN1HEX=function(a){if(a.length%2==1)return!1;var b=W.getVblen(a,0),c=a.substr(0,2),d=W.getL(a,0);return a.length-c.length-d.length==2*b},W.checkStrictDER=function(a,b,d,e,f){if(void 0===d){if("string"!=typeof a||(a=a.toLowerCase(),!c.lang.String.isHex(a)))throw Error("not hex string");d=a.length,f=(e=a.length/2)<128?1:Math.ceil(e.toString(16))+1}if(W.getL(a,b).length>2*f)throw Error("L of TLV too long: idx="+b);var g=W.getVblen(a,b);if(g>e)throw Error("value of L too long than hex: idx="+b);var h=W.getTLV(a,b),i=h.length-2-W.getL(a,b).length;if(i!==2*g)throw Error("V string length and L's value not the same:"+i+"/"+2*g);if(0===b&&a.length!=h.length)throw Error("total length and TLV length unmatch:"+a.length+"!="+h.length);var j=a.substr(b,2);if("02"===j){var k=W.getVidx(a,b);if("00"==a.substr(k,2)&&56>a.charCodeAt(k+2))throw Error("not least zeros for DER INTEGER")}if(32&parseInt(j,16)){for(var l=W.getVblen(a,b),m=0,n=W.getChildIdx(a,b),o=0;o<n.length;o++)m+=W.getTLV(a,n[o]).length,W.checkStrictDER(a,n[o],d,e,f);if(2*l!=m)throw Error("sum of children's TLV length and L unmatch: "+2*l+"!="+m)}},W.oidname=function(a){var b=c.asn1;c.lang.String.isHex(a)&&(a=b.ASN1Util.oidHexToInt(a));var d=b.x509.OID.oid2name(a);return""===d&&(d=a),d},void 0!==c&&c||(c={}),void 0!==c.asn1&&c.asn1||(c.asn1={}),void 0!==c.asn1.x509&&c.asn1.x509||(c.asn1.x509={}),c.asn1.x509.Certificate=function(a){c.asn1.x509.Certificate.superclass.constructor.call(this);var b=c.asn1,d=b.DERBitString,e=b.DERSequence,f=b.x509,g=f.TBSCertificate,h=f.AlgorithmIdentifier;this.params=void 0,this.setByParam=function(a){this.params=a},this.sign=function(){var a=this.params,b=a.sigalg;void 0!=a.sigalg.name&&(b=a.sigalg.name);var d=a.tbsobj.tohex(),e=new c.crypto.Signature({alg:b});e.init(a.cakey),e.updateHex(d),a.sighex=e.sign()},this.getPEM=function(){return af(this.tohex(),"CERTIFICATE")},this.tohex=function(){var a=this.params;if((void 0==a.tbsobj||null==a.tbsobj)&&(a.tbsobj=new g(a)),void 0==a.sighex&&void 0!=a.cakey&&this.sign(),void 0==a.sighex)throw Error("sighex or cakey parameter not defined");var b=[];return b.push(a.tbsobj),b.push(new h({name:a.sigalg})),b.push(new d({hex:"00"+a.sighex})),new e({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&(this.params=a)},ay(c.asn1.x509.Certificate,c.asn1.ASN1Object),c.asn1.x509.TBSCertificate=function(a){c.asn1.x509.TBSCertificate.superclass.constructor.call(this);var b=c.asn1,d=b.x509,e=b.DERTaggedObject,f=b.DERInteger,g=b.DERSequence,h=d.AlgorithmIdentifier,i=d.Time,j=d.X500Name,k=d.Extensions,l=d.SubjectPublicKeyInfo;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=[],b=this.params;if(void 0!=b.version||1!=b.version){var d=2;void 0!=b.version&&(d=b.version-1);var m=new e({obj:new f({int:d})});a.push(m)}return a.push(new f(b.serial)),a.push(new h({name:b.sigalg})),a.push(new j(b.issuer)),a.push(new g({array:[new i(b.notbefore),new i(b.notafter)]})),a.push(new j(b.subject)),a.push(new l(az.getKey(b.sbjpubkey))),void 0!==b.ext&&b.ext.length>0&&a.push(new e({tag:"a3",obj:new k(b.ext)})),new c.asn1.DERSequence({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.x509.TBSCertificate,c.asn1.ASN1Object),c.asn1.x509.Extensions=function(a){c.asn1.x509.Extensions.superclass.constructor.call(this);var b=c.asn1,d=b.DERSequence,e=b.x509;this.aParam=[],this.setByParam=function(a){this.aParam=a},this.tohex=function(){for(var a=[],b=0;b<this.aParam.length;b++){var c=this.aParam[b],f=c.extname,g=null;if(void 0!=c.extn)g=new e.PrivateExtension(c);else if("subjectKeyIdentifier"==f)g=new e.SubjectKeyIdentifier(c);else if("keyUsage"==f)g=new e.KeyUsage(c);else if("subjectAltName"==f)g=new e.SubjectAltName(c);else if("issuerAltName"==f)g=new e.IssuerAltName(c);else if("basicConstraints"==f)g=new e.BasicConstraints(c);else if("nameConstraints"==f)g=new e.NameConstraints(c);else if("cRLDistributionPoints"==f)g=new e.CRLDistributionPoints(c);else if("certificatePolicies"==f)g=new e.CertificatePolicies(c);else if("policyMappings"==f)g=new e.PolicyMappings(c);else if("policyConstraints"==f)g=new e.PolicyConstraints(c);else if("inhibitAnyPolicy"==f)g=new e.InhibitAnyPolicy(c);else if("authorityKeyIdentifier"==f)g=new e.AuthorityKeyIdentifier(c);else if("extKeyUsage"==f)g=new e.ExtKeyUsage(c);else if("authorityInfoAccess"==f)g=new e.AuthorityInfoAccess(c);else if("cRLNumber"==f)g=new e.CRLNumber(c);else if("cRLReason"==f)g=new e.CRLReason(c);else if("ocspNonce"==f)g=new e.OCSPNonce(c);else if("ocspNoCheck"==f)g=new e.OCSPNoCheck(c);else if("adobeTimeStamp"==f)g=new e.AdobeTimeStamp(c);else if("subjectDirectoryAttributes"==f)g=new e.SubjectDirectoryAttributes(c);else throw Error("extension not supported:"+JSON.stringify(c));null!=g&&a.push(g)}return new d({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.x509.Extensions,c.asn1.ASN1Object),c.asn1.x509.Extension=function(a){c.asn1.x509.Extension.superclass.constructor.call(this);var b=c.asn1,d=b.DERObjectIdentifier,e=b.DEROctetString,f=(b.DERBitString,b.DERBoolean),g=b.DERSequence;this.tohex=function(){var a=new d({oid:this.oid}),b=new e({hex:this.getExtnValueHex()}),c=[];return c.push(a),this.critical&&c.push(new f),c.push(b),new g({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.critical=!1,void 0!==a&&void 0!==a.critical&&(this.critical=a.critical)},ay(c.asn1.x509.Extension,c.asn1.ASN1Object),c.asn1.x509.KeyUsage=function(a){c.asn1.x509.KeyUsage.superclass.constructor.call(this,a);var b=Error,d={digitalSignature:0,nonRepudiation:1,keyEncipherment:2,dataEncipherment:3,keyAgreement:4,keyCertSign:5,cRLSign:6,encipherOnly:7,decipherOnly:8};this.getExtnValueHex=function(){var a=this.getBinValue();return this.asn1ExtnValue=new c.asn1.DERBitString({bin:a}),this.asn1ExtnValue.tohex()},this.getBinValue=function(){var a=this.params;if("object"!=typeof a||"object"!=typeof a.names&&"string"!=typeof a.bin)throw new b("parameter not yet set");if(void 0!=a.names)return aw(a.names,d);if(void 0!=a.bin)return a.bin;throw new b("parameter not set properly")},this.oid="2.5.29.15",void 0!==a&&(this.params=a)},ay(c.asn1.x509.KeyUsage,c.asn1.x509.Extension),c.asn1.x509.BasicConstraints=function(a){c.asn1.x509.BasicConstraints.superclass.constructor.call(this,a);var b=c.asn1,d=b.DERBoolean,e=b.DERInteger,f=b.DERSequence;this.getExtnValueHex=function(){var a=[];this.cA&&a.push(new d),this.pathLen>-1&&a.push(new e({int:this.pathLen}));var b=new f({array:a});return this.asn1ExtnValue=b,this.asn1ExtnValue.tohex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==a&&(void 0!==a.cA&&(this.cA=a.cA),void 0!==a.pathLen&&(this.pathLen=a.pathLen))},ay(c.asn1.x509.BasicConstraints,c.asn1.x509.Extension),c.asn1.x509.CRLDistributionPoints=function(a){c.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,a);var b=c.asn1,d=b.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.setByDPArray=function(a){for(var e=[],f=0;f<a.length;f++)if(a[f]instanceof c.asn1.ASN1Object)e.push(a[f]);else{var g=new d.DistributionPoint(a[f]);e.push(g)}this.asn1ExtnValue=new b.DERSequence({array:e})},this.setByOneURI=function(a){var b=new d.DistributionPoint({fulluri:a});this.setByDPArray([b])},this.oid="2.5.29.31",void 0!==a&&(void 0!==a.array?this.setByDPArray(a.array):void 0!==a.uri&&this.setByOneURI(a.uri))},ay(c.asn1.x509.CRLDistributionPoints,c.asn1.x509.Extension),c.asn1.x509.DistributionPoint=function(a){c.asn1.x509.DistributionPoint.superclass.constructor.call(this);var b=c.asn1,d=b.x509.DistributionPointName;this.tohex=function(){var a=new b.DERSequence;if(null!=this.asn1DP){var c=new b.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});a.appendASN1Object(c)}return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(void 0!==a.dpobj?this.asn1DP=a.dpobj:void 0!==a.dpname?this.asn1DP=new d(a.dpname):void 0!==a.fulluri&&(this.asn1DP=new d({full:[{uri:a.fulluri}]})))},ay(c.asn1.x509.DistributionPoint,c.asn1.ASN1Object),c.asn1.x509.DistributionPointName=function(a){c.asn1.x509.DistributionPointName.superclass.constructor.call(this);var b=c.asn1,d=b.DERTaggedObject;if(this.tohex=function(){if("full"!=this.type)throw Error("currently type shall be 'full': "+this.type);return this.asn1Obj=new d({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a)if(b.x509.GeneralNames.prototype.isPrototypeOf(a))this.type="full",this.tag="a0",this.asn1V=a;else if(void 0!==a.full)this.type="full",this.tag="a0",this.asn1V=new b.x509.GeneralNames(a.full);else throw Error("This class supports GeneralNames only as argument")},ay(c.asn1.x509.DistributionPointName,c.asn1.ASN1Object),c.asn1.x509.CertificatePolicies=function(a){c.asn1.x509.CertificatePolicies.superclass.constructor.call(this,a);var b=c.asn1,d=b.x509,e=b.DERSequence,f=d.PolicyInformation;this.params=null,this.getExtnValueHex=function(){for(var a=[],b=0;b<this.params.array.length;b++)a.push(new f(this.params.array[b]));var c=new e({array:a});return this.asn1ExtnValue=c,this.asn1ExtnValue.tohex()},this.oid="2.5.29.32",void 0!==a&&(this.params=a)},ay(c.asn1.x509.CertificatePolicies,c.asn1.x509.Extension),c.asn1.x509.PolicyInformation=function(a){c.asn1.x509.PolicyInformation.superclass.constructor.call(this,a);var b=c.asn1,d=b.DERSequence,e=b.DERObjectIdentifier,f=b.x509.PolicyQualifierInfo;this.params=null,this.tohex=function(){if(void 0===this.params.policyoid&&void 0===this.params.array)throw Error("parameter oid and array missing");var a=[new e(this.params.policyoid)];if(void 0!==this.params.array){for(var b=[],c=0;c<this.params.array.length;c++)b.push(new f(this.params.array[c]));b.length>0&&a.push(new d({array:b}))}return new d({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(this.params=a)},ay(c.asn1.x509.PolicyInformation,c.asn1.ASN1Object),c.asn1.x509.PolicyQualifierInfo=function(a){c.asn1.x509.PolicyQualifierInfo.superclass.constructor.call(this,a);var b=c.asn1,d=b.DERSequence,e=b.DERIA5String,f=b.DERObjectIdentifier,g=b.x509.UserNotice;this.params=null,this.tohex=function(){if(void 0!==this.params.cps){var a=new d({array:[new f({oid:"1.3.6.1.5.5.7.2.1"}),new e({str:this.params.cps})]});return a.tohex()}if(void 0!=this.params.unotice){var a=new d({array:[new f({oid:"1.3.6.1.5.5.7.2.2"}),new g(this.params.unotice)]});return a.tohex()}},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(this.params=a)},ay(c.asn1.x509.PolicyQualifierInfo,c.asn1.ASN1Object),c.asn1.x509.UserNotice=function(a){c.asn1.x509.UserNotice.superclass.constructor.call(this,a);var b=c.asn1.DERSequence,d=(c.asn1.DERInteger,c.asn1.x509.DisplayText),e=c.asn1.x509.NoticeReference;this.params=null,this.tohex=function(){var a=[];return void 0!==this.params.noticeref&&a.push(new e(this.params.noticeref)),void 0!==this.params.exptext&&a.push(new d(this.params.exptext)),new b({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(this.params=a)},ay(c.asn1.x509.UserNotice,c.asn1.ASN1Object),c.asn1.x509.NoticeReference=function(a){c.asn1.x509.NoticeReference.superclass.constructor.call(this,a);var b=c.asn1.DERSequence,d=c.asn1.DERInteger,e=c.asn1.x509.DisplayText;this.params=null,this.tohex=function(){var a=[];if(void 0!==this.params.org&&a.push(new e(this.params.org)),void 0!==this.params.noticenum){for(var c=[],f=this.params.noticenum,g=0;g<f.length;g++)c.push(new d(f[g]));a.push(new b({array:c}))}if(0==a.length)throw Error("parameter is empty");return new b({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(this.params=a)},ay(c.asn1.x509.NoticeReference,c.asn1.ASN1Object),c.asn1.x509.DisplayText=function(a){c.asn1.x509.DisplayText.superclass.constructor.call(this,a),this.hT="0c",void 0!==a&&("ia5"===a.type?this.hT="16":"vis"===a.type?this.hT="1a":"bmp"===a.type&&(this.hT="1e"))},ay(c.asn1.x509.DisplayText,c.asn1.DERAbstractString),c.asn1.x509.PolicyMappings=function(a){c.asn1.x509.PolicyMappings.superclass.constructor.call(this,a);var b=c.asn1,d=(b.x509,b.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){for(var a=this.params,b=[],c=0;c<a.array.length;c++){var e=a.array[c];b.push({seq:[{oid:e[0]},{oid:e[1]}]})}return this.asn1ExtnValue=d({seq:b}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.33",void 0!==a&&(this.params=a)},ay(c.asn1.x509.PolicyMappings,c.asn1.x509.Extension),c.asn1.x509.PolicyConstraints=function(a){c.asn1.x509.PolicyConstraints.superclass.constructor.call(this,a);var b=c.asn1,d=(b.x509,b.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){var a=this.params,b=[];return void 0!=a.reqexp&&b.push({tag:{tagi:"80",obj:{int:a.reqexp}}}),void 0!=a.inhibit&&b.push({tag:{tagi:"81",obj:{int:a.inhibit}}}),this.asn1ExtnValue=d({seq:b}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.36",void 0!==a&&(this.params=a)},ay(c.asn1.x509.PolicyConstraints,c.asn1.x509.Extension),c.asn1.x509.InhibitAnyPolicy=function(a){c.asn1.x509.InhibitAnyPolicy.superclass.constructor.call(this,a);var b=c.asn1,d=(b.x509,b.ASN1Util.newObject);this.params=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=d({int:this.params.skip}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.54",void 0!==a&&(this.params=a)},ay(c.asn1.x509.InhibitAnyPolicy,c.asn1.x509.Extension),c.asn1.x509.NameConstraints=function(a){c.asn1.x509.NameConstraints.superclass.constructor.call(this,a);var b=c.asn1,d=b.x509,e=b.ASN1Util.newObject,f=d.GeneralSubtree;this.params=null,this.getExtnValueHex=function(){var a=this.params,b=[];if(void 0!=a.permit&&void 0!=a.permit.length){for(var c=[],d=0;d<a.permit.length;d++)c.push(new f(a.permit[d]));b.push({tag:{tagi:"a0",obj:{seq:c}}})}if(void 0!=a.exclude&&void 0!=a.exclude.length){for(var g=[],d=0;d<a.exclude.length;d++)g.push(new f(a.exclude[d]));b.push({tag:{tagi:"a1",obj:{seq:g}}})}return this.asn1ExtnValue=e({seq:b}),this.asn1ExtnValue.tohex()},this.oid="2.5.29.30",void 0!==a&&(this.params=a)},ay(c.asn1.x509.NameConstraints,c.asn1.x509.Extension),c.asn1.x509.GeneralSubtree=function(a){c.asn1.x509.GeneralSubtree.superclass.constructor.call(this);var b=c.asn1,d=b.x509.GeneralName,e=b.ASN1Util.newObject;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params,b=[new d(a)];return void 0!=a.min&&b.push({tag:{tagi:"80",obj:{int:a.min}}}),void 0!=a.max&&b.push({tag:{tagi:"81",obj:{int:a.max}}}),e({seq:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.x509.GeneralSubtree,c.asn1.ASN1Object),c.asn1.x509.ExtKeyUsage=function(a){c.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,a);var b=c.asn1;this.setPurposeArray=function(a){this.asn1ExtnValue=new b.DERSequence;for(var c=0;c<a.length;c++){var d=new b.DERObjectIdentifier(a[c]);this.asn1ExtnValue.appendASN1Object(d)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.37",void 0!==a&&void 0!==a.array&&this.setPurposeArray(a.array)},ay(c.asn1.x509.ExtKeyUsage,c.asn1.x509.Extension),c.asn1.x509.AuthorityKeyIdentifier=function(a){c.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,a);var b=c,d=b.asn1,e=d.DERTaggedObject,f=d.x509.GeneralNames;b.crypto.Util.isKey,this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var a=[];this.asn1KID&&a.push(new e({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&a.push(new e({explicit:!1,tag:"a1",obj:new f([{dn:this.asn1CertIssuer}])})),this.asn1CertSN&&a.push(new e({explicit:!1,tag:"82",obj:this.asn1CertSN}));var b=new d.DERSequence({array:a});return this.asn1ExtnValue=b,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(a){if(void 0!==a.str||void 0!==a.hex)this.asn1KID=new c.asn1.DEROctetString(a);else if("object"==typeof a&&c.crypto.Util.isKey(a)||"string"==typeof a&&-1!=a.indexOf("BEGIN ")){var b=a;"string"==typeof a&&(b=az.getKey(a));var d=az.getKeyID(b);this.asn1KID=new c.asn1.DEROctetString({hex:d})}},this.setCertIssuerByParam=function(a){void 0!==a.str||void 0!==a.ldapstr||void 0!==a.hex||void 0!==a.certsubject||void 0!==a.certissuer?this.asn1CertIssuer=new c.asn1.x509.X500Name(a):"string"==typeof a&&-1!=a.indexOf("BEGIN ")&&-1!=a.indexOf("CERTIFICATE")&&(this.asn1CertIssuer=new c.asn1.x509.X500Name({certissuer:a}))},this.setCertSNByParam=function(a){if(void 0!==a.str||void 0!==a.bigint||void 0!==a.hex)this.asn1CertSN=new c.asn1.DERInteger(a);else if("string"==typeof a&&-1!=a.indexOf("BEGIN ")&&a.indexOf("CERTIFICATE")){var b=new aD;b.readCertPEM(a);var d=b.getSerialNumberHex();this.asn1CertSN=new c.asn1.DERInteger({hex:d})}},this.oid="2.5.29.35",void 0!==a&&(void 0!==a.kid&&this.setKIDByParam(a.kid),void 0!==a.issuer&&this.setCertIssuerByParam(a.issuer),void 0!==a.sn&&this.setCertSNByParam(a.sn),void 0!==a.issuersn&&"string"==typeof a.issuersn&&-1!=a.issuersn.indexOf("BEGIN ")&&a.issuersn.indexOf("CERTIFICATE")&&(this.setCertSNByParam(a.issuersn),this.setCertIssuerByParam(a.issuersn)))},ay(c.asn1.x509.AuthorityKeyIdentifier,c.asn1.x509.Extension),c.asn1.x509.SubjectKeyIdentifier=function(a){c.asn1.x509.SubjectKeyIdentifier.superclass.constructor.call(this,a);var b=c.asn1.DEROctetString;this.asn1KID=null,this.getExtnValueHex=function(){return this.asn1ExtnValue=this.asn1KID,this.asn1ExtnValue.tohex()},this.setKIDByParam=function(a){if(void 0!==a.str||void 0!==a.hex)this.asn1KID=new b(a);else if("object"==typeof a&&c.crypto.Util.isKey(a)||"string"==typeof a&&-1!=a.indexOf("BEGIN")){var d=a;"string"==typeof a&&(d=az.getKey(a));var e=az.getKeyID(d);this.asn1KID=new c.asn1.DEROctetString({hex:e})}},this.oid="2.5.29.14",void 0!==a&&void 0!==a.kid&&this.setKIDByParam(a.kid)},ay(c.asn1.x509.SubjectKeyIdentifier,c.asn1.x509.Extension),c.asn1.x509.AuthorityInfoAccess=function(a){c.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,a),this.setAccessDescriptionArray=function(a){for(var b=[],d=c.asn1,e=d.DERSequence,f=d.DERObjectIdentifier,g=d.x509.GeneralName,h=0;h<a.length;h++){var i,j=a[h];if(void 0!==j.ocsp)i=new e({array:[new f({oid:"1.3.6.1.5.5.7.48.1"}),new g({uri:j.ocsp})]});else if(void 0!==j.caissuer)i=new e({array:[new f({oid:"1.3.6.1.5.5.7.48.2"}),new g({uri:j.caissuer})]});else throw Error("unknown AccessMethod parameter: "+JSON.stringify(j));b.push(i)}this.asn1ExtnValue=new e({array:b})},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==a&&void 0!==a.array&&this.setAccessDescriptionArray(a.array)},ay(c.asn1.x509.AuthorityInfoAccess,c.asn1.x509.Extension),c.asn1.x509.SubjectAltName=function(a){c.asn1.x509.SubjectAltName.superclass.constructor.call(this,a),this.setNameArray=function(a){this.asn1ExtnValue=new c.asn1.x509.GeneralNames(a)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.17",void 0!==a&&void 0!==a.array&&this.setNameArray(a.array)},ay(c.asn1.x509.SubjectAltName,c.asn1.x509.Extension),c.asn1.x509.IssuerAltName=function(a){c.asn1.x509.IssuerAltName.superclass.constructor.call(this,a),this.setNameArray=function(a){this.asn1ExtnValue=new c.asn1.x509.GeneralNames(a)},this.getExtnValueHex=function(){return this.asn1ExtnValue.tohex()},this.oid="2.5.29.18",void 0!==a&&void 0!==a.array&&this.setNameArray(a.array)},ay(c.asn1.x509.IssuerAltName,c.asn1.x509.Extension),c.asn1.x509.SubjectDirectoryAttributes=function(a){c.asn1.x509.SubjectDirectoryAttributes.superclass.constructor.call(this,a);var b=c.asn1,d=b.DERSequence,e=b.ASN1Util.newObject,f=b.x509.OID.name2oid;this.params=null,this.getExtnValueHex=function(){for(var a=[],b=0;b<this.params.array.length;b++){var c=this.params.array[b];if(void 0!=c.attr&&void 0!=c.array){var g={seq:[{oid:c.attr},{set:c.array}]};a.push(e(g));continue}var h={seq:[{oid:"1.2.3.4"},{set:[{utf8str:"DE"}]}]};if("dateOfBirth"==c.attr)h.seq[0].oid=f(c.attr),h.seq[1].set[0]={gentime:c.str};else if("placeOfBirth"==c.attr)h.seq[0].oid=f(c.attr),h.seq[1].set[0]={utf8str:c.str};else if("gender"==c.attr)h.seq[0].oid=f(c.attr),h.seq[1].set[0]={prnstr:c.str};else if("countryOfCitizenship"==c.attr)h.seq[0].oid=f(c.attr),h.seq[1].set[0]={prnstr:c.str};else if("countryOfResidence"==c.attr)h.seq[0].oid=f(c.attr),h.seq[1].set[0]={prnstr:c.str};else throw Error("unsupported attribute: "+c.attr);a.push(new e(h))}var i=new d({array:a});return this.asn1ExtnValue=i,this.asn1ExtnValue.tohex()},this.oid="2.5.29.9",void 0!==a&&(this.params=a)},ay(c.asn1.x509.SubjectDirectoryAttributes,c.asn1.x509.Extension),c.asn1.x509.PrivateExtension=function(a){c.asn1.x509.PrivateExtension.superclass.constructor.call(this,a);var b=c,d=b.lang.String.isHex,e=b.asn1,f=e.x509.OID.name2oid,g=e.ASN1Util.newObject;this.params=null,this.setByParam=function(a){this.oid=f(a.extname),this.params=a},this.getExtnValueHex=function(){if(void 0==this.params.extname||void 0==this.params.extn)throw Error("extname or extnhex not specified");var a=this.params.extn;if("string"==typeof a&&d(a))return a;if("object"==typeof a)try{return g(a).tohex()}catch(a){}throw Error("unsupported extn value")},void 0!=a&&this.setByParam(a)},ay(c.asn1.x509.PrivateExtension,c.asn1.x509.Extension),c.asn1.x509.CRL=function(a){c.asn1.x509.CRL.superclass.constructor.call(this);var b=c.asn1,d=b.DERSequence,e=b.DERBitString,f=b.x509,g=f.AlgorithmIdentifier,h=f.TBSCertList;this.params=void 0,this.setByParam=function(a){this.params=a},this.sign=function(){var a=new h(this.params).tohex(),b=new c.crypto.Signature({alg:this.params.sigalg});b.init(this.params.cakey),b.updateHex(a);var d=b.sign();this.params.sighex=d},this.getPEM=function(){return af(this.tohex(),"X509 CRL")},this.tohex=function(){var a=this.params;if(void 0==a.tbsobj&&(a.tbsobj=new h(a)),void 0==a.sighex&&void 0!=a.cakey&&this.sign(),void 0==a.sighex)throw Error("sighex or cakey parameter not defined");var b=[];return b.push(a.tbsobj),b.push(new g({name:a.sigalg})),b.push(new e({hex:"00"+a.sighex})),new d({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&(this.params=a)},ay(c.asn1.x509.CRL,c.asn1.ASN1Object),c.asn1.x509.TBSCertList=function(a){c.asn1.x509.TBSCertList.superclass.constructor.call(this);var b=c.asn1,d=b.DERInteger,e=b.DERSequence,f=b.DERTaggedObject,g=(b.DERObjectIdentifier,b.x509),h=g.AlgorithmIdentifier,i=g.Time,j=g.Extensions,k=g.X500Name;this.params=null,this.setByParam=function(a){this.params=a},this.getRevCertSequence=function(){for(var a=[],b=this.params.revcert,c=0;c<b.length;c++){var f=[new d(b[c].sn),new i(b[c].date)];void 0!=b[c].ext&&f.push(new j(b[c].ext)),a.push(new e({array:f}))}return new e({array:a})},this.tohex=function(){var a=[],b=this.params;if(void 0!=b.version){var c=new d({int:b.version-1});a.push(c)}if(a.push(new h({name:b.sigalg})),a.push(new k(b.issuer)),a.push(new i(b.thisupdate)),void 0!=b.nextupdate&&a.push(new i(b.nextupdate)),void 0!=b.revcert&&a.push(this.getRevCertSequence()),void 0!=b.ext){var g=new j(b.ext);a.push(new f({tag:"a0",explicit:!0,obj:g}))}return new e({array:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.x509.TBSCertList,c.asn1.ASN1Object),c.asn1.x509.CRLEntry=function(a){c.asn1.x509.CRLEntry.superclass.constructor.call(this);var b=c.asn1;this.setCertSerial=function(a){this.sn=new b.DERInteger(a)},this.setRevocationDate=function(a){this.time=new b.x509.Time(a)},this.tohex=function(){var a=new b.DERSequence({array:[this.sn,this.time]});return this.TLV=a.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(void 0!==a.time&&this.setRevocationDate(a.time),void 0!==a.sn&&this.setCertSerial(a.sn))},ay(c.asn1.x509.CRLEntry,c.asn1.ASN1Object),c.asn1.x509.CRLNumber=function(a){c.asn1.x509.CRLNumber.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new c.asn1.DERInteger(this.params.num),this.asn1ExtnValue.tohex()},this.oid="2.5.29.20",void 0!=a&&(this.params=a)},ay(c.asn1.x509.CRLNumber,c.asn1.x509.Extension),c.asn1.x509.CRLReason=function(a){c.asn1.x509.CRLReason.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new c.asn1.DEREnumerated(this.params.code),this.asn1ExtnValue.tohex()},this.oid="2.5.29.21",void 0!=a&&(this.params=a)},ay(c.asn1.x509.CRLReason,c.asn1.x509.Extension),c.asn1.x509.OCSPNonce=function(a){c.asn1.x509.OCSPNonce.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new c.asn1.DEROctetString(this.params),this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.2",void 0!=a&&(this.params=a)},ay(c.asn1.x509.OCSPNonce,c.asn1.x509.Extension),c.asn1.x509.OCSPNoCheck=function(a){c.asn1.x509.OCSPNoCheck.superclass.constructor.call(this,a),this.params=void 0,this.getExtnValueHex=function(){return this.asn1ExtnValue=new c.asn1.DERNull,this.asn1ExtnValue.tohex()},this.oid="1.3.6.1.5.5.7.48.1.5",void 0!=a&&(this.params=a)},ay(c.asn1.x509.OCSPNoCheck,c.asn1.x509.Extension),c.asn1.x509.AdobeTimeStamp=function(a){c.asn1.x509.AdobeTimeStamp.superclass.constructor.call(this,a);var b=c.asn1,d=b.DERInteger,e=b.DERBoolean,f=b.DERSequence,g=b.x509.GeneralName;this.params=null,this.getExtnValueHex=function(){var a=this.params,b=[new d(1)];return b.push(new g({uri:a.uri})),void 0!=a.reqauth&&b.push(new e(a.reqauth)),this.asn1ExtnValue=new f({array:b}),this.asn1ExtnValue.tohex()},this.oid="1.2.840.113583.1.1.9.1",void 0!==a&&this.setByParam(a)},ay(c.asn1.x509.AdobeTimeStamp,c.asn1.x509.Extension),c.asn1.x509.X500Name=function(a){c.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var b=c.asn1,d=b.x509,e=d.RDN;this.setByString=function(a,b){void 0!==b&&(this.sRule=b);var c=a.split("/");c.shift();for(var d=[],f=0;f<c.length;f++)if(c[f].match(/^[^=]+=.+$/))d.push(c[f]);else{var g=d.length-1;d[g]=d[g]+"/"+c[f]}for(var f=0;f<d.length;f++)this.asn1Array.push(new e({str:d[f],rule:this.sRule}))},this.setByLdapString=function(a,b){void 0!==b&&(this.sRule=b);var c=d.X500Name.ldapToCompat(a);this.setByString(c,b)},this.setByObject=function(a,b){for(var c in void 0!==b&&(this.sRule=b),a)if(a.hasOwnProperty(c)){var d=new e({str:c+"="+a[c],rule:this.sRule});this.asn1Array?this.asn1Array.push(d):this.asn1Array=[d]}},this.setByParam=function(a){if(void 0!==a.rule&&(this.sRule=a.rule),void 0!==a.array)this.paramArray=a.array;else if(void 0!==a.str)this.setByString(a.str);else if(void 0!==a.ldapstr)this.setByLdapString(a.ldapstr);else if(void 0!==a.hex)this.hTLV=a.hex;else if(void 0!==a.certissuer){var b=new aD;b.readCertPEM(a.certissuer),this.hTLV=b.getIssuerHex()}else if(void 0!==a.certsubject){var b=new aD;b.readCertPEM(a.certsubject),this.hTLV=b.getSubjectHex()}else"object"==typeof a&&void 0===a.certsubject&&void 0===a.certissuer&&this.setByObject(a)},this.tohex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(0==this.asn1Array.length&&this.paramArray.length>0)for(var a=0;a<this.paramArray.length;a++){var c={array:this.paramArray[a]};"utf8"!=this.sRule&&(c.rule=this.sRule);var d=new e(c);this.asn1Array.push(d)}var f=new b.DERSequence({array:this.asn1Array});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.x509.X500Name,c.asn1.ASN1Object),c.asn1.x509.X500Name.compatToLDAP=function(a){if("/"!==a.substr(0,1))throw"malformed input";var b=(a=a.substr(1)).split("/");return b.reverse(),(b=b.map(function(a){return a.replace(/,/,"\\,")})).join(",")},c.asn1.x509.X500Name.onelineToLDAP=function(a){return c.asn1.x509.X500Name.compatToLDAP(a)},c.asn1.x509.X500Name.ldapToCompat=function(a){for(var b=a.split(","),c=!1,d=[],e=0;b.length>0;e++){var f=b.shift();if(!0===c){var g=(d.pop()+","+f).replace(/\\,/g,",");d.push(g),c=!1}else d.push(f);"\\"===f.substr(-1,1)&&(c=!0)}return(d=d.map(function(a){return a.replace("/","\\/")})).reverse(),"/"+d.join("/")},c.asn1.x509.X500Name.ldapToOneline=function(a){return c.asn1.x509.X500Name.ldapToCompat(a)},c.asn1.x509.RDN=function(a){c.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=[],this.paramArray=[],this.sRule="utf8";var b=c.asn1.x509.AttributeTypeAndValue;this.setByParam=function(a){void 0!==a.rule&&(this.sRule=a.rule),void 0!==a.str&&this.addByMultiValuedString(a.str),void 0!==a.array&&(this.paramArray=a.array)},this.addByString=function(a){this.asn1Array.push(new c.asn1.x509.AttributeTypeAndValue({str:a,rule:this.sRule}))},this.addByMultiValuedString=function(a){for(var b=c.asn1.x509.RDN.parseString(a),d=0;d<b.length;d++)this.addByString(b[d])},this.tohex=function(){if(0==this.asn1Array.length&&this.paramArray.length>0)for(var a=0;a<this.paramArray.length;a++){var d=this.paramArray[a];void 0!==d.rule&&"utf8"!=this.sRule&&(d.rule=this.sRule);var e=new b(d);this.asn1Array.push(e)}var f=new c.asn1.DERSet({array:this.asn1Array});return this.TLV=f.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.x509.RDN,c.asn1.ASN1Object),c.asn1.x509.RDN.parseString=function(a){for(var b=a.split(/\+/),c=!1,d=[],e=0;b.length>0;e++){var f=b.shift();if(!0===c){var g=(d.pop()+"+"+f).replace(/\\\+/g,"+");d.push(g),c=!1}else d.push(f);"\\"===f.substr(-1,1)&&(c=!0)}for(var h=!1,i=[],e=0;d.length>0;e++){var f=d.shift();if(!0===h){var j=i.pop();if(f.match(/"$/)){var g=(j+"+"+f).replace(/^([^=]+)="(.*)"$/,"$1=$2");i.push(g),h=!1}else i.push(j+"+"+f)}else i.push(f);f.match(/^[^=]+="/)&&(h=!0)}return i},c.asn1.x509.AttributeTypeAndValue=function(a){c.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this),this.sRule="utf8",this.sType=null,this.sValue=null,this.dsType=null;var b=c,d=b.asn1,e=d.DERSequence,f=d.DERUTF8String,g=d.DERPrintableString,h=d.DERTeletexString,i=d.DERIA5String,j=d.DERVisibleString,k=d.DERBMPString,l=b.lang.String.isMail,m=b.lang.String.isPrintable;this.setByParam=function(a){if(void 0!==a.rule&&(this.sRule=a.rule),void 0!==a.ds&&(this.dsType=a.ds),void 0===a.value&&void 0!==a.str){var b=a.str.match(/^([^=]+)=(.+)$/);if(b)this.sType=b[1],this.sValue=b[2];else throw Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)}else this.sType=a.type,this.sValue=a.value},this.setByString=function(a,b){void 0!==b&&(this.sRule=b);var c=a.match(/^([^=]+)=(.+)$/);if(c)this.setByAttrTypeAndValueStr(c[1],c[2]);else throw Error("malformed attrTypeAndValueStr: "+attrTypeAndValueStr)},this._getDsType=function(){var a=this.sType,b=this.sValue,c=this.sRule;if("prn"===c){if("CN"==a&&l(b))return"ia5";if(m(b))return"prn"}else if("utf8"===c){if("CN"==a&&l(b))return"ia5";if("C"==a)return"prn"}return"utf8"},this.setByAttrTypeAndValueStr=function(a,b,c){void 0!==c&&(this.sRule=c),this.sType=a,this.sValue=b},this.getValueObj=function(a,b){if("utf8"==a)return new f({str:b});if("prn"==a)return new g({str:b});if("tel"==a)return new h({str:b});if("ia5"==a)return new i({str:b});if("vis"==a)return new j({str:b});if("bmp"==a)return new k({str:b});throw Error("unsupported directory string type: type="+a+" value="+b)},this.tohex=function(){null==this.dsType&&(this.dsType=this._getDsType());var a=new e({array:[c.asn1.x509.OID.atype2obj(this.sType),this.getValueObj(this.dsType,this.sValue)]});return this.TLV=a.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.x509.AttributeTypeAndValue,c.asn1.ASN1Object),c.asn1.x509.SubjectPublicKeyInfo=function(a){c.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var b=c,d=b.asn1,e=d.DERInteger,f=d.DERBitString,g=d.DERObjectIdentifier,h=d.DERSequence,i=d.ASN1Util.newObject,j=d.x509.AlgorithmIdentifier,k=b.crypto;k.ECDSA,k.DSA,this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new h({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.tohex=function(){var a=this.getASN1Object();return this.hTLV=a.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},this.setPubKey=function(a){try{if(a instanceof R){var b=i({seq:[{int:{bigint:a.n}},{int:{int:a.e}}]}).tohex();this.asn1AlgId=new j({name:"rsaEncryption"}),this.asn1SubjPKey=new f({hex:"00"+b})}}catch(a){}try{if(a instanceof c.crypto.ECDSA){var d=new g({name:a.curveName});this.asn1AlgId=new j({name:"ecPublicKey",asn1params:d}),this.asn1SubjPKey=new f({hex:"00"+a.pubKeyHex})}}catch(a){}try{if(a instanceof c.crypto.DSA){var d=new i({seq:[{int:{bigint:a.p}},{int:{bigint:a.q}},{int:{bigint:a.g}}]});this.asn1AlgId=new j({name:"dsa",asn1params:d});var h=new e({bigint:a.y});this.asn1SubjPKey=new f({hex:"00"+h.tohex()})}}catch(a){}},void 0!==a&&this.setPubKey(a)},ay(c.asn1.x509.SubjectPublicKeyInfo,c.asn1.ASN1Object),c.asn1.x509.Time=function(a){c.asn1.x509.Time.superclass.constructor.call(this);var b=c.asn1,d=b.DERUTCTime,e=b.DERGeneralizedTime;this.params=null,this.type=null,this.setTimeParams=function(a){this.timeParams=a},this.setByParam=function(a){this.params=a},this.getType=function(a){return a.match(/^[0-9]{12}Z$/)?"utc":a.match(/^[0-9]{14}Z$/)?"gen":a.match(/^[0-9]{12}\.[0-9]+Z$/)?"utc":a.match(/^[0-9]{14}\.[0-9]+Z$/)?"gen":null},this.tohex=function(){var a=this.params,b=null;if("string"==typeof a&&(a={str:a}),null!=a&&a.str&&(null==a.type||void 0==a.type)&&(a.type=this.getType(a.str)),null!=a&&a.str?("utc"==a.type&&(b=new d(a.str)),"gen"==a.type&&(b=new e(a.str))):b="gen"==this.type?new e:new d,null==b)throw Error("wrong setting for Time");return this.TLV=b.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},c.asn1.x509.Time_bak=function(a){c.asn1.x509.Time_bak.superclass.constructor.call(this);var b=c.asn1,d=b.DERUTCTime,e=b.DERGeneralizedTime;this.setTimeParams=function(a){this.timeParams=a},this.tohex=function(){var a=null;return a=null!=this.timeParams?"utc"==this.type?new d(this.timeParams):new e(this.timeParams):"utc"==this.type?new d:new e,this.TLV=a.tohex(),this.TLV},this.getEncodedHex=function(){return this.tohex()},this.type="utc",void 0!==a&&(void 0!==a.type?this.type=a.type:void 0!==a.str&&(a.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),a.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=a)},ay(c.asn1.x509.Time,c.asn1.ASN1Object),c.asn1.x509.AlgorithmIdentifier=function(a){c.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var b=c.asn1,d=b.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV;if(this.tohex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw Error("algorithm not specified");if(null!==this.nameAlg){var a=null;for(var c in d)c===this.nameAlg&&(a=d[c]);if(null!==a)return this.hTLV=a,this.hTLV}null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=b.x509.OID.name2obj(this.nameAlg));var e=[this.asn1Alg];null!==this.asn1Params&&e.push(this.asn1Params);var f=new b.DERSequence({array:e});return this.hTLV=f.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&(void 0!==a.name&&(this.nameAlg=a.name),void 0!==a.asn1params&&(this.asn1Params=a.asn1params),void 0!==a.paramempty&&(this.paramEmpty=a.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){void 0!==this.nameAlg.name&&(this.nameAlg=this.nameAlg.name);var e=this.nameAlg.toLowerCase();"withdsa"!==e.substr(-7,7)&&"withecdsa"!==e.substr(-9,9)&&(this.asn1Params=new b.DERNull)}},ay(c.asn1.x509.AlgorithmIdentifier,c.asn1.ASN1Object),c.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV={SHAwithRSAandMGF1:"300d06092a864886f70d01010a3000",SHA256withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040201a11a301806092a864886f70d010108300b0609608648016503040201a203020120",SHA384withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040202a11a301806092a864886f70d010108300b0609608648016503040202a203020130",SHA512withRSAandMGF1:"303d06092a864886f70d01010a3030a00d300b0609608648016503040203a11a301806092a864886f70d010108300b0609608648016503040203a203020140"},c.asn1.x509.GeneralName=function(a){c.asn1.x509.GeneralName.superclass.constructor.call(this);var b=c.asn1,d=b.x509,e=d.X500Name,f=d.OtherName,g=b.DERIA5String,h=(b.DERPrintableString,b.DEROctetString),i=b.DERTaggedObject,j=b.ASN1Object,k=Error;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params,b=!1;if(void 0!==a.other)o="a0",d=new f(a.other);else if(void 0!==a.rfc822)o="81",d=new g({str:a.rfc822});else if(void 0!==a.dns)o="82",d=new g({str:a.dns});else if(void 0!==a.dn)o="a4",b=!0,d="string"==typeof a.dn?new e({str:a.dn}):a.dn instanceof c.asn1.x509.X500Name?a.dn:new e(a.dn);else if(void 0!==a.ldapdn)o="a4",b=!0,d=new e({ldapstr:a.ldapdn});else if(void 0!==a.certissuer||void 0!==a.certsubj){var d,l,m,n,o="a4",b=!0,p=null;if(void 0!==a.certsubj?(l=!1,m=a.certsubj):(l=!0,m=a.certissuer),m.match(/^[0-9A-Fa-f]+$/),-1!=m.indexOf("-----BEGIN ")&&(p=ag(m)),null==p)throw Error("certsubj/certissuer not cert");var q=new aD;q.hex=p,n=l?q.getIssuerHex():q.getSubjectHex(),(d=new j).hTLV=n}else if(void 0!==a.uri)o="86",d=new g({str:a.uri});else if(void 0!==a.ip){o="87";var r,s=a.ip;try{if(s.match(/^[0-9a-f]+$/)){var t=s.length;if(8==t||16==t||32==t||64==t)r=s;else throw"err"}else r=function a(b){var c=Error("malformed IP address");if(!(b=b.toLowerCase(b)).match(/^[0-9a-f.:/]+$/))throw c;if(b.match(/^[0-9.]+$/)){var d=b.split(".");if(4!==d.length)throw c;var e="";try{for(var f=0;f<4;f++){var g=parseInt(d[f]);e+=("0"+g.toString(16)).slice(-2)}return e}catch(a){throw c}}if(b.match(/^[0-9.]+\/[0-9]+$/)){var h=b.split("/");return a(h[0])+an(parseInt(h[1]),32)}if(b.match(/^[0-9a-f:]+$/)&&-1!==b.indexOf(":"))return aj(b);if(b.match(/^[0-9a-f:]+\/[0-9]+$/)&&-1!==b.indexOf(":")){var h=b.split("/");return aj(h[0])+an(parseInt(h[1]),128)}throw c}(s)}catch(b){throw new k("malformed IP address: "+a.ip+":"+b.message)}d=new h({hex:r})}else throw new k("improper params");return new i({tag:o,explicit:b,obj:d}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.x509.GeneralName,c.asn1.ASN1Object),c.asn1.x509.GeneralNames=function(a){c.asn1.x509.GeneralNames.superclass.constructor.call(this);var b=c.asn1;this.setByParamArray=function(a){for(var c=0;c<a.length;c++){var d=new b.x509.GeneralName(a[c]);this.asn1Array.push(d)}},this.tohex=function(){return new b.DERSequence({array:this.asn1Array}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.asn1Array=[],void 0!==a&&this.setByParamArray(a)},ay(c.asn1.x509.GeneralNames,c.asn1.ASN1Object),c.asn1.x509.OtherName=function(a){c.asn1.x509.OtherName.superclass.constructor.call(this);var b=c.asn1,d=b.DERObjectIdentifier,e=b.DERSequence,f=b.ASN1Util.newObject;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if(void 0==a.oid||void 0==a.value)throw Error("oid or value not specified");return new e({array:[new d({oid:a.oid}),f({tag:{tag:"a0",explicit:!0,obj:a.value}})]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.x509.OtherName,c.asn1.ASN1Object),c.asn1.x509.OID=new function(){var a=c.asn1.DERObjectIdentifier;this.name2oidList={"aes128-CBC":"2.16.840.1.101.3.4.1.2","aes256-CBC":"2.16.840.1.101.3.4.1.42",sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",hmacWithSHA1:"1.2.840.113549.2.7",hmacWithSHA224:"1.2.840.113549.2.8",hmacWithSHA256:"1.2.840.113549.2.9",hmacWithSHA384:"1.2.840.113549.2.10",hmacWithSHA512:"1.2.840.113549.2.11",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5","pkcs1-MGF":"1.2.840.113549.1.1.8",rsaPSS:"1.2.840.113549.1.1.10",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",givenName:"2.5.4.42",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectDirectoryAttributes:"2.5.29.9",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",cRLNumber:"2.5.29.20",cRLReason:"2.5.29.21",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",anyPolicy:"2.5.29.32.0",policyMappings:"2.5.29.33",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",inhibitAnyPolicy:"2.5.29.54",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",ocspBasic:"1.3.6.1.5.5.7.48.1.1",ocspNonce:"1.3.6.1.5.5.7.48.1.2",ocspNoCheck:"1.3.6.1.5.5.7.48.1.5",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",smtpUTF8Mailbox:"1.3.6.1.5.5.7.8.9",dateOfBirth:"1.3.6.1.5.5.7.9.1",placeOfBirth:"1.3.6.1.5.5.7.9.2",gender:"1.3.6.1.5.5.7.9.3",countryOfCitizenship:"1.3.6.1.5.5.7.9.4",countryOfResidence:"1.3.6.1.5.5.7.9.5",ecPublicKey:"1.2.840.10045.2.1","P-256":"1.2.840.10045.3.1.7",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",secp521r1:"1.3.132.0.35",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",signingCertificate:"1.2.840.113549.1.9.16.2.12",timeStampToken:"1.2.840.113549.1.9.16.2.14",signaturePolicyIdentifier:"1.2.840.113549.1.9.16.2.15",etsArchiveTimeStamp:"1.2.840.113549.1.9.16.2.27",signingCertificateV2:"1.2.840.113549.1.9.16.2.47",etsArchiveTimeStampV2:"1.2.840.113549.1.9.16.2.48",extensionRequest:"1.2.840.113549.1.9.14",contentType:"1.2.840.113549.1.9.3",messageDigest:"1.2.840.113549.1.9.4",signingTime:"1.2.840.113549.1.9.5",counterSignature:"1.2.840.113549.1.9.6",archiveTimeStampV3:"0.4.0.1733.2.4",pdfRevocationInfoArchival:"1.2.840.113583.1.1.8",adobeTimeStamp:"1.2.840.113583.1.1.9.1",smimeMailboxLegacy:"2.23.140.1.5.1.1",smimeMailboxMulti:"2.23.140.1.5.1.2",smimeMailboxStrict:"2.23.140.1.5.1.3",smimeOrganizationLegacy:"2.23.140.1.5.2.1",smimeOrganizationMulti:"2.23.140.1.5.2.2",smimeOrganizationStrict:"2.23.140.1.5.2.3",smimeSponsorLegacy:"2.23.140.1.5.3.1",smimeSponsorMulti:"2.23.140.1.5.3.2",smimeSponsorStrict:"2.23.140.1.5.3.3",smimeIndividualLegacy:"2.23.140.1.5.4.1",smimeIndividualMulti:"2.23.140.1.5.4.2",smimeIndividualStrict:"2.23.140.1.5.4.3"},this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",GN:"2.5.4.42",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.objCache={},this.name2obj=function(b){if(void 0!==this.objCache[b])return this.objCache[b];if(void 0===this.name2oidList[b])throw"Name of ObjectIdentifier not defined: "+b;var c=new a({oid:this.name2oidList[b]});return this.objCache[b]=c,c},this.atype2obj=function(b){if(void 0!==this.objCache[b])return this.objCache[b];if(b.match(/^\d+\.\d+\.[0-9.]+$/))c=b;else if(void 0!==this.atype2oidList[b])c=this.atype2oidList[b];else if(void 0!==this.name2oidList[b])c=this.name2oidList[b];else throw Error("AttributeType name undefined: "+b);var c,d=new a({oid:c});return this.objCache[b]=d,d},this.registerOIDs=function(a){if(this.checkOIDs(a))for(var b in a)this.name2oidList[b]=a[b]},this.checkOIDs=function(a){try{var b=Object.keys(a);if(0==b.length)return!1;return b.map(function(a,b,c){if(!this[a].match(/^[0-2]\.[0-9.]+$/))throw Error("value is not OID")},a),!0}catch(a){return!1}}},c.asn1.x509.OID.oid2name=function(a){var b=c.asn1.x509.OID.name2oidList;for(var d in b)if(b[d]==a)return d;return""},c.asn1.x509.OID.oid2atype=function(a){var b=c.asn1.x509.OID.atype2oidList;for(var d in b)if(b[d]==a)return d;return a},c.asn1.x509.OID.name2oid=function(a){if(a.match(/^[0-9.]+$/))return a;var b=c.asn1.x509.OID.name2oidList;return void 0===b[a]?"":b[a]},c.asn1.x509.X509Util={},c.asn1.x509.X509Util.newCertPEM=function(a){var b=c.asn1.x509;return new(b.TBSCertificate,b.Certificate)(a).getPEM()},void 0!==c&&c||(c={}),void 0!==c.asn1&&c.asn1||(c.asn1={}),void 0!==c.asn1.cms&&c.asn1.cms||(c.asn1.cms={}),c.asn1.cms.Attribute=function(a){var b=Error,d=c.asn1,e=d.DERSequence,f=d.DERSet,g=d.DERObjectIdentifier;this.params=null,this.typeOid=null,this.setByParam=function(a){this.params=a},this.getValueArray=function(){throw new b("not yet implemented abstract")},this.tohex=function(){return new e({array:[new g({oid:this.typeOid}),new f({array:this.getValueArray()})]}).tohex()},this.getEncodedHex=function(){return this.tohex()}},ay(c.asn1.cms.Attribute,c.asn1.ASN1Object),c.asn1.cms.ContentType=function(a){var b=c.asn1;b.cms.ContentType.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.3",this.getValueArray=function(){return[new b.DERObjectIdentifier(this.params.type)]},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.ContentType,c.asn1.cms.Attribute),c.asn1.cms.MessageDigest=function(a){var b=c.asn1,d=b.DEROctetString;b.cms.MessageDigest.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.4",this.getValueArray=function(){return[new d(this.params)]},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.MessageDigest,c.asn1.cms.Attribute),c.asn1.cms.SigningTime=function(a){var b=c.asn1;b.cms.SigningTime.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.5",this.getValueArray=function(){return[new b.x509.Time(this.params)]},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.SigningTime,c.asn1.cms.Attribute),c.asn1.cms.SigningCertificate=function(a){var b=Error,d=c,e=d.asn1,f=e.DERSequence,g=e.cms,h=g.ESSCertID;d.crypto,g.SigningCertificate.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.12",this.getValueArray=function(){if(null==this.params||void 0==this.params||void 0==this.params.array)throw new b("parameter 'array' not specified");for(var c=this.params.array,d=[],e=0;e<c.length;e++){var g=c[e];!1==a.hasis&&"string"==typeof g&&(-1!=g.indexOf("-----BEGIN")||W.isASN1HEX(g))&&(g={cert:g}),!1!=g.hasis&&!1==a.hasis&&(g.hasis=!1),d.push(new h(g))}var i=new f({array:d});return[new f({array:[i]})]},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.SigningCertificate,c.asn1.cms.Attribute),c.asn1.cms.ESSCertID=function(a){c.asn1.cms.ESSCertID.superclass.constructor.call(this);var b=Error,d=c,e=d.asn1,f=e.DEROctetString,g=e.DERSequence,h=e.cms.IssuerSerial;this.params=null,this.getCertHash=function(a,c){var e,f,g;if(void 0!=a.hash)return a.hash;if("string"==typeof a&&-1==a.indexOf("-----BEGIN")&&!W.isASN1HEX(a))return a;if("string"==typeof a)e=a;else if(void 0!=a.cert)e=a.cert;else throw new b("hash nor cert unspecified");if(f=-1!=e.indexOf("-----BEGIN")?ag(e):e,"string"==typeof a&&(-1!=a.indexOf("-----BEGIN")?f=ag(a):W.isASN1HEX(a)&&(f=a)),void 0!=a.alg)g=a.alg;else if(void 0!=c)g=c;else throw new b("hash alg unspecified");return d.crypto.Util.hashHex(f,g)},this.tohex=function(){var a=this.params,b=this.getCertHash(a,"sha1"),c=[];return c.push(new f({hex:b})),("string"==typeof a&&-1!=a.indexOf("-----BEGIN")||void 0!=a.cert&&!1!=a.hasis||void 0!=a.issuer&&void 0!=a.serial)&&c.push(new h(a)),new g({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.ESSCertID,c.asn1.ASN1Object),c.asn1.cms.SigningCertificateV2=function(a){var b=Error,d=c,e=d.asn1,f=e.DERSequence,g=(e.x509,e.cms),h=g.ESSCertIDv2;d.crypto,g.SigningCertificateV2.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.47",this.getValueArray=function(){if(null==this.params||void 0==this.params||void 0==this.params.array)throw new b("parameter 'array' not specified");for(var c=this.params.array,d=[],e=0;e<c.length;e++){var g=c[e];(void 0!=a.alg||!1==a.hasis)&&"string"==typeof g&&(-1!=g.indexOf("-----BEGIN")||W.isASN1HEX(g))&&(g={cert:g}),void 0==g.alg&&void 0!=a.alg&&(g.alg=a.alg),!1!=g.hasis&&!1==a.hasis&&(g.hasis=!1),d.push(new h(g))}var i=new f({array:d});return[new f({array:[i]})]},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.SigningCertificateV2,c.asn1.cms.Attribute),c.asn1.cms.ESSCertIDv2=function(a){c.asn1.cms.ESSCertIDv2.superclass.constructor.call(this);var b=c.asn1,d=b.DEROctetString,e=b.DERSequence,f=b.cms.IssuerSerial,g=b.x509.AlgorithmIdentifier;this.params=null,this.tohex=function(){var a=this.params,b=this.getCertHash(a,"sha256"),c=[];return void 0!=a.alg&&"sha256"!=a.alg&&c.push(new g({name:a.alg})),c.push(new d({hex:b})),("string"==typeof a&&-1!=a.indexOf("-----BEGIN")||void 0!=a.cert&&!1!=a.hasis||void 0!=a.issuer&&void 0!=a.serial)&&c.push(new f(a)),new e({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.ESSCertIDv2,c.asn1.cms.ESSCertID),c.asn1.cms.IssuerSerial=function(a){var b=Error,d=c.asn1,e=d.DERInteger,f=d.DERSequence,g=d.cms,h=d.x509.GeneralNames;g.IssuerSerial.superclass.constructor.call(this),this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if("string"==typeof a&&-1!=a.indexOf("-----BEGIN")||void 0!=a.cert){var c,d,g=void 0!=a.cert?a.cert:a,i=new aD;i.readCertPEM(g),c=i.getIssuer(),d={hex:i.getSerialNumberHex()}}else if(void 0!=a.issuer&&a.serial)c=a.issuer,d=a.serial;else throw new b("cert or issuer and serial parameter not specified");return new f({array:[new h([{dn:c}]),new e(d)]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.IssuerSerial,c.asn1.ASN1Object),c.asn1.cms.SignerIdentifier=function(a){var b=c.asn1,d=(b.DERInteger,b.DERSequence,b.cms),e=d.IssuerAndSerialNumber,f=d.SubjectKeyIdentifier;b.x509.X500Name,d.SignerIdentifier.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if("isssn"==a.type)return new e(a).tohex();if("skid"==a.type)return new f(a).tohex();throw Error("wrong property for isssn or skid")},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.SignerIdentifier,c.asn1.ASN1Object),c.asn1.cms.IssuerAndSerialNumber=function(a){var b=c.asn1,d=b.DERInteger,e=b.DERSequence,f=b.cms,g=b.x509.X500Name,h=Error;f.IssuerAndSerialNumber.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if("string"==typeof a&&-1!=a.indexOf("-----BEGIN")||void 0!=a.cert){var b,c,f=void 0!=a.cert?a.cert:a,i=new aD;i.readCertPEM(f),b=i.getIssuer(),c={hex:i.getSerialNumberHex()}}else if(void 0!=a.issuer&&a.serial)b=a.issuer,c=a.serial;else throw new h("cert or issuer and serial parameter not specified");return new e({array:[new g(b),new d(c)]}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.IssuerAndSerialNumber,c.asn1.ASN1Object),c.asn1.cms.SubjectKeyIdentifier=function(a){var b=c.asn1,d=(b.DERInteger,b.DERSequence,b.ASN1Util.newObject),e=b.cms,f=((e.IssuerAndSerialName,e.SubjectKeyIdentifier,b.x509).X500Name,Error);e.SubjectKeyIdentifier.superclass.constructor.call(this),this.tohex=function(){var a,b=this.params;if(void 0==b.cert&&void 0==b.skid)throw new f("property cert nor skid undefined");return void 0!=b.cert?a=new aD(b.cert).getExtSubjectKeyIdentifier().kid.hex:void 0!=b.skid&&(a=b.skid),d({tag:{tage:"a0",obj:{octstr:{hex:a}}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.SubjectKeyIdentifier,c.asn1.ASN1Object),c.asn1.cms.AttributeList=function(a){var b=Error,d=c.asn1,e=d.DERSet,f=d.cms;f.AttributeList.superclass.constructor.call(this),this.params=null,this.hTLV=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if(null!=this.hTLV)return this.hTLV;var d=!0;void 0!=a.sortflag&&(d=a.sortflag);for(var g=a.array,h=[],i=0;i<g.length;i++){var j=g[i],k=j.attr;if("contentType"==k)h.push(new f.ContentType(j));else if("messageDigest"==k)h.push(new f.MessageDigest(j));else if("signingTime"==k)h.push(new f.SigningTime(j));else if("signingCertificate"==k)h.push(new f.SigningCertificate(j));else if("signingCertificateV2"==k)h.push(new f.SigningCertificateV2(j));else if("signaturePolicyIdentifier"==k)h.push(new c.asn1.cades.SignaturePolicyIdentifier(j));else if("signatureTimeStamp"==k||"timeStampToken"==k)h.push(new c.asn1.cades.SignatureTimeStamp(j));else throw new b("unknown attr: "+k)}var l=new e({array:h,sortflag:d});return this.hTLV=l.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.AttributeList,c.asn1.ASN1Object),c.asn1.cms.SignerInfo=function(a){var b=Error,d=c,e=d.asn1,f=e.DERInteger,g=e.DEROctetString,h=e.DERSequence,i=e.DERTaggedObject,j=e.cms,k=j.SignerIdentifier,l=j.AttributeList,m=(j.ContentType,j.EncapsulatedContentInfo,j.MessageDigest,j.SignedData,e.x509).AlgorithmIdentifier,n=d.crypto;j.SignerInfo.superclass.constructor.call(this),this.params=null,this.sign=function(){var a=this.params,b=a.sigalg,c=new l(a.sattrs).tohex(),d=az.getKey(a.signkey),e=new n.Signature({alg:b});e.init(d),e.updateHex(c),a.sighex=e.sign()},this.tohex=function(){var a=this.params,c=[];if(c.push(new f({int:a.version})),c.push(new k(a.id)),c.push(new m({name:a.hashalg})),void 0!=a.sattrs){var d=new l(a.sattrs);try{c.push(new i({tag:"a0",explicit:!1,obj:d}))}catch(a){throw new b("si sattr error: "+a)}}if(void 0!=a.sigalgfield?c.push(new m({name:a.sigalgfield})):c.push(new m({name:a.sigalg})),void 0==a.sighex&&void 0!=a.signkey&&this.sign(),c.push(new g({hex:a.sighex})),void 0!=a.uattrs){var d=new l(a.uattrs);try{c.push(new i({tag:"a1",explicit:!1,obj:d}))}catch(a){throw new b("si uattr error: "+a)}}return new h({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.SignerInfo,c.asn1.ASN1Object),c.asn1.cms.EncapsulatedContentInfo=function(a){var b=c.asn1,d=b.DERTaggedObject,e=b.DERSequence,f=b.DERObjectIdentifier,g=b.DEROctetString;b.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,b=[];if(b.push(new f(a.type)),void 0!=a.content&&(void 0!=a.content.hex||void 0!=a.content.str)&&!0!=a.isDetached){var c=new d({tag:"a0",explicit:!0,obj:new g(a.content)});b.push(c)}return new e({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.EncapsulatedContentInfo,c.asn1.ASN1Object),c.asn1.cms.ContentInfo=function(a){var b=c.asn1,d=b.DERTaggedObject,e=b.DERSequence,f=b.DERObjectIdentifier;b.x509.OID.name2obj,c.asn1.cms.ContentInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,b=[];b.push(new f(a.type));var c=new d({tag:"a0",explicit:!0,obj:a.obj});return b.push(c),new e({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.ContentInfo,c.asn1.ASN1Object),c.asn1.cms.SignedData=function(a){var b=c.asn1,d=(b.ASN1Object,b.DERInteger),e=b.DERSet,f=b.DERSequence,g=(b.DERTaggedObject,b.cms),h=g.EncapsulatedContentInfo,i=g.SignerInfo,j=g.ContentInfo,k=g.CertificateSet,l=g.RevocationInfoChoices,m=b.x509.AlgorithmIdentifier;c.asn1.cms.SignedData.superclass.constructor.call(this),this.params=null,this.checkAndFixParam=function(){var a=this.params;this._setDigestAlgs(a),this._setContentTypeByEContent(a),this._setMessageDigestByEContent(a),this._setSignerInfoVersion(a),this._setSignedDataVersion(a)},this._setDigestAlgs=function(a){for(var b={},c=a.sinfos,d=0;d<c.length;d++)b[c[d].hashalg]=1;a.hashalgs=Object.keys(b).sort()},this._setContentTypeByEContent=function(a){for(var b=a.econtent.type,c=a.sinfos,d=0;d<c.length;d++){var e=c[d];this._getAttrParamByName(e,"contentType").type=b}},this._setMessageDigestByEContent=function(a){var b=a.econtent;a.econtent.type;var d=b.content.hex;void 0==d&&"data"==b.type&&void 0!=b.content.str&&(d=ae(b.content.str));for(var e=a.sinfos,f=0;f<e.length;f++){var g=e[f],h=g.hashalg;this._getAttrParamByName(g,"messageDigest").hex=c.crypto.Util.hashHex(d,h)}},this._getAttrParamByName=function(a,b){for(var c=a.sattrs.array,d=0;d<c.length;d++)if(c[d].attr==b)return c[d]},this._setSignerInfoVersion=function(a){for(var b=a.sinfos,c=0;c<b.length;c++){var d=b[c],e=1;"skid"==d.id.type&&(e=3),d.version=e}},this._setSignedDataVersion=function(a){var b=this._getSignedDataVersion(a);a.version=b},this._getSignedDataVersion=function(a){if(void 0!=a.revinfos){for(var b=a.revinfos,c=0;c<b.length;c++)if(void 0!=b[c].ocsp)return 5}for(var d=a.sinfos,c=0;c<d.length;c++)if(3==a.sinfos[c].version)return 3;return"data"!=a.econtent.type?3:1},this.tohex=function(){var a=this.params;void 0!=this.getEncodedHexPrepare&&this.getEncodedHexPrepare(),!0!=a.fixed&&this.checkAndFixParam();var b=[];b.push(new d({int:a.version}));for(var c=[],g=0;g<a.hashalgs.length;g++){var j=a.hashalgs[g];c.push(new m({name:j}))}b.push(new e({array:c})),b.push(new h(a.econtent)),void 0!=a.certs&&b.push(new k(a.certs)),void 0!=a.revinfos&&b.push(new l(a.revinfos));for(var n=[],g=0;g<a.sinfos.length;g++){var o=a.sinfos[g];n.push(new i(o))}return b.push(new e({array:n})),new f({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.getContentInfo=function(){return new j({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.SignedData,c.asn1.ASN1Object),c.asn1.cms.CertificateSet=function(a){c.asn1.cms.CertificateSet.superclass.constructor.call(this);var b=Error,d=c.asn1,e=d.DERTaggedObject,f=d.DERSet,g=d.ASN1Object;this.params=null,this.tohex=function(){var a,c=this.params,d=[];if(c instanceof Array)a=c;else if(void 0!=c.array)a=c.array;else throw new b("cert array not specified");for(var h=0;h<a.length;h++){var i=ag(a[h]),j=new g;j.hTLV=i,d.push(j)}var k={array:d};return!1==c.sortflag&&(k.sortflag=!1),new e({tag:"a0",explicit:!1,obj:new f(k)}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.CertificateSet,c.asn1.ASN1Object),c.asn1.cms.RevocationInfoChoices=function(a){c.asn1.cms.RevocationInfoChoices.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if(!a instanceof Array)throw Error("params is not array");for(var b=[],d=0;d<a.length;d++)b.push(new c.asn1.cms.RevocationInfoChoice(a[d]));return c.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:{set:b}}}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.RevocationInfoChoices,c.asn1.ASN1Object),c.asn1.cms.RevocationInfoChoice=function(a){c.asn1.cms.RevocationInfoChoice.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if(void 0!=a.crl&&"string"==typeof a.crl){var b=a.crl;return -1!=a.crl.indexOf("-----BEGIN")&&(b=ag(a.crl)),b}if(void 0!=a.ocsp)return c.asn1.ASN1Util.newObject({tag:{tagi:"a1",obj:new c.asn1.cms.OtherRevocationFormat(a)}}).tohex();throw Error("property crl or ocsp undefined")},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.RevocationInfoChoice,c.asn1.ASN1Object),c.asn1.cms.OtherRevocationFormat=function(a){c.asn1.cms.OtherRevocationFormat.superclass.constructor.call(this);var b=Error,d=c,e=d.asn1.ASN1Util.newObject,f=d.lang.String.isHex;this.params=null,this.tohex=function(){var a=this.params;if(void 0==a.ocsp)throw new b("property ocsp not specified");if(!f(a.ocsp)||!W.isASN1HEX(a.ocsp))throw new b("ocsp value not ASN.1 hex string");return e({seq:[{oid:"1.3.6.1.5.5.7.16.2"},{asn1:{tlv:a.ocsp}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cms.OtherRevocationFormat,c.asn1.ASN1Object),c.asn1.cms.CMSUtil=new function(){},c.asn1.cms.CMSUtil.newSignedData=function(a){return new c.asn1.cms.SignedData(a)},c.asn1.cms.CMSUtil.verifySignedData=function(a){var b=c,d=b.asn1,e=d.cms,f=((e.SignerInfo,e.SignedData,e.SigningTime,e.SigningCertificate,e.SigningCertificateV2,d.cades).SignaturePolicyIdentifier,b.lang.String.isHex),g=W.getVbyList,h=W.getTLVbyList,i=W.getIdxbyList,j=W.getChildIdx,k=W.getTLV,l=W.oidname,m=b.crypto.Util.hashHex;void 0===a.cms&&f(a.cms);var n=a.cms,o=function(a,b){for(var c,d=3;d<6;d++)if(void 0!==(c=i(a,0,[1,0,d]))){var e=a.substr(c,2);"a0"===e&&(b.certsIdx=c),"a1"===e&&(b.revinfosIdx=c),"31"===e&&(b.signerinfosIdx=c)}},p=function(a,b){var c=b.signerinfosIdx;if(void 0!==c){var d=j(a,c);b.signerInfoIdxList=d;for(var e=0;e<d.length;e++){var f={idx:d[e]};q(a,f),b.signerInfos.push(f)}}},q=function(a,b){var c=b.idx;b.signerid_issuer1=h(a,c,[1,0],"30"),b.signerid_serial1=g(a,c,[1,1],"02"),b.hashalg=l(g(a,c,[2,0],"06"));var d=i(a,c,[3],"a0");b.idxSignedAttrs=d,r(a,b,d);var e=j(a,c).length;if(e<6)throw"malformed SignerInfo";b.sigalg=l(g(a,c,[e-2,0],"06")),b.sigval=g(a,c,[e-1],"04")},r=function(a,b,c){var d=j(a,c);b.signedAttrIdxList=d;for(var e=0;e<d.length;e++){var f=d[e],h=g(a,f,[0],"06");"2a864886f70d010905"===h?b.saSigningTime=ac(g(a,f,[1,0])):"2a864886f70d010904"===h&&(b.saMessageDigest=g(a,f,[1,0],"04"))}},s=function(a,b,c,d){var e,f=b.parse.certsIdx;if(void 0===b.certs){e=[],b.certkeys=[];for(var g=j(a,f),h=0;h<g.length;h++){var i=k(a,g[h]),l=new aD;l.readCertHex(i),e[h]=l,b.certkeys[h]=l.getPublicKey()}b.certs=e}else e=b.certs;b.cccc=e.length,b.cccci=g.length;for(var h=0;h<e.length;h++){var m=l.getIssuerHex(),n=l.getSerialNumberHex();c.signerid_issuer1===m&&c.signerid_serial1===n&&(c.certkey_idx=h)}},t=function(a,b,d,e){d.verifyDetail={};var f=d.verifyDetail,g=b.parse.econtent,h=d.hashalg,i=d.saMessageDigest;f.validMessageDigest=!1,m(g,h)===i&&(f.validMessageDigest=!0),s(a,b,d,e),f.validSignatureValue=!1;var j=d.sigalg,l="31"+k(a,d.idxSignedAttrs).substr(2);d.signedattrshex=l;var n=b.certs[d.certkey_idx].getPublicKey(),o=new c.crypto.Signature({alg:j});o.init(n),o.updateHex(l);var p=o.verify(d.sigval);f.validSignatureValue_isValid=p,!0===p&&(f.validSignatureValue=!0),d.isValid=!1,f.validMessageDigest&&f.validSignatureValue&&(d.isValid=!0)},u={isValid:!1,parse:{}};return!function(a,b){if("2a864886f70d010702"===g(a,0,[0],"06"))b.cmsType="signedData",b.econtent=g(a,0,[1,0,2,1,0]),o(a,b),b.signerInfos=[],p(a,b)}(n,u.parse),!function(a,b){for(var c=b.parse.signerInfos,d=c.length,e=!0,f=0;f<d;f++){var g=c[f];t(a,b,g,f),g.isValid||(e=!1)}b.isValid=e}(n,u),u},c.asn1.cms.CMSParser=function(){var a=Error,b=new aD,d=W.getV,e=W.getTLV,f=(W.getIdxbyList,W.getTLVbyList),g=W.getTLVbyListEx,h=W.getVbyList,i=W.getVbyListEx,j=W.getChildIdx;this.getCMSSignedData=function(a){var b=f(a,0,[1,0]);return this.getSignedData(b)},this.getSignedData=function(a){var b=j(a,0),c={};c.version=parseInt(d(a,b[0]),16);var f=e(a,b[1]);c.hashalgs=this.getHashAlgArray(f);var h=e(a,b[2]);c.econtent=this.getEContent(h);var i=g(a,0,["[0]"]);null!=i&&(c.certs=this.getCertificateSet(i)),g(a,0,["[1]"]);var k=g(a,0,[3]);return c.sinfos=this.getSignerInfos(k),c},this.getHashAlgArray=function(a){for(var b=j(a,0),c=new aD,d=[],f=0;f<b.length;f++){var g=e(a,b[f]),h=c.getAlgorithmIdentifierName(g);d.push(h)}return d},this.getEContent=function(a){var b={},d=h(a,0,[0]),e=h(a,0,[1,0]);return b.type=c.asn1.x509.OID.oid2name(W.hextooidstr(d)),b.content={hex:e},b},this.getSignerInfos=function(a){for(var b=[],c=j(a,0),d=0;d<c.length;d++){var f=e(a,c[d]),g=this.getSignerInfo(f);b.push(g)}return b},this.getSignerInfo=function(a){var c={},d=j(a,0),f=W.getInt(a,d[0],-1);-1!=f&&(c.version=f);var h=e(a,d[1]);c.id=this.getIssuerAndSerialNumber(h);var k=e(a,d[2]);c.hashalg=b.getAlgorithmIdentifierName(k);var l=g(a,0,["[0]"]);null!=l&&(c.sattrs=this.getAttributeList(l));var m=g(a,0,[3]);c.sigalg=b.getAlgorithmIdentifierName(m),c.sighex=i(a,0,[4]);var n=g(a,0,["[1]"]);return null!=n&&(c.uattrs=this.getAttributeList(n)),c},this.getSignerIdentifier=function(a){if("30"==a.substr(0,2))return this.getIssuerAndSerialNumber(a);throw Error("SKID of signerIdentifier not supported")},this.getIssuerAndSerialNumber=function(a){var c={type:"isssn"},f=j(a,0),g=e(a,f[0]);return c.issuer=b.getX500Name(g),c.serial={hex:d(a,f[1])},c},this.getAttributeList=function(a){for(var b=[],c=j(a,0),d=0;d<c.length;d++){var f=e(a,c[d]),g=this.getAttribute(f);b.push(g)}return{array:b}},this.getAttribute=function(a){var b={},d=j(a,0),f=W.getOID(a,d[0]),g=c.asn1.x509.OID.oid2name(f);b.attr=g;var h=e(a,d[1]),i=j(h,0);if(1==i.length)b.valhex=e(h,i[0]);else{for(var k=[],l=0;l<i.length;l++)k.push(e(h,i[l]));b.valhex=k}return"contentType"==g?this.setContentType(b):"messageDigest"==g?this.setMessageDigest(b):"signingTime"==g?this.setSigningTime(b):"signingCertificate"==g?this.setSigningCertificate(b):"signingCertificateV2"==g?this.setSigningCertificateV2(b):"signaturePolicyIdentifier"==g&&this.setSignaturePolicyIdentifier(b),b},this.setContentType=function(a){var b=W.getOIDName(a.valhex,0,null);null!=b&&(a.type=b,delete a.valhex)},this.setSigningTime=function(a){var b=ac(d(a.valhex,0));a.str=b,delete a.valhex},this.setMessageDigest=function(a){var b=d(a.valhex,0);a.hex=b,delete a.valhex},this.setSigningCertificate=function(a){var b=j(a.valhex,0);if(b.length>0){for(var c=e(a.valhex,b[0]),d=j(c,0),f=[],g=0;g<d.length;g++){var h=e(c,d[g]),i=this.getESSCertID(h);f.push(i)}a.array=f}if(b.length>1){var k=e(a.valhex,b[1]);a.polhex=k}delete a.valhex},this.setSignaturePolicyIdentifier=function(a){var b=j(a.valhex,0);if(b.length>0){var c=W.getOID(a.valhex,b[0]);a.oid=c}if(b.length>1){var f=new aD,g=j(a.valhex,b[1]),h=e(a.valhex,g[0]);a.alg=f.getAlgorithmIdentifierName(h);var i=d(a.valhex,g[1]);a.hash=i}delete a.valhex},this.setSigningCertificateV2=function(a){var b=j(a.valhex,0);if(b.length>0){for(var c=e(a.valhex,b[0]),d=j(c,0),f=[],g=0;g<d.length;g++){var h=e(c,d[g]),i=this.getESSCertIDv2(h);f.push(i)}a.array=f}if(b.length>1){var k=e(a.valhex,b[1]);a.polhex=k}delete a.valhex},this.getESSCertID=function(a){var b={},c=j(a,0);if(c.length>0&&(b.hash=d(a,c[0])),c.length>1){var f=e(a,c[1]),g=this.getIssuerSerial(f);void 0!=g.serial&&(b.serial=g.serial),void 0!=g.issuer&&(b.issuer=g.issuer)}return b},this.getESSCertIDv2=function(c){var f={},g=j(c,0);if(g.length<1||3<g.length)throw new a("wrong number of elements");var h=0;if("30"==c.substr(g[0],2)){var i=e(c,g[0]);f.alg=b.getAlgorithmIdentifierName(i),h++}else f.alg="sha256";if(f.hash=d(c,g[h]),g.length>h+1){var k=e(c,g[h+1]),l=this.getIssuerSerial(k);f.issuer=l.issuer,f.serial=l.serial}return f},this.getIssuerSerial=function(a){var c={},f=j(a,0),g=e(a,f[0]);return c.issuer=b.getGeneralNames(g)[0].dn,c.serial={hex:d(a,f[1])},c},this.getCertificateSet=function(a){for(var b=j(a,0),c=[],d=0;d<b.length;d++){var f=e(a,b[d]);if("30"==f.substr(0,2)){var g=af(f,"CERTIFICATE");c.push(g)}}return{array:c,sortflag:!1}}},void 0!==c&&c||(c={}),void 0!==c.asn1&&c.asn1||(c.asn1={}),void 0!==c.asn1.tsp&&c.asn1.tsp||(c.asn1.tsp={}),c.asn1.tsp.TimeStampToken=function(a){var b=c.asn1.tsp;b.TimeStampToken.superclass.constructor.call(this),this.params=null,this.getEncodedHexPrepare=function(){var a=new b.TSTInfo(this.params.econtent.content);this.params.econtent.content.hex=a.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.tsp.TimeStampToken,c.asn1.cms.SignedData),c.asn1.tsp.TSTInfo=function(a){var b=c.asn1,d=b.DERSequence,e=b.DERInteger,f=b.DERBoolean,g=b.DERGeneralizedTime,h=b.DERObjectIdentifier,i=b.DERTaggedObject,j=b.tsp,k=j.MessageImprint,l=j.Accuracy,m=(b.x509.X500Name,b.x509.GeneralName);if(j.TSTInfo.superclass.constructor.call(this),this.dVersion=new e({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerial=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.tohex=function(){var a=[this.dVersion];if(null==this.dPolicy)throw Error("policy shall be specified.");if(a.push(this.dPolicy),null==this.dMessageImprint)throw Error("messageImprint shall be specified.");if(a.push(this.dMessageImprint),null==this.dSerial)throw Error("serialNumber shall be specified.");if(a.push(this.dSerial),null==this.dGenTime)throw Error("genTime shall be specified.");a.push(this.dGenTime),null!=this.dAccuracy&&a.push(this.dAccuracy),null!=this.dOrdering&&a.push(this.dOrdering),null!=this.dNonce&&a.push(this.dNonce),null!=this.dTsa&&a.push(this.dTsa);var b=new d({array:a});return this.hTLV=b.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a){if("string"==typeof a.policy){if(!a.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new h({oid:a.policy})}void 0!==a.messageImprint&&(this.dMessageImprint=new k(a.messageImprint)),void 0!==a.serial&&(this.dSerial=new e(a.serial)),void 0!==a.genTime&&(this.dGenTime=new g(a.genTime)),void 0!==a.accuracy&&(this.dAccuracy=new l(a.accuracy)),void 0!==a.ordering&&!0==a.ordering&&(this.dOrdering=new f),void 0!==a.nonce&&(this.dNonce=new e(a.nonce)),void 0!==a.tsa&&(this.dTsa=new i({tag:"a0",explicit:!0,obj:new m({dn:a.tsa})}))}},ay(c.asn1.tsp.TSTInfo,c.asn1.ASN1Object),c.asn1.tsp.Accuracy=function(a){var b=c.asn1,d=b.ASN1Util.newObject;b.tsp.Accuracy.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,b=[];return void 0!=a.seconds&&"number"==typeof a.seconds&&b.push({int:a.seconds}),void 0!=a.millis&&"number"==typeof a.millis&&b.push({tag:{tagi:"80",obj:{int:a.millis}}}),void 0!=a.micros&&"number"==typeof a.micros&&b.push({tag:{tagi:"81",obj:{int:a.micros}}}),d({seq:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.tsp.Accuracy,c.asn1.ASN1Object),c.asn1.tsp.MessageImprint=function(a){var b=c.asn1,d=b.DERSequence,e=b.DEROctetString,f=b.x509.AlgorithmIdentifier;b.tsp.MessageImprint.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;return new d({array:[new f({name:a.alg}),new e({hex:a.hash})]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.tsp.MessageImprint,c.asn1.ASN1Object),c.asn1.tsp.TimeStampReq=function(a){var b=c.asn1,d=b.DERSequence,e=b.DERInteger,f=b.DERBoolean,g=(b.ASN1Object,b.DERObjectIdentifier),h=b.tsp,i=h.MessageImprint;h.TimeStampReq.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,b=[];return b.push(new e({int:1})),a.messageImprint instanceof c.asn1.ASN1Object?b.push(a.messageImprint):b.push(new i(a.messageImprint)),void 0!=a.policy&&b.push(new g(a.policy)),void 0!=a.nonce&&b.push(new e(a.nonce)),!0==a.certreq&&b.push(new f),new d({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.tsp.TimeStampReq,c.asn1.ASN1Object),c.asn1.tsp.TimeStampResp=function(a){var b=c.asn1,d=b.DERSequence,e=(b.ASN1Object,b.tsp),f=e.PKIStatusInfo;e.TimeStampResp.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,c=[];if(void 0!=a.econtent||void 0!=a.tst)if(void 0!=a.statusinfo?c.push(new f(a.statusinfo)):c.push(new f("granted")),void 0!=a.econtent)c.push(new e.TimeStampToken(a).getContentInfo());else if(a.tst instanceof b.ASN1Object)c.push(a.tst);else throw Error("improper member tst value");else if(void 0!=a.statusinfo)c.push(new f(a.statusinfo));else throw Error("parameter for token nor statusinfo not specified");return new d({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.tsp.TimeStampResp,c.asn1.ASN1Object),c.asn1.tsp.PKIStatusInfo=function(a){var b=Error,d=c.asn1,e=d.DERSequence,f=d.tsp,g=f.PKIStatus,h=f.PKIFreeText,i=f.PKIFailureInfo;f.PKIStatusInfo.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,c=[];if("string"==typeof a)c.push(new g(a));else{if(void 0==a.status)throw new b("property 'status' unspecified");c.push(new g(a.status)),void 0!=a.statusstr&&c.push(new h(a.statusstr)),void 0!=a.failinfo&&c.push(new i(a.failinfo))}return new e({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.tsp.PKIStatusInfo,c.asn1.ASN1Object),c.asn1.tsp.PKIStatus=function(a){var b=Error,d=c.asn1,e=d.DERInteger;d.tsp.PKIStatus.superclass.constructor.call(this);var f={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};this.params=null,this.tohex=function(){var a,c=this.params;if("string"==typeof c)try{a=f[c]}catch(a){throw new b("undefined name: "+c)}else if("number"==typeof c)a=c;else throw new b("unsupported params");return new e({int:a}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.tsp.PKIStatus,c.asn1.ASN1Object),c.asn1.tsp.PKIFreeText=function(a){var b=Error,d=c.asn1,e=d.DERSequence,f=d.DERUTF8String;d.tsp.PKIFreeText.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if(!a instanceof Array)throw new b("wrong params: not array");for(var c=[],d=0;d<a.length;d++)c.push(new f({str:a[d]}));return new e({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.tsp.PKIFreeText,c.asn1.ASN1Object),c.asn1.tsp.PKIFailureInfo=function(a){var b=Error,d=c.asn1,e=d.DERBitString,f=d.tsp.PKIFailureInfo,g={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};f.superclass.constructor.call(this),this.params=null,this.getBinValue=function(){var a=this.params,c=0;if("number"==typeof a&&0<=a&&a<=25){for(var d=(c|=1<<a).toString(2),e="",f=d.length-1;f>=0;f--)e+=d[f];return e}if("string"==typeof a&&void 0!=g[a])return aw([a],g);if("object"==typeof a&&void 0!=a.length)return aw(a,g);throw new b("wrong params")},this.tohex=function(){return this.params,new e({bin:this.getBinValue()}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.tsp.PKIFailureInfo,c.asn1.ASN1Object),c.asn1.tsp.AbstractTSAAdapter=function(a){this.getTSTHex=function(a,b){throw"not implemented yet"}},c.asn1.tsp.SimpleTSAAdapter=function(a){var b=c,d=b.asn1.tsp,e=b.crypto.Util.hashHex;d.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(a,b){var c=e(a,b);this.params.econtent.content.messageImprint={alg:b,hash:c},this.params.econtent.content.serial={int:this.serial++};var f=Math.floor(1e9*Math.random());return this.params.econtent.content.nonce={int:f},new d.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==a&&(this.params=a)},ay(c.asn1.tsp.SimpleTSAAdapter,c.asn1.tsp.AbstractTSAAdapter),c.asn1.tsp.FixedTSAAdapter=function(a){var b=c,d=b.asn1.tsp,e=b.crypto.Util.hashHex;d.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(a,b){var c=e(a,b);return this.params.econtent.content.messageImprint={alg:b,hash:c},new d.TimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==a&&(this.params=a)},ay(c.asn1.tsp.FixedTSAAdapter,c.asn1.tsp.AbstractTSAAdapter),c.asn1.tsp.TSPUtil=new function(){},c.asn1.tsp.TSPUtil.newTimeStampToken=function(a){return new c.asn1.tsp.TimeStampToken(a)},c.asn1.tsp.TSPUtil.parseTimeStampReq=function(a){return new c.asn1.tsp.TSPParser().getTimeStampReq(a)},c.asn1.tsp.TSPUtil.parseMessageImprint=function(a){return new c.asn1.tsp.TSPParser().getMessageImprint(a)},c.asn1.tsp.TSPParser=function(){var a=new aD,b=W.getV,d=W.getTLV,e=W.getIdxbyList,f=(W.getTLVbyListEx,W.getChildIdx),g=["granted","grantedWithMods","rejection","waiting","revocationWarning","revocationNotification"],h={0:"badAlg",2:"badRequest",5:"badDataFormat",14:"timeNotAvailable",15:"unacceptedPolicy",16:"unacceptedExtension",17:"addInfoNotAvailable",25:"systemFailure"};this.getResponse=function(a){var b=f(a,0);if(1==b.length)return this.getPKIStatusInfo(d(a,b[0]));if(b.length>1){var c=this.getPKIStatusInfo(d(a,b[0])),e=d(a,b[1]),g=this.getToken(e);return g.statusinfo=c,g}},this.getToken=function(a){var b=(new c.asn1.cms.CMSParser).getCMSSignedData(a);return this.setTSTInfo(b),b},this.setTSTInfo=function(a){var b=a.econtent;if("tstinfo"==b.type){var c=b.content.hex;b.content=this.getTSTInfo(c)}},this.getTSTInfo=function(c){var e={},g=f(c,0);e.policy=at(b(c,g[1]));var h=d(c,g[2]);e.messageImprint=this.getMessageImprint(h),e.serial={hex:b(c,g[3])},e.genTime={str:ac(b(c,g[4]))};var i=0;if(g.length>5&&"30"==c.substr(g[5],2)){var j=d(c,g[5]);e.accuracy=this.getAccuracy(j),i++}if(g.length>5+i&&"01"==c.substr(g[5+i],2)&&("ff"==b(c,g[5+i])&&(e.ordering=!0),i++),g.length>5+i&&"02"==c.substr(g[5+i],2)&&(e.nonce={hex:b(c,g[5+i])},i++),g.length>5+i&&"a0"==c.substr(g[5+i],2)){var k=d(c,g[5+i]);k="30"+k.substr(2),e.tsa=(pGeneralNames=a.getGeneralNames(k))[0].dn,i++}if(g.length>5+i&&"a1"==c.substr(g[5+i],2)){var l=d(c,g[5+i]);l="30"+l.substr(2),e.ext=a.getExtParamArray(l),i++}return e},this.getAccuracy=function(a){for(var c={},d=f(a,0),e=0;e<d.length;e++){var g=a.substr(d[e],2),h=parseInt(b(a,d[e]),16);"02"==g?c.seconds=h:"80"==g?c.millis=h:"81"==g&&(c.micros=h)}return c},this.getMessageImprint=function(a){if("30"!=a.substr(0,2))throw Error("head of messageImprint hex shall be x30");var d={};f(a,0);var g=e(a,0,[0,0]),h=b(a,g),i=W.hextooidstr(h),j=c.asn1.x509.OID.oid2name(i);if(""==j)throw Error("hashAlg name undefined: "+i);var k=e(a,0,[1]);return d.alg=j,d.hash=b(a,k),d},this.getPKIStatusInfo=function(a){var c={},e=f(a,0),h=0;try{var i=b(a,e[0]);c.status=g[parseInt(i,16)]}catch(a){}if(e.length>1&&"30"==a.substr(e[1],2)){var j=d(a,e[1]);c.statusstr=this.getPKIFreeText(j),h++}if(e.length>h&&"03"==a.substr(e[1+h],2)){var k=d(a,e[1+h]);c.failinfo=this.getPKIFailureInfo(k)}return c},this.getPKIFreeText=function(a){for(var b=[],c=f(a,0),d=0;d<c.length;d++)b.push(W.getString(a,c[d]));return b},this.getPKIFailureInfo=function(a){var b=W.getInt(a,0);return void 0!=h[b]?h[b]:b},this.getTimeStampReq=function(a){var e={};e.certreq=!1;var g=f(a,0);if(g.length<2)throw Error("TimeStampReq must have at least 2 items");var h=d(a,g[1]);e.messageImprint=c.asn1.tsp.TSPUtil.parseMessageImprint(h);for(var i=2;i<g.length;i++){var j=g[i],k=a.substr(j,2);if("06"==k){var l=b(a,j);e.policy=W.hextooidstr(l)}"02"==k&&(e.nonce=b(a,j)),"01"==k&&(e.certreq=!0)}return e}},void 0!==c&&c||(c={}),void 0!==c.asn1&&c.asn1||(c.asn1={}),void 0!==c.asn1.cades&&c.asn1.cades||(c.asn1.cades={}),c.asn1.cades.SignaturePolicyIdentifier=function(a){var b=c.asn1.cades,d=b.SignaturePolicyId;b.SignaturePolicyIdentifier.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.15",this.params=null,this.getValueArray=function(){return[new d(this.params)]},this.setByParam=function(a){this.params=a},void 0!=a&&this.setByParam(a)},ay(c.asn1.cades.SignaturePolicyIdentifier,c.asn1.cms.Attribute),c.asn1.cades.SignaturePolicyId=function(a){var b=c.asn1,d=b.DERSequence,e=b.DERObjectIdentifier,f=(b.x509.AlgorithmIdentifier,b.cades),g=f.SignaturePolicyId,h=f.OtherHashAlgAndValue;g.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,b=[];return b.push(new e(a.oid)),b.push(new h(a)),new d({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!=a&&this.setByParam(a)},ay(c.asn1.cades.SignaturePolicyId,c.asn1.ASN1Object),c.asn1.cades.OtherHashAlgAndValue=function(a){var b=Error,d=c.asn1,e=d.DERSequence,f=d.DEROctetString,g=d.x509.AlgorithmIdentifier;d.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if(void 0==a.alg)throw new b("property 'alg' not specified");if(void 0==a.hash&&void 0==a.cert)throw new b("property 'hash' nor 'cert' not specified");var d=null;if(void 0!=a.hash)d=a.hash;else if(void 0!=a.cert){if("string"!=typeof a.cert)throw new b("cert not string");var h=a.cert;-1!=a.cert.indexOf("-----BEGIN")&&(h=ag(a.cert)),d=c.crypto.Util.hashHex(h,a.alg)}var i=[];return i.push(new g({name:a.alg})),i.push(new f({hex:d})),new e({array:i}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cades.OtherHashAlgAndValue,c.asn1.ASN1Object),c.asn1.cades.OtherHashValue=function(a){c.asn1.cades.OtherHashValue.superclass.constructor.call(this);var b=Error,d=c,e=(d.lang.String.isHex,d.asn1).DEROctetString;d.crypto.Util.hashHex,this.params=null,this.tohex=function(){var a=this.params;if(void 0==a.hash&&void 0==a.cert)throw new b("hash or cert not specified");var d=null;if(void 0!=a.hash)d=a.hash;else if(void 0!=a.cert){if("string"!=typeof a.cert)throw new b("cert not string");var f=a.cert;-1!=a.cert.indexOf("-----BEGIN")&&(f=ag(a.cert)),d=c.crypto.Util.hashHex(f,"sha1")}return new e({hex:d}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cades.OtherHashValue,c.asn1.ASN1Object),c.asn1.cades.SignatureTimeStamp=function(a){var b=Error,d=c,e=d.lang.String.isHex,f=d.asn1,g=f.ASN1Object;(f.x509,f.cades).SignatureTimeStamp.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.14",this.params=null,this.getValueArray=function(){var a=this.params;if(void 0!=a.tst)if(e(a.tst)){var c=new g;return c.hTLV=a.tst,[c]}else if(a.tst instanceof g)return[a.tst];else throw new b("params.tst has wrong value");if(void 0!=a.res){var d=a.res;if(d instanceof g&&(d=d.tohex()),"string"!=typeof d||!e(d))throw new b("params.res has wrong value");W.getTLVbyList(d,0,[1]);var c=new g;return c.hTLV=a.tst,[c]}},null!=a&&this.setByParam(a)},ay(c.asn1.cades.SignatureTimeStamp,c.asn1.cms.Attribute),c.asn1.cades.CompleteCertificateRefs=function(a){var b=Error,d=c,e=d.asn1,f=e.DERSequence,g=e.cades,h=g.OtherCertID,i=d.lang.String.isHex;g.CompleteCertificateRefs.superclass.constructor.call(this),this.typeOid="1.2.840.113549.1.9.16.2.21",this.params=null,this.getValueArray=function(){for(var a=this.params,c=[],d=0;d<a.array.length;d++){var e=a.array[d];if("string"==typeof e)if(-1!=e.indexOf("-----BEGIN"))e={cert:e};else if(i(e))e={hash:e};else throw new b("unsupported value: "+e);void 0!=a.alg&&void 0==e.alg&&(e.alg=a.alg),void 0!=a.hasis&&void 0==e.hasis&&(e.hasis=a.hasis);var g=new h(e);c.push(g)}return[new f({array:c})]},void 0!=a&&this.setByParam(a)},ay(c.asn1.cades.CompleteCertificateRefs,c.asn1.cms.Attribute),c.asn1.cades.OtherCertID=function(a){var b=c.asn1,d=b.DERSequence,e=b.cms.IssuerSerial,f=b.cades,g=f.OtherHashValue,h=f.OtherHashAlgAndValue;f.OtherCertID.superclass.constructor.call(this),this.params=a,this.tohex=function(){var a=this.params;"string"==typeof a&&(-1!=a.indexOf("-----BEGIN")?a={cert:a}:_isHex(a)&&(a={hash:a}));var b=[],c=null;if(c=void 0!=a.alg?new h(a):new g(a),b.push(c),void 0!=a.cert&&!0==a.hasis||void 0!=a.issuer&&void 0!=a.serial){var f=new e(a);b.push(f)}return new d({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cades.OtherCertID,c.asn1.ASN1Object),c.asn1.cades.OtherHash=function(a){var b=c,d=b.asn1,e=(d.cms,d.cades),f=e.OtherHashAlgAndValue,g=e.OtherHashValue,h=(b.crypto.Util.hashHex,b.lang.String.isHex);e.OtherHash.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;"string"==typeof a&&(-1!=a.indexOf("-----BEGIN")?a={cert:a}:h(a)&&(a={hash:a}));return(void 0!=a.alg?new f(a):new g(a)).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.cades.OtherHash,c.asn1.ASN1Object),c.asn1.cades.CAdESUtil=new function(){},c.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(a){return new c.asn1.cms.CMSParser().getCMSSignedData(a)},c.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(a,b,d){var e=W.getChildIdx,f=W.getTLV,g=W.getV,h=c.asn1,i=h.ASN1Object,j=h.cms,k=j.AttributeList,l=j.SignerInfo,m={},n=e(a,b);if(6!=n.length)throw"not supported items for SignerInfo (!=6)";m.version=f(a,n.shift()),m.si=f(a,n.shift()),m.digalg=f(a,n.shift()),m.sattrs=f(a,n.shift()),m.sigalg=f(a,n.shift());var o=n.shift();m.sig=f(a,o),m.sigval=g(a,o);var p=null;return m.obj=new l,(p=new i).hTLV=m.version,m.obj.dCMSVersion=p,(p=new i).hTLV=m.si,m.obj.dSignerIdentifier=p,(p=new i).hTLV=m.digalg,m.obj.dDigestAlgorithm=p,(p=new i).hTLV=m.sattrs,m.obj.dSignedAttrs=p,(p=new i).hTLV=m.sigalg,m.obj.dSigAlg=p,(p=new i).hTLV=m.sig,m.obj.dSig=p,m.obj.dUnsignedAttrs=new k,m},void 0!==c.asn1.csr&&c.asn1.csr||(c.asn1.csr={}),c.asn1.csr.CertificationRequest=function(a){var b=c.asn1,d=b.DERBitString,e=b.DERSequence,f=b.csr,g=(b.x509,f.CertificationRequestInfo);f.CertificationRequest.superclass.constructor.call(this),this.setByParam=function(a){this.params=a},this.sign=function(){var a=new g(this.params).tohex(),b=new c.crypto.Signature({alg:this.params.sigalg});b.init(this.params.sbjprvkey),b.updateHex(a);var d=b.sign();this.params.sighex=d},this.getPEM=function(){return af(this.tohex(),"CERTIFICATE REQUEST")},this.tohex=function(){var a=this.params,b=new c.asn1.csr.CertificationRequestInfo(this.params),f=new c.asn1.x509.AlgorithmIdentifier({name:a.sigalg});if(void 0==a.sighex&&void 0!=a.sbjprvkey&&this.sign(),void 0==a.sighex)throw Error("sighex or sbjprvkey parameter not defined");return new e({array:[b,f,new d({hex:"00"+a.sighex})]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.csr.CertificationRequest,c.asn1.ASN1Object),c.asn1.csr.CertificationRequestInfo=function(a){var b=c.asn1,d=(b.DERBitString,b.DERSequence),e=b.DERInteger,f=b.DERUTF8String,g=b.DERTaggedObject,h=b.ASN1Util.newObject,i=b.csr,j=b.x509,k=j.X500Name,l=j.Extensions,m=j.SubjectPublicKeyInfo;i.AttributeList,i.CertificationRequestInfo.superclass.constructor.call(this),this.params=null,this.setByParam=function(a){void 0!=a&&(this.params=a)},this.tohex=function(){var a=this.params,b=[];if(b.push(new e({int:0})),b.push(new k(a.subject)),b.push(new m(az.getKey(a.sbjpubkey))),void 0!=a.attrs){var i=h({tag:{tage:"a0",obj:function(a){for(var b=Error,d=c.asn1.x509.Extensions,e=[],f=0;f<a.length;f++){var g=a[f],h=g.attr;if("extensionRequest"==h){var i={seq:[{oid:"1.2.840.113549.1.9.14"},{set:[new d(g.ext)]}]};e.push(i)}else if("unstructuredName"==h){var i={seq:[{oid:"1.2.840.113549.1.9.2"},{set:g.names}]};e.push(i)}else if("challengePassword"==h){var i={seq:[{oid:"1.2.840.113549.1.9.7"},{set:[{utf8str:g.password}]}]};e.push(i)}else throw new b("unknown CSR attribute")}return{set:e}}(a.attrs)}});b.push(i)}else if(void 0!=a.extreq){var i=h({tag:{tage:"a0",obj:{seq:[{oid:"1.2.840.113549.1.9.14"},{set:[new l(a.extreq)]}]}}});b.push(i)}else b.push(new g({tag:"a0",explicit:!1,obj:new f({str:""})}));return new d({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!=a&&this.setByParam(a)},ay(c.asn1.csr.CertificationRequestInfo,c.asn1.ASN1Object),c.asn1.csr.AttributeList=function(a){},ay(c.asn1.csr.AttributeList,c.asn1.ASN1Object),c.asn1.csr.CSRUtil=new function(){},c.asn1.csr.CSRUtil.newCSRPEM=function(a){return new c.asn1.csr.CertificationRequest(a).getPEM()},c.asn1.csr.CSRUtil.getParam=function(a,b){var c,d=W.getV,e=W.getIdxbyList,f=W.getTLVbyList,g=W.getTLVbyListEx,h=W.getVbyListEx,i={};if(-1==a.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw Error("argument is not PEM file");var j=ag(a,"CERTIFICATE REQUEST");b&&(i.tbs=f(j,0,[0]));try{var k=g(j,0,[0,1]);if("3000"==k)i.subject={};else{var l=new aD;i.subject=l.getX500Name(k)}}catch(a){}var m=g(j,0,[0,2]),n=az.getKey(m,null,"pkcs8pub");i.sbjpubkey=az.getPEM(n,"PKCS8PUB");var o=(c=e(j,0,[0,3,0,0],"06"),"2a864886f70d01090e"!=d(j,c)?null:f(j,0,[0,3,0,1,0],"30")),l=new aD;null!=o&&(i.extreq=l.getExtParamArray(o));try{var p=g(j,0,[1],"30"),l=new aD;i.sigalg=l.getAlgorithmIdentifierName(p)}catch(a){}try{i.sighex=h(j,0,[2])}catch(a){}return i},c.asn1.csr.CSRUtil.verifySignature=function(a){try{var b=null;if("string"==typeof a&&-1!=a.indexOf("-----BEGIN CERTIFICATE REQUEST")?b=c.asn1.csr.CSRUtil.getParam(a,!0):"object"==typeof a&&void 0!=a.sbjpubkey&&void 0!=a.sigalg&&void 0!=a.sighex&&void 0!=a.tbs&&(b=a),null==b)return!1;var d=new c.crypto.Signature({alg:b.sigalg});return d.init(b.sbjpubkey),d.updateHex(b.tbs),d.verify(b.sighex)}catch(a){return alert(a),!1}},void 0!==c&&c||(c={}),void 0!==c.asn1&&c.asn1||(c.asn1={}),void 0!==c.asn1.ocsp&&c.asn1.ocsp||(c.asn1.ocsp={}),c.asn1.ocsp.DEFAULT_HASH="sha1",c.asn1.ocsp.OCSPResponse=function(a){c.asn1.ocsp.OCSPResponse.superclass.constructor.call(this),c.asn1.DEREnumerated;var b=c.asn1.ASN1Util.newObject,d=c.asn1.ocsp.ResponseBytes,e=["successful","malformedRequest","internalError","tryLater","_not_used_","sigRequired","unauthorized"];this.params=null,this._getStatusCode=function(){var a=this.params.resstatus;return"number"==typeof a?a:"string"!=typeof a?-1:e.indexOf(a)},this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params,c=this._getStatusCode();if(-1==c)throw Error("responseStatus not supported: "+a.resstatus);return 0!=c?b({seq:[{enum:{int:c}}]}).tohex():b({seq:[{enum:{int:0}},{tag:{tag:"a0",explicit:!0,obj:new d(a)}}]}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.ocsp.OCSPResponse,c.asn1.ASN1Object),c.asn1.ocsp.ResponseBytes=function(a){c.asn1.ocsp.ResponseBytes.superclass.constructor.call(this);var b=c.asn1,d=b.DERSequence,e=b.DERObjectIdentifier,f=b.DEROctetString,g=b.ocsp.BasicOCSPResponse;this.params=null,this.setByParam=function(a){this.params=a},this.tohex=function(){var a=this.params;if("ocspBasic"!=a.restype)throw Error("not supported responseType: "+a.restype);var b=new g(a),c=[];return c.push(new e({name:"ocspBasic"})),c.push(new f({hex:b.tohex()})),new d({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.ocsp.ResponseBytes,c.asn1.ASN1Object),c.asn1.ocsp.BasicOCSPResponse=function(a){c.asn1.ocsp.BasicOCSPResponse.superclass.constructor.call(this);var b=Error,d=c.asn1,e=d.ASN1Object,f=d.DERSequence,g=(d.DERGeneralizedTime,d.DERTaggedObject),h=d.DERBitString,i=(d.x509.Extensions,d.x509.AlgorithmIdentifier),j=d.ocsp;j.ResponderID,_SingleResponseList=j.SingleResponseList,_ResponseData=j.ResponseData,this.params=null,this.setByParam=function(a){this.params=a},this.sign=function(){var a=this.params,b=a.tbsresp.tohex(),d=new c.crypto.Signature({alg:a.sigalg});d.init(a.reskey),d.updateHex(b),a.sighex=d.sign()},this.tohex=function(){var a=this.params;void 0==a.tbsresp&&(a.tbsresp=new _ResponseData(a)),void 0==a.sighex&&void 0!=a.reskey&&this.sign();var c=[];if(c.push(a.tbsresp),c.push(new i({name:a.sigalg})),c.push(new h({hex:"00"+a.sighex})),void 0!=a.certs&&void 0!=a.certs.length){for(var d=[],j=0;j<a.certs.length;j++){var k=a.certs[j],l=null;if(W.isASN1HEX(k))l=k;else if(k.match(/-----BEGIN/))l=ag(k);else throw new b("certs["+j+"] not hex or PEM");d.push(new e({tlv:l}))}var m=new f({array:d});c.push(new g({tag:"a0",explicit:!0,obj:m}))}return new f({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.ocsp.BasicOCSPResponse,c.asn1.ASN1Object),c.asn1.ocsp.ResponseData=function(a){c.asn1.ocsp.ResponseData.superclass.constructor.call(this);var b=Error,d=c.asn1,e=d.DERSequence,f=d.DERGeneralizedTime,g=d.DERTaggedObject,h=d.x509.Extensions,i=d.ocsp,j=i.ResponderID;_SingleResponseList=i.SingleResponseList,this.params=null,this.tohex=function(){var a=this.params;void 0!=a.respid&&new b("respid not specified"),void 0!=a.prodat&&new b("prodat not specified"),void 0!=a.array&&new b("array not specified");var c=[];if(c.push(new j(a.respid)),c.push(new f(a.prodat)),c.push(new _SingleResponseList(a.array)),void 0!=a.ext){var d=new h(a.ext);c.push(new g({tag:"a1",explicit:!0,obj:d}))}return new e({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},ay(c.asn1.ocsp.ResponseData,c.asn1.ASN1Object),c.asn1.ocsp.ResponderID=function(a){c.asn1.ocsp.ResponderID.superclass.constructor.call(this);var b=c,d=b.asn1,e=d.ASN1Util.newObject,f=d.x509.X500Name,g=b.lang.String.isHex,h=Error;this.params=null,this.tohex=function(){var a=this.params;if(void 0!=a.key){var b=null;if("string"==typeof a.key){if(g(a.key)&&(b=a.key),a.key.match(/-----BEGIN CERTIFICATE/)){var c=new aD(a.key),d=c.getExtSubjectKeyIdentifier();null!=d&&(b=d.kid.hex)}}else if(a.key instanceof aD){var d=a.key.getExtSubjectKeyIdentifier();null!=d&&(b=d.kid.hex)}if(null==b)throw new h("wrong key member value");var i=e({tag:{tag:"a2",explicit:!0,obj:{octstr:{hex:b}}}});return i.tohex()}if(void 0!=a.name){var j=null;if("string"==typeof a.name&&a.name.match(/-----BEGIN CERTIFICATE/)){var c=new aD(a.name);j=c.getSubject()}else a.name instanceof aD?j=a.name.getSubject():"object"==typeof a.name&&(void 0!=a.name.array||void 0!=a.name.str)&&(j=a.name);if(null==j)throw new h("wrong name member value");var i=e({tag:{tag:"a1",explicit:!0,obj:new f(j)}});return i.tohex()}throw new h("key or name not specified")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},ay(c.asn1.ocsp.ResponderID,c.asn1.ASN1Object),c.asn1.ocsp.SingleResponseList=function(a){c.asn1.ocsp.SingleResponseList.superclass.constructor.call(this);var b=c.asn1,d=b.DERSequence,e=b.ocsp.SingleResponse;this.params=null,this.tohex=function(){var a=this.params;if("object"!=typeof a||void 0==a.length)throw Error("params not specified properly");for(var b=[],c=0;c<a.length;c++)b.push(new e(a[c]));return new d({array:b}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},ay(c.asn1.ocsp.SingleResponseList,c.asn1.ASN1Object),c.asn1.ocsp.SingleResponse=function(a){var b=Error,d=c.asn1,e=d.DERSequence,f=d.DERGeneralizedTime,g=d.DERTaggedObject,h=d.ocsp,i=h.CertID,j=h.CertStatus,k=d.x509.Extensions;h.SingleResponse.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params,c=[];if(void 0==a.certid)throw new b("certid unspecified");if(void 0==a.status)throw new b("status unspecified");if(void 0==a.thisupdate)throw new b("thisupdate unspecified");if(c.push(new i(a.certid)),c.push(new j(a.status)),c.push(new f(a.thisupdate)),void 0!=a.nextupdate){var d=new f(a.nextupdate);c.push(new g({tag:"a0",explicit:!0,obj:d}))}if(void 0!=a.ext){var h=new k(a.ext);c.push(new g({tag:"a1",explicit:!0,obj:h}))}return new e({array:c}).tohex()},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},ay(c.asn1.ocsp.SingleResponse,c.asn1.ASN1Object),c.asn1.ocsp.CertID=function(a){var b=c,d=b.asn1,e=d.DEROctetString,f=d.DERInteger,g=d.DERSequence,h=d.x509.AlgorithmIdentifier,i=d.ocsp,j=(i.DEFAULT_HASH,b.crypto).Util.hashHex,k=W.getVbyList;i.CertID.superclass.constructor.call(this),this.DEFAULT_HASH="sha1",this.params=null,this.setByValue=function(a,b,c,d){void 0==d&&(d=this.DEFAULT_HASH),this.params={alg:d,issname:a,isskey:b,sbjsn:c}},this.setByCert=function(a,b,c){void 0==c&&(c=this.DEFAULT_HASH),this.params={alg:c,issuerCert:a,subjectCert:b}},this.getParamByCerts=function(a,b,c){void 0==c&&(c=this.DEFAULT_HASH);var d=new aD(a),e=new aD(b),f=j(d.getSubjectHex(),c),g=j(k(d.getPublicKeyHex(),0,[1],"03",!0),c);return{alg:c,issname:f,isskey:g,sbjsn:e.getSerialNumberHex()}},this.tohex=function(){if("object"!=typeof this.params)throw Error("params not set");var a,b,c,d,i=this.params;if(d=void 0==i.alg?this.DEFAULT_HASH:i.alg,void 0!=i.issuerCert&&void 0!=i.subjectCert){var j=this.getParamByCerts(i.issuerCert,i.subjectCert,d);a=j.issname,b=j.isskey,c=j.sbjsn}else if(void 0!=i.issname&&void 0!=i.isskey&&void 0!=i.sbjsn)a=i.issname,b=i.isskey,c=i.sbjsn;else throw Error("required param members not defined");var k=new g({array:[new h({name:d}),new e({hex:a}),new e({hex:b}),new f({hex:c})]});return this.hTLV=k.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&this.setByParam(a)},ay(c.asn1.ocsp.CertID,c.asn1.ASN1Object),c.asn1.ocsp.CertStatus=function(a){c.asn1.ocsp.CertStatus.superclass.constructor.call(this),this.params=null,this.tohex=function(){var a=this.params;if("good"==a.status)return"8000";if("unknown"==a.status)return"8200";if("revoked"==a.status){var b=[{gentime:{str:a.time}}];return void 0!=a.reason&&b.push({tag:{tag:"a0",explicit:!0,obj:{enum:{int:a.reason}}}}),c.asn1.ASN1Util.newObject({tag:{tag:"a1",explicit:!1,obj:{seq:b}}}).tohex()}throw Error("bad status")},this.getEncodedHex=function(){return this.tohex()},this.setByParam=function(a){this.params=a},void 0!==a&&this.setByParam(a)},ay(c.asn1.ocsp.CertStatus,c.asn1.ASN1Object),c.asn1.ocsp.Request=function(a){var b=c.asn1,d=b.DERSequence,e=b.ocsp;if(e.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.tohex=function(){var a=[];if(null===this.dReqCert)throw"reqCert not set";a.push(this.dReqCert);var b=new d({array:a});return this.hTLV=b.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a){var f=new e.CertID(a);this.dReqCert=f}},ay(c.asn1.ocsp.Request,c.asn1.ASN1Object),c.asn1.ocsp.TBSRequest=function(a){var b=c.asn1,d=b.DERSequence,e=b.ocsp;e.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(a){for(var b=[],c=0;c<a.length;c++){var d=new e.Request(a[0]);b.push(d)}this.dRequestList=b},this.tohex=function(){var a=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var b=new d({array:this.dRequestList});if(a.push(b),null!==this.dRequestExt)throw"requestExtensions not supported";var c=new d({array:a});return this.hTLV=c.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&void 0!==a.reqList&&this.setRequestListByParam(a.reqList)},ay(c.asn1.ocsp.TBSRequest,c.asn1.ASN1Object),c.asn1.ocsp.OCSPRequest=function(a){var b=c.asn1,d=b.DERSequence,e=b.ocsp;if(e.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.tohex=function(){var a=[];if(null!==this.dTbsRequest)a.push(this.dTbsRequest);else throw"tbsRequest not set";if(null!==this.dOptionalSignature)throw"optionalSignature not supported";var b=new d({array:a});return this.hTLV=b.tohex(),this.hTLV},this.getEncodedHex=function(){return this.tohex()},void 0!==a&&void 0!==a.reqList){var f=new e.TBSRequest(a);this.dTbsRequest=f}},ay(c.asn1.ocsp.OCSPRequest,c.asn1.ASN1Object),c.asn1.ocsp.OCSPUtil={},c.asn1.ocsp.OCSPUtil.getRequestHex=function(a,b,d){var e=c.asn1.ocsp;void 0===d&&(d=e.DEFAULT_HASH);var f={alg:d,issuerCert:a,subjectCert:b};return new e.OCSPRequest({reqList:[f]}).tohex()},c.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(a){var b=W.getVbyList,c=W.getVbyListEx,d=W.getIdxbyList,e=(W.getIdxbyListEx,W.getV),f={};try{var g=c(a,0,[0],"0a");f.responseStatus=parseInt(g,16)}catch(a){}if(0!==f.responseStatus)return f;try{var h=d(a,0,[1,0,1,0,0,2,0,1]);"80"===a.substr(h,2)?f.certStatus="good":"a1"===a.substr(h,2)?(f.certStatus="revoked",f.revocationTime=ac(b(a,h,[0]))):"82"===a.substr(h,2)&&(f.certStatus="unknown")}catch(a){}try{var i=d(a,0,[1,0,1,0,0,2,0,2]);f.thisUpdate=ac(e(a,i))}catch(a){}try{var j=d(a,0,[1,0,1,0,0,2,0,3]);"a0"===a.substr(j,2)&&(f.nextUpdate=ac(b(a,j,[0])))}catch(a){}return f},c.asn1.ocsp.OCSPParser=function(){var a=Error,b=new aD,d=W.getV,e=W.getTLV,f=W.getIdxbyList,g=W.getVbyList,h=W.getTLVbyList,i=W.getVbyListEx,j=W.getTLVbyListEx,k=W.getChildIdx;this.getOCSPRequest=function(b){var c=k(b,0);if(1!=c.length&&2!=c.length)throw new a("wrong number elements: "+c.length);return this.getTBSRequest(e(b,c[0]))},this.getTBSRequest=function(a){var c={},d=j(a,0,[0],"30");c.array=this.getRequestList(d);var e=j(a,0,["[2]",0],"30");return null!=e&&(c.ext=b.getExtParamArray(e)),c},this.getRequestList=function(a){for(var b=[],c=k(a,0),d=0;d<c.length;d++){var a=e(a,c[d]);b.push(this.getRequest(a))}return b},this.getRequest=function(c){var d=k(c,0);if(1!=d.length&&2!=d.length)throw new a("wrong number elements: "+d.length);var g=this.getCertID(e(c,d[0]));if(2==d.length){var h=f(c,0,[1,0]);g.ext=b.getExtParamArray(e(c,h))}return g},this.getCertID=function(b){var c=k(b,0);if(4!=c.length)throw new a("wrong number elements: "+c.length);var f=new aD,g={};return g.alg=f.getAlgorithmIdentifierName(e(b,c[0])),g.issname=d(b,c[1]),g.isskey=d(b,c[2]),g.sbjsn=d(b,c[3]),g},this.getOCSPResponse=function(a){var b,c=k(a,0),e=parseInt(d(a,c[0]));if(1==c.length)return{resstatus:e};var f=h(a,0,[1,0]);return(b=this.getResponseBytes(f)).resstatus=e,b},this.getResponseBytes=function(a){var b,e=k(a,0),f=h(a,0,[1,0]);b=this.getBasicOCSPResponse(f);var g=d(a,e[0]);return b.restype=c.asn1.x509.OID.oid2name(at(g)),b},this.getBasicOCSPResponse=function(a){var b,c=k(a,0);(b=this.getResponseData(e(a,c[0]))).alg=new aD().getAlgorithmIdentifierName(e(a,c[1])),b.sighex=d(a,c[2]).substr(2);var f=i(a,0,["[0]"]);if(null!=f){for(var g=k(f,0),h=[],j=0;j<g.length;j++){var l=e(f,g[j]);h.push(l)}b.certs=h}return b},this.getResponseData=function(a){var b=k(a,0),c=b.length,f={},g=0;if("a0"==a.substr(b[0],2)&&g++,f.respid=this.getResponderID(e(a,b[g++])),f.prodat=ac(d(a,b[g++])),f.array=this.getSingleResponseList(e(a,b[g++])),"a1"==a.substr(b[c-1],2)){var i=h(a,b[c-1],[0]);f.ext=new aD().getExtParamArray(i)}return f},this.getResponderID=function(a){var b={};if("a2"==a.substr(0,2)&&(b.key=g(a,0,[0])),"a1"==a.substr(0,2)){var c=h(a,0,[0]);b.name=new aD().getX500Name(c)}return b},this.getSingleResponseList=function(a){for(var b=k(a,0),c=[],d=0;d<b.length;d++){var f=this.getSingleResponse(e(a,b[d]));c.push(f)}return c},this.getSingleResponse=function(a){var b=k(a,0),c={};c.certid=this.getCertID(e(a,b[0])),c.status=this.getCertStatus(e(a,b[1])),"18"==a.substr(b[2],2)&&(c.thisupdate=ac(d(a,b[2])));for(var f=3;f<b.length;f++)if("a0"==a.substr(b[f],2)&&(c.nextupdate=ac(g(a,b[f],[0],"18"))),"a1"==a.substr(b[f],2)){var i=new aD,j=h(a,0,[f,0]);c.ext=i.getExtParamArray(j)}return c},this.getCertStatus=function(a){var b={};return"8000"==a?{status:"good"}:"8200"==a?{status:"unknown"}:("a1"==a.substr(0,2)&&(b.status="revoked",b.time=ac(g(a,0,[0]))),b)}},void 0!==c&&c||(c={}),void 0!==c.lang&&c.lang||(c.lang={}),c.lang.String=function(){},"function"==typeof Buffer?(d=function(a){return Z(Buffer.from(a,"utf8").toString("base64"))},e=function(a){return Buffer.from($(a),"base64").toString("utf8")}):(d=function(a){return _(ah(ap(a)))},e=function(a){return decodeURIComponent(ai(aa(a)))});function ad(a){for(var b="",c=0;c<a.length-1;c+=2)b+=String.fromCharCode(parseInt(a.substr(c,2),16));return b}function ae(a){for(var b="",c=0;c<a.length;c++)b+=("0"+a.charCodeAt(c).toString(16)).slice(-2);return b}function af(a,b){var c;return"-----BEGIN "+b+"-----\r\n"+(c=(c=j(a)).replace(RegExp("(.{64})","g"),"$1\r\n")).replace(/\s+$/,"")+"\r\n-----END "+b+"-----\r\n"}function ag(a,b){if(-1==a.indexOf("-----BEGIN "))throw Error("can't find PEM header");return k((a=void 0!==b?(a=a.replace(RegExp("^[^]*-----BEGIN "+b+"-----"),"")).replace(RegExp("-----END "+b+"-----[^]*$"),""):(a=a.replace(/^[^]*-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----[^]*$/,"")).replace(/[^0-9A-Za-z\/+=]*/g,""))}function ah(a){return a.replace(/%/g,"")}function ai(a){return a.replace(/(..)/g,"%$1")}function aj(a){var b="malformed IPv6 address";if(!a.match(/^[0-9A-Fa-f:]+$/))throw b;var c=(a=a.toLowerCase()).split(":").length-1;if(c<2)throw b;var d=":".repeat(7-c+2),e=(a=a.replace("::",d)).split(":");if(8!=e.length)throw b;for(var f=0;f<8;f++)e[f]=("0000"+e[f]).slice(-4);return e.join("")}function ak(a){if(!a.match(/^[0-9A-Fa-f]{32}$/))throw Error("malformed IPv6 address: "+a);var b=(a=a.toLowerCase()).match(/.{1,4}/g),c=(a=":"+(b=(b=b.map(function(a){return a.replace(/^0+/,"")})).map(function(a){return""==a?"0":a})).join(":")+":").match(/:(0:){2,}/g);if(null==c)return a.slice(1,-1);var d=c.sort().slice(-1)[0];return"::"!=(a=a.replace(d.substr(0,d.length-1),":")).substr(0,2)&&(a=a.substr(1)),"::"!=a.substr(-2,2)&&(a=a.substr(0,a.length-1)),a}function al(a){var b=Error("malformed hex value");if(!a.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw b;if(8==a.length)try{return parseInt(a.substr(0,2),16)+"."+parseInt(a.substr(2,2),16)+"."+parseInt(a.substr(4,2),16)+"."+parseInt(a.substr(6,2),16)}catch(a){throw b}if(16==a.length)try{return al(a.substr(0,8))+"/"+am(a.substr(8))}catch(a){throw b}if(32==a.length)return ak(a);if(64!=a.length)return a;try{return ak(a.substr(0,32))+"/"+am(a.substr(32))}catch(a){throw b}}function am(a){var b,c=Error("malformed mask");try{b=new l(a,16).toString(2)}catch(a){throw c}if(!b.match(/^1*0*$/))throw c;return b.replace(/0+$/,"").length}function an(a,b){return 32==b&&0==a?"00000000":128==b&&0==a?"00000000000000000000000000000000":new l(Array(a+1).join("1")+Array(b-a+1).join("0"),2).toString(16)}function ao(a){return a.match(/.{4}/g).map(function(a){var b=parseInt(a.substr(0,2),16),c=parseInt(a.substr(2),16);if(0==b&c<128)return String.fromCharCode(c);if(b<8){var d=192|(7&b)<<3|(192&c)>>6,e=128|63&c;return ac(d.toString(16)+e.toString(16))}var d=224|(240&b)>>4,e=128|(15&b)<<2|(192&c)>>6;return ac(d.toString(16)+e.toString(16)+(128|63&c).toString(16))}).join("")}function ap(a){for(var b=encodeURIComponent(a),c="",d=0;d<b.length;d++)"%"==b[d]?(c+=b.substr(d,3),d+=2):c=c+"%"+Y(b[d]);return c}function aq(a){return!!(a.length%2==0&&(a.match(/^[0-9a-f]+$/)||a.match(/^[0-9A-F]+$/)))}function ar(a){return!!a.match(/^[0-9A-Za-z-_.]+$/)}function as(a){return a.length%2==1?"0"+a:a.substr(0,1)>"7"?"00"+a:a}c.lang.String.isInteger=function(a){return!!a.match(/^[0-9]+$/)||!!a.match(/^-[0-9]+$/)},c.lang.String.isHex=function(a){return aq(a)},c.lang.String.isBase64=function(a){return!!(a=a.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)&&a.length%4==0},c.lang.String.isBase64URL=function(a){return!a.match(/[+/=]/)&&(a=$(a),c.lang.String.isBase64(a))},c.lang.String.isIntegerArray=function(a){return!!(a=a.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},c.lang.String.isPrintable=function(a){return null!==a.match(/^[0-9A-Za-z '()+,-./:=?]*$/)},c.lang.String.isIA5=function(a){return null!==a.match(/^[\x20-\x21\x23-\x7f]*$/)},c.lang.String.isMail=function(a){return null!==a.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)};function at(a){if(!aq(a))return null;try{var b=[],c=a.substr(0,2),d=parseInt(c,16);b[0]=new String(Math.floor(d/40)),b[1]=new String(d%40);for(var e=a.substr(2),f=[],g=0;g<e.length/2;g++)f.push(parseInt(e.substr(2*g,2),16));for(var h=[],i="",g=0;g<f.length;g++)128&f[g]?i+=av((127&f[g]).toString(2),7):(i+=av((127&f[g]).toString(2),7),h.push(new String(parseInt(i,2))),i="");var j=b.join(".");return h.length>0&&(j=j+"."+h.join(".")),j}catch(a){return null}}function au(a){var b=a.toString(16);if("-"!=b.substr(0,1))return b.length%2==1?b="0"+b:b.match(/^[0-7]/)||(b="00"+b),b;var c=b.substr(1).length;c%2==1?c+=1:b.match(/^[0-7]/)||(c+=2);for(var d="",e=0;e<c;e++)d+="f";return new l(d,16).xor(a).add(l.ONE).toString(16).replace(/^-/,"")}var av=function(a,b,c){return(void 0==c&&(c="0"),a.length>=b)?a:Array(b-a.length+1).join(c)+a};function aw(a,b){for(var c=0,d=0;d<a.length;d++)c|=1<<b[a[d]];for(var e=c.toString(2),f="",d=e.length-1;d>=0;d--)f+=e[d];return f}function ax(a,b,c){if("object"==typeof a){for(var b=String(b).split("."),d=0;d<b.length&&a;d++){var e=b[d];e.match(/^[0-9]+$/)&&(e=parseInt(e)),a=a[e]}return a||!1===a?a:c}}function ay(a,b){var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.superclass=b.prototype,b.prototype.constructor==Object.prototype.constructor&&(b.prototype.constructor=b)}void 0!==c&&c||(c={}),void 0!==c.crypto&&c.crypto||(c.crypto={}),c.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHAwithRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:h.algo.MD5,sha1:h.algo.SHA1,sha224:h.algo.SHA224,sha256:h.algo.SHA256,sha384:h.algo.SHA384,sha512:h.algo.SHA512,ripemd160:h.algo.RIPEMD160},this.getDigestInfoHex=function(a,b){if(void 0===this.DIGESTINFOHEAD[b])throw"alg not supported in Util.DIGESTINFOHEAD: "+b;return this.DIGESTINFOHEAD[b]+a},this.getPaddedDigestInfoHex=function(a,b,c){var d=this.getDigestInfoHex(a,b),e=c/4;if(d.length+22>e)throw"key is too short for SigAlg: keylen="+c+","+b;for(var f="0001",g="00"+d,h="",i=e-f.length-g.length,j=0;j<i;j+=2)h+="ff";return f+h+g},this.hashString=function(a,b){return new c.crypto.MessageDigest({alg:b}).digestString(a)},this.hashHex=function(a,b){return new c.crypto.MessageDigest({alg:b}).digestHex(a)},this.sha1=function(a){return this.hashString(a,"sha1")},this.sha256=function(a){return this.hashString(a,"sha256")},this.sha256Hex=function(a){return this.hashHex(a,"sha256")},this.sha512=function(a){return this.hashString(a,"sha512")},this.sha512Hex=function(a){return this.hashHex(a,"sha512")},this.isKey=function(a){return a instanceof R||a instanceof c.crypto.DSA||a instanceof c.crypto.ECDSA}},c.crypto.Util.md5=function(a){return new c.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(a)},c.crypto.Util.ripemd160=function(a){return new c.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(a)},c.crypto.Util.SECURERANDOMGEN=new P,c.crypto.Util.getRandomHexOfNbytes=function(a){var b=Array(a);return c.crypto.Util.SECURERANDOMGEN.nextBytes(b),X(b)},c.crypto.Util.getRandomBigIntegerOfNbytes=function(a){return new l(c.crypto.Util.getRandomHexOfNbytes(a),16)},c.crypto.Util.getRandomHexOfNbits=function(a){var b=a%8,d=Array((a-b)/8+1);return c.crypto.Util.SECURERANDOMGEN.nextBytes(d),d[0]=(255<<b&255^255)&d[0],X(d)},c.crypto.Util.getRandomBigIntegerOfNbits=function(a){return new l(c.crypto.Util.getRandomHexOfNbits(a),16)},c.crypto.Util.getRandomBigIntegerZeroToMax=function(a){for(var b=a.bitLength();;){var d=c.crypto.Util.getRandomBigIntegerOfNbits(b);if(-1!=a.compareTo(d))return d}},c.crypto.Util.getRandomBigIntegerMinToMax=function(a,b){var d=a.compareTo(b);if(1==d)throw"biMin is greater than biMax";if(0==d)return a;var e=b.subtract(a);return c.crypto.Util.getRandomBigIntegerZeroToMax(e).add(a)},c.crypto.MessageDigest=function(a){this.setAlgAndProvider=function(a,b){if(null!==(a=c.crypto.MessageDigest.getCanonicalAlgName(a))&&void 0===b&&(b=c.crypto.Util.DEFAULTPROVIDER[a]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(a)&&"cryptojs"==b){try{this.md=c.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[a].create()}catch(b){throw"setAlgAndProvider hash alg set fail alg="+a+"/"+b}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var b=h.enc.Hex.parse(a);this.md.update(b)},this.digest=function(){return this.md.finalize().toString(h.enc.Hex)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}if(-1!=":sha256:".indexOf(a)&&"sjcl"==b){try{this.md=new sjcl.hash.sha256}catch(b){throw"setAlgAndProvider hash alg set fail alg="+a+"/"+b}this.updateString=function(a){this.md.update(a)},this.updateHex=function(a){var b=sjcl.codec.hex.toBits(a);this.md.update(b)},this.digest=function(){var a=this.md.finalize();return sjcl.codec.hex.fromBits(a)},this.digestString=function(a){return this.updateString(a),this.digest()},this.digestHex=function(a){return this.updateHex(a),this.digest()}}},this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(a){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==a&&void 0!==a.alg&&(this.algName=a.alg,void 0===a.prov&&(this.provName=c.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},c.crypto.MessageDigest.getCanonicalAlgName=function(a){return"string"==typeof a&&(a=(a=a.toLowerCase()).replace(/-/,"")),a},c.crypto.MessageDigest.getHashLength=function(a){var b=c.crypto.MessageDigest,d=b.getCanonicalAlgName(a);if(void 0===b.HASHLENGTH[d])throw"not supported algorithm: "+a;return b.HASHLENGTH[d]},c.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},c.crypto.Mac=function(a){this.setAlgAndProvider=function(a,b){if(null==(a=a.toLowerCase())&&(a="hmacsha1"),"hmac"!=(a=a.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+a;void 0===b&&(b=c.crypto.Util.DEFAULTPROVIDER[a]),this.algProv=a+"/"+b;var d=a.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(d)&&"cryptojs"==b){try{var e=c.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[d];this.mac=h.algo.HMAC.create(e,this.pass)}catch(a){throw"setAlgAndProvider hash alg set fail hashAlg="+d+"/"+a}this.updateString=function(a){this.mac.update(a)},this.updateHex=function(a){var b=h.enc.Hex.parse(a);this.mac.update(b)},this.doFinal=function(){return this.mac.finalize().toString(h.enc.Hex)},this.doFinalString=function(a){return this.updateString(a),this.doFinal()},this.doFinalHex=function(a){return this.updateHex(a),this.doFinal()}}},this.updateString=function(a){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(a){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(a){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(a){if("string"==typeof a){var b=a;a.length%2!=1&&a.match(/^[0-9A-Fa-f]+$/)||(b=ae(a)),this.pass=h.enc.Hex.parse(b);return}if("object"!=typeof a)throw"KJUR.crypto.Mac unsupported password type: "+a;var b=null;if(void 0!==a.hex){if(a.hex.length%2!=0||!a.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+a.hex;b=a.hex}if(void 0!==a.utf8&&(b=ab(a.utf8)),void 0!==a.rstr&&(b=ae(a.rstr)),void 0!==a.b64&&(b=k(a.b64)),void 0!==a.b64u&&(b=aa(a.b64u)),null==b)throw"KJUR.crypto.Mac unsupported password type: "+a;this.pass=h.enc.Hex.parse(b)},void 0!==a&&(void 0!==a.pass&&this.setPassword(a.pass),void 0!==a.alg&&(this.algName=a.alg,void 0===a.prov&&(this.provName=c.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},c.crypto.Signature=function(a){var b=null;if(this._setAlgNames=function(){var a=this.algName.match(/^(.+)with(.+)$/);a&&(this.mdAlgName=a[1].toLowerCase(),this.pubkeyAlgName=a[2].toLowerCase(),"rsaandmgf1"==this.pubkeyAlgName&&"sha"==this.mdAlgName&&(this.mdAlgName="sha1"))},this._zeroPaddingOfSignature=function(a,b){for(var c="",d=b/4-a.length,e=0;e<d;e++)c+="0";return c+a},this.setAlgAndProvider=function(a,b){if(this._setAlgNames(),"cryptojs/jsrsa"!=b)throw Error("provider not supported: "+b);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new c.crypto.MessageDigest({alg:this.mdAlgName})}catch(a){throw Error("setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+a)}this.init=function(a,b){var c=null;try{c=void 0===b?az.getKey(a):az.getKey(a,b)}catch(a){throw"init failed:"+a}if(!0===c.isPrivate)this.prvKey=c,this.state="SIGN";else if(!0===c.isPublic)this.pubKey=c,this.state="VERIFY";else throw"init failed.:"+c},this.updateString=function(a){this.md.updateString(a)},this.updateHex=function(a){this.md.updateHex(a)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0===this.prvKey&&void 0!==this.ecprvhex&&void 0!==this.eccurvename&&void 0!==c.crypto.ECDSA&&(this.prvKey=new c.crypto.ECDSA({curve:this.eccurvename,prv:this.ecprvhex})),this.prvKey instanceof R&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof R&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof c.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else if(this.prvKey instanceof c.crypto.DSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;return this.hSign},this.signString=function(a){return this.updateString(a),this.sign()},this.signHex=function(a){return this.updateHex(a),this.sign()},this.verify=function(a){if(this.sHashHex=this.md.digest(),void 0===this.pubKey&&void 0!==this.ecpubhex&&void 0!==this.eccurvename&&void 0!==c.crypto.ECDSA&&(this.pubKey=new c.crypto.ECDSA({curve:this.eccurvename,pub:this.ecpubhex})),this.pubKey instanceof R&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,a,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof R&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);if(void 0!==c.crypto.ECDSA&&this.pubKey instanceof c.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);if(void 0!==c.crypto.DSA&&this.pubKey instanceof c.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,a);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(a,b){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(a){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(a){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(a){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(a){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(a){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=a,void 0!==a&&(void 0!==a.alg&&(this.algName=a.alg,void 0===a.prov?this.provName=c.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=a.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==a.psssaltlen&&(this.pssSaltLen=a.psssaltlen),void 0!==a.prvkeypem))if(void 0!==a.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";else try{var b=az.getKey(a.prvkeypem);this.init(b)}catch(a){throw"fatal error to load pem private key: "+a}},c.crypto.Cipher=function(a){},c.crypto.Cipher.encrypt=function(a,b,c,d){if(void 0!=ax(d,"enclag")&&(c=d.encalg),"string"==typeof c&&"-CBC"==c.substr(-4)){var e,f=b;void 0!=ax(d,"key")&&(f=d.key),void 0!=ax(d,"enc")&&(hEnc=d.enc);var g=h.enc.Hex.parse(f),i=h.enc.Hex.parse(a),j=h.enc.Hex.parse(d.iv);if("des-EDE3-CBC"==c)e=h.TripleDES.encrypt(i,g,{iv:j});else if("aes128-CBC"==c||"aes256-CBC"==c)e=h.AES.encrypt(i,g,{iv:j});else throw Error("unsupported algorithm: "+c);return e+""}throw Error("Cipher.encrypt: unsupported key or algorithm")},c.crypto.Cipher.decrypt=function(a,b,c,d){if(void 0!=ax(d,"enclag")&&(c=d.encalg),"string"==typeof c&&"-CBC"==c.substr(-4)){var e,f=b,g=a;void 0!=ax(d,"key")&&(f=d.key),void 0!=ax(d,"enc")&&(g=d.enc);var i=h.enc.Hex.parse(f),j=h.enc.Hex.parse(g),k=h.enc.Hex.parse(d.iv);if("des-EDE3-CBC"==c)e=h.TripleDES.decrypt({ciphertext:j},i,{iv:k});else if("aes128-CBC"==c||"aes256-CBC"==c)e=h.AES.decrypt({ciphertext:j},i,{iv:k});else throw Error("unsupported algorithm: "+c);return h.enc.Hex.stringify(e)}throw Error("Cipher.decrypt: unsupported key or algorithm")},c.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040022":"secp384r1","2b81040023":"secp521r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==c&&c||(c={}),void 0!==c.crypto&&c.crypto||(c.crypto={}),c.crypto.ECDSA=function(a){var b=Error,d=c.crypto.ECDSA,e=c.crypto.ECParameterDB,f=d.getName,g=W.getVbyListEx,h=W.isASN1HEX,i=new P;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(a){return new l(a.bitLength(),i).mod(a.subtract(l.ONE)).add(l.ONE)},this.setNamedCurve=function(a){this.ecparams=e.getByName(a),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=a},this.setPrivateKeyHex=function(a){this.isPrivate=!0,this.prvKeyHex=a},this.setPublicKeyHex=function(a){this.isPublic=!0,this.pubKeyHex=a},this.getPublicKeyXYHex=function(){var a=this.pubKeyHex;if("04"!==a.substr(0,2))throw"this method supports uncompressed format(04) only";var b=this.ecparams.keycharlen;if(a.length!==2+2*b)throw"malformed public key hex length";var c={};return c.x=a.substr(2,b),c.y=a.substr(2+b),c},this.getShortNISTPCurveName=function(){var a=this.curveName;return"secp256r1"===a||"NIST P-256"===a||"P-256"===a||"prime256v1"===a?"P-256":"secp384r1"===a||"NIST P-384"===a||"P-384"===a?"P-384":"secp521r1"===a||"NIST P-521"===a||"P-521"===a?"P-521":null},this.generateKeyPairHex=function(){var a=this.ecparams.n,b=this.getBigRandom(a),c=this.ecparams.keycharlen,d=("0000000000"+b.toString(16)).slice(-c);return this.setPrivateKeyHex(d),{ecprvhex:d,ecpubhex:this.generatePublicKeyHex()}},this.generatePublicKeyHex=function(){var a=new l(this.prvKeyHex,16),b=this.ecparams.G.multiply(a),c=b.getX().toBigInteger(),d=b.getY().toBigInteger(),e=this.ecparams.keycharlen,f="04"+("0000000000"+c.toString(16)).slice(-e)+("0000000000"+d.toString(16)).slice(-e);return this.setPublicKeyHex(f),f},this.signWithMessageHash=function(a){return this.signHex(a,this.prvKeyHex)},this.signHex=function(a,b){var c=new l(b,16),e=this.ecparams.n,f=new l(a.substring(0,this.ecparams.keycharlen),16);do var g=this.getBigRandom(e),h=this.ecparams.G.multiply(g).getX().toBigInteger().mod(e);while(0>=h.compareTo(l.ZERO));var i=g.modInverse(e).multiply(f.add(c.multiply(h))).mod(e);return d.biRSSigToASN1Sig(h,i)},this.sign=function(a,b){var c=this.ecparams.n,d=l.fromByteArrayUnsigned(a);do var e=this.getBigRandom(c),f=this.ecparams.G.multiply(e).getX().toBigInteger().mod(c);while(0>=f.compareTo(l.ZERO));var g=e.modInverse(c).multiply(d.add(b.multiply(f))).mod(c);return this.serializeSig(f,g)},this.verifyWithMessageHash=function(a,b){return this.verifyHex(a,b,this.pubKeyHex)},this.verifyHex=function(a,b,c){try{var e,f,g=d.parseSigHex(b);e=g.r,f=g.s;var h=T.decodeFromHex(this.ecparams.curve,c),i=new l(a.substring(0,this.ecparams.keycharlen),16);return this.verifyRaw(i,e,f,h)}catch(a){return!1}},this.verify=function(a,b,c){if(Bitcoin.Util.isArray(b)){var d,e,f,g=this.parseSig(b);d=g.r,e=g.s}else if("object"==typeof b&&b.r&&b.s)d=b.r,e=b.s;else throw"Invalid value for signature";if(c instanceof T)f=c;else if(Bitcoin.Util.isArray(c))f=T.decodeFrom(this.ecparams.curve,c);else throw"Invalid format for pubkey value, must be byte array or ECPointFp";var h=l.fromByteArrayUnsigned(a);return this.verifyRaw(h,d,e,f)},this.verifyRaw=function(a,b,c,d){var e=this.ecparams.n,f=this.ecparams.G;if(0>b.compareTo(l.ONE)||b.compareTo(e)>=0||0>c.compareTo(l.ONE)||c.compareTo(e)>=0)return!1;var g=c.modInverse(e),h=a.multiply(g).mod(e),i=b.multiply(g).mod(e);return f.multiply(h).add(d.multiply(i)).getX().toBigInteger().mod(e).equals(b)},this.serializeSig=function(a,b){var c=a.toByteArraySigned(),d=b.toByteArraySigned(),e=[];return e.push(2),e.push(c.length),(e=e.concat(c)).push(2),e.push(d.length),(e=e.concat(d)).unshift(e.length),e.unshift(48),e},this.parseSig=function(a){if(48!=a[0])throw Error("Signature not a valid DERSequence");if(2!=a[b=2])throw Error("First element in signature must be a DERInteger");var b,c=a.slice(b+2,b+2+a[b+1]);if(b+=2+a[b+1],2!=a[b])throw Error("Second element in signature must be a DERInteger");var d=a.slice(b+2,b+2+a[b+1]);return b+=2+a[b+1],{r:l.fromByteArrayUnsigned(c),s:l.fromByteArrayUnsigned(d)}},this.parseSigCompact=function(a){if(65!==a.length)throw"Signature has the wrong length";var b=a[0]-27;if(b<0||b>7)throw"Invalid signature type";var c=this.ecparams.n;return{r:l.fromByteArrayUnsigned(a.slice(1,33)).mod(c),s:l.fromByteArrayUnsigned(a.slice(33,65)).mod(c),i:b}},this.readPKCS5PrvKeyHex=function(a){var b,c,d;if(!1===h(a))throw Error("not ASN.1 hex string");try{b=g(a,0,["[0]",0],"06"),c=g(a,0,[1],"04");try{d=g(a,0,["[1]",0],"03")}catch(a){}}catch(a){throw Error("malformed PKCS#1/5 plain ECC private key")}if(this.curveName=f(b),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(d),this.setPrivateKeyHex(c),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(a){var c,d,e;if(!1===h(a))throw new b("not ASN.1 hex string");try{g(a,0,[1,0],"06"),c=g(a,0,[1,1],"06"),d=g(a,0,[2,0,1],"04");try{e=g(a,0,[2,0,"[1]",0],"03")}catch(a){}}catch(a){throw new b("malformed PKCS#8 plain ECC private key")}if(this.curveName=f(c),void 0===this.curveName)throw new b("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(e),this.setPrivateKeyHex(d),this.isPublic=!1},this.readPKCS8PubKeyHex=function(a){var c,d;if(!1===h(a))throw new b("not ASN.1 hex string");try{g(a,0,[0,0],"06"),c=g(a,0,[0,1],"06"),d=g(a,0,[1],"03")}catch(a){throw new b("malformed PKCS#8 ECC public key")}if(this.curveName=f(c),null===this.curveName)throw new b("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(d)},this.readCertPubKeyHex=function(a,c){var d,e;if(!1===h(a))throw new b("not ASN.1 hex string");try{d=g(a,0,[0,5,0,1],"06"),e=g(a,0,[0,5,1],"03")}catch(a){throw new b("malformed X.509 certificate ECC public key")}if(this.curveName=f(d),null===this.curveName)throw new b("unsupported curve name");this.setNamedCurve(this.curveName),this.setPublicKeyHex(e)},void 0!==a&&void 0!==a.curve&&(this.curveName=a.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==a&&(void 0!==a.prv&&this.setPrivateKeyHex(a.prv),void 0!==a.pub&&this.setPublicKeyHex(a.pub))},c.crypto.ECDSA.parseSigHex=function(a){var b=c.crypto.ECDSA.parseSigHexInHexRS(a);return{r:new l(b.r,16),s:new l(b.s,16)}},c.crypto.ECDSA.parseSigHexInHexRS=function(a){var b=W.getChildIdx,c=W.getV;if(W.checkStrictDER(a,0),"30"!=a.substr(0,2))throw Error("signature is not a ASN.1 sequence");var d=b(a,0);if(2!=d.length)throw Error("signature shall have two elements");var e=d[0],f=d[1];if("02"!=a.substr(e,2))throw Error("1st item not ASN.1 integer");if("02"!=a.substr(f,2))throw Error("2nd item not ASN.1 integer");return{r:c(a,e),s:c(a,f)}},c.crypto.ECDSA.asn1SigToConcatSig=function(a){var b=c.crypto.ECDSA.parseSigHexInHexRS(a),d=b.r,e=b.s;if(d.length>=130&&d.length<=134){if(d.length%2!=0)throw Error("unknown ECDSA sig r length error");if(e.length%2!=0)throw Error("unknown ECDSA sig s length error");"00"==d.substr(0,2)&&(d=d.substr(2)),"00"==e.substr(0,2)&&(e=e.substr(2));var f=Math.max(d.length,e.length);return(d=("000000"+d).slice(-f))+(e=("000000"+e).slice(-f))}if("00"==d.substr(0,2)&&d.length%32==2&&(d=d.substr(2)),"00"==e.substr(0,2)&&e.length%32==2&&(e=e.substr(2)),d.length%32==30&&(d="00"+d),e.length%32==30&&(e="00"+e),d.length%32!=0)throw Error("unknown ECDSA sig r length error");if(e.length%32!=0)throw Error("unknown ECDSA sig s length error");return d+e},c.crypto.ECDSA.concatSigToASN1Sig=function(a){if(a.length%4!=0)throw Error("unknown ECDSA concatinated r-s sig length error");var b=a.substr(0,a.length/2),d=a.substr(a.length/2);return c.crypto.ECDSA.hexRSSigToASN1Sig(b,d)},c.crypto.ECDSA.hexRSSigToASN1Sig=function(a,b){var d=new l(a,16),e=new l(b,16);return c.crypto.ECDSA.biRSSigToASN1Sig(d,e)},c.crypto.ECDSA.biRSSigToASN1Sig=function(a,b){var d=c.asn1,e=new d.DERInteger({bigint:a}),f=new d.DERInteger({bigint:b});return new d.DERSequence({array:[e,f]}).tohex()},c.crypto.ECDSA.getName=function(a){return"2b8104001f"===a?"secp192k1":"2a8648ce3d030107"===a?"secp256r1":"2b8104000a"===a?"secp256k1":"2b81040021"===a?"secp224r1":"2b81040022"===a?"secp384r1":"2b81040023"===a?"secp521r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(a)?"secp256r1":-1!=="|secp256k1|".indexOf(a)?"secp256k1":-1!=="|secp224r1|NIST P-224|P-224|".indexOf(a)?"secp224r1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(a)?"secp384r1":-1!=="|secp521r1|NIST P-521|P-521|".indexOf(a)?"secp521r1":null},void 0!==c&&c||(c={}),void 0!==c.crypto&&c.crypto||(c.crypto={}),c.crypto.ECParameterDB=new function(){var a={},b={};function c(a){return new l(a,16)}this.getByName=function(c){var d=c;if(void 0!==b[d]&&(d=b[c]),void 0!==a[d])return a[d];throw"unregistered EC curve name: "+d},this.regist=function(d,e,f,g,h,i,j,k,l,m,n,o){a[d]={};var p=c(f),q=c(g),r=c(h),s=c(i),t=c(j),u=new U(p,q,r),v=u.decodePointHex("04"+k+l);a[d].name=d,a[d].keylen=e,a[d].keycharlen=2*Math.ceil(e/8),a[d].curve=u,a[d].G=v,a[d].n=s,a[d].h=t,a[d].oid=n,a[d].info=o;for(var w=0;w<m.length;w++)b[m[w]]=d}},c.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),c.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),c.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),c.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),c.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),c.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),c.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),c.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),c.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),c.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","00C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==c&&c||(c={}),void 0!==c.crypto&&c.crypto||(c.crypto={}),c.crypto.DSA=function(){W.getVbyList;var a=W.getVbyListEx,b=W.isASN1HEX;this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(a,b,c,d,e){this.isPrivate=!0,this.p=a,this.q=b,this.g=c,this.y=d,this.x=e},this.setPrivateHex=function(a,b,c,d,e){var f,g,h,i,j;f=new l(a,16),g=new l(b,16),h=new l(c,16),i="string"==typeof d&&d.length>1?new l(d,16):null,j=new l(e,16),this.setPrivate(f,g,h,i,j)},this.setPublic=function(a,b,c,d){this.isPublic=!0,this.p=a,this.q=b,this.g=c,this.y=d,this.x=null},this.setPublicHex=function(a,b,c,d){var e,f,g,h;e=new l(a,16),f=new l(b,16),g=new l(c,16),h=new l(d,16),this.setPublic(e,f,g,h)},this.signWithMessageHash=function(a){var b=this.p,d=this.q,e=this.g;this.y;var f=this.x,g=c.crypto.Util.getRandomBigIntegerMinToMax(l.ONE.add(l.ONE),d.subtract(l.ONE)),h=new l(a.substr(0,d.bitLength()/4),16),i=e.modPow(g,b).mod(d),j=g.modInverse(d).multiply(h.add(f.multiply(i))).mod(d);return c.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:i}},{int:{bigint:j}}]})},this.verifyWithMessageHash=function(a,b){var c=this.p,d=this.q,e=this.g,f=this.y,g=this.parseASN1Signature(b),h=g[0],i=g[1],j=new l(a.substr(0,d.bitLength()/4),16);if(l.ZERO.compareTo(h)>0||h.compareTo(d)>0||l.ZERO.compareTo(i)>=0||i.compareTo(d)>0)throw"invalid DSA signature";var k=i.modInverse(d),m=j.multiply(k).mod(d),n=h.multiply(k).mod(d);return 0==e.modPow(m,c).multiply(f.modPow(n,c)).mod(c).mod(d).compareTo(h)},this.parseASN1Signature=function(b){try{var c=new l(a(b,0,[0],"02"),16),d=new l(a(b,0,[1],"02"),16);return[c,d]}catch(a){throw Error("malformed ASN.1 DSA signature")}},this.readPKCS5PrvKeyHex=function(c){var d,e,f,g,h;if(!1===b(c))throw Error("not ASN.1 hex string");try{d=a(c,0,[1],"02"),e=a(c,0,[2],"02"),f=a(c,0,[3],"02"),g=a(c,0,[4],"02"),h=a(c,0,[5],"02")}catch(a){throw Error("malformed PKCS#1/5 plain DSA private key")}this.setPrivateHex(d,e,f,g,h)},this.readPKCS8PrvKeyHex=function(c){var d,e,f,g;if(!1===b(c))throw Error("not ASN.1 hex string");try{d=a(c,0,[1,1,0],"02"),e=a(c,0,[1,1,1],"02"),f=a(c,0,[1,1,2],"02"),g=a(c,0,[2,0],"02")}catch(a){throw Error("malformed PKCS#8 plain DSA private key")}this.setPrivateHex(d,e,f,null,g)},this.readPKCS8PubKeyHex=function(c){var d,e,f,g;if(!1===b(c))throw Error("not ASN.1 hex string");try{d=a(c,0,[0,1,0],"02"),e=a(c,0,[0,1,1],"02"),f=a(c,0,[0,1,2],"02"),g=a(c,0,[1,0],"02")}catch(a){throw Error("malformed PKCS#8 DSA public key")}this.setPublicHex(d,e,f,g)},this.readCertPubKeyHex=function(c,d){var e,f,g,h;if(!1===b(c))throw Error("not ASN.1 hex string");try{e=a(c,0,[0,5,0,1,0],"02"),f=a(c,0,[0,5,0,1,1],"02"),g=a(c,0,[0,5,0,1,2],"02"),h=a(c,0,[0,5,1,0],"02")}catch(a){throw Error("malformed X.509 certificate DSA public key")}this.setPublicHex(e,f,g,h)}};var az=function(){var a=function(a,c,d){return b(h.AES,a,c,d)},b=function(a,b,c,d){var e=h.enc.Hex.parse(b),f=h.enc.Hex.parse(c),g=h.enc.Hex.parse(d),i={};i.key=f,i.iv=g,i.ciphertext=e;var j=a.decrypt(i,f,{iv:g});return h.enc.Hex.stringify(j)},d=function(a,b,c){return e(h.AES,a,b,c)},e=function(a,b,c,d){var e=h.enc.Hex.parse(b),f=h.enc.Hex.parse(c),g=h.enc.Hex.parse(d),i=a.encrypt(e,f,{iv:g}),j=h.enc.Hex.parse(i.toString());return h.enc.Base64.stringify(j)},f={"AES-256-CBC":{proc:a,eproc:d,keylen:32,ivlen:16},"AES-192-CBC":{proc:a,eproc:d,keylen:24,ivlen:16},"AES-128-CBC":{proc:a,eproc:d,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(a,c,d){return b(h.TripleDES,a,c,d)},eproc:function(a,b,c){return e(h.TripleDES,a,b,c)},keylen:24,ivlen:8},"DES-CBC":{proc:function(a,c,d){return b(h.DES,a,c,d)},eproc:function(a,b,c){return e(h.DES,a,b,c)},keylen:8,ivlen:8}},g=function(a){var b=h.lib.WordArray.random(a);return h.enc.Hex.stringify(b)},i=function(a){var b={},c=a.match(RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));c&&(b.cipher=c[1],b.ivsalt=c[2]);var d=a.match(RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));d&&(b.type=d[1]);var e=-1,f=0;-1!=a.indexOf("\r\n\r\n")&&(e=a.indexOf("\r\n\r\n"),f=2),-1!=a.indexOf("\n\n")&&(e=a.indexOf("\n\n"),f=1);var g=a.indexOf("-----END");if(-1!=e&&-1!=g){var h=a.substring(e+2*f,g-f);b.data=h=h.replace(/\s+/g,"")}return b},j=function(a,b,c){for(var d=c.substring(0,16),e=h.enc.Hex.parse(d),g=h.enc.Utf8.parse(b),i=f[a].keylen+f[a].ivlen,j="",k=null;;){var l=h.algo.MD5.create();if(null!=k&&l.update(k),l.update(g),l.update(e),k=l.finalize(),(j+=h.enc.Hex.stringify(k)).length>=2*i)break}var m={};return m.keyhex=j.substr(0,2*f[a].keylen),m.ivhex=j.substr(2*f[a].keylen,2*f[a].ivlen),m},k=function(a,b,c,d){var e=h.enc.Base64.parse(a),g=h.enc.Hex.stringify(e);return(0,f[b].proc)(g,c,d)};return{version:"1.0.0",parsePKCS5PEM:function(a){return i(a)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(a,b,c){return j(a,b,c)},decryptKeyB64:function(a,b,c,d){return k(a,b,c,d)},getDecryptedKeyHex:function(a,b){var c=i(a);c.type;var d=c.cipher,e=c.ivsalt,f=c.data,g=j(d,b,e).keyhex;return k(f,d,g,e)},getEncryptedPKCS5PEMFromPrvKeyHex:function(a,b,c,d,e){var h,i,k="";if((void 0===d||null==d)&&(d="AES-256-CBC"),void 0===f[d])throw Error("KEYUTIL unsupported algorithm: "+d);(void 0===e||null==e)&&(e=g(f[d].ivlen).toUpperCase());var l=j(d,c,e).keyhex,m=(h=d,i=e,(0,f[h].eproc)(b,l,i)).replace(/(.{64})/g,"$1\r\n"),k="-----BEGIN "+a+" PRIVATE KEY-----\r\n";return k+="Proc-Type: 4,ENCRYPTED\r\n",k+="DEK-Info: "+d+","+e+"\r\n",k+="\r\n",k+=m,k+="\r\n-----END "+a+" PRIVATE KEY-----\r\n"},getEncryptedPKCS8PEM:function(a,b,c){return af(this.getEncryptedPKCS8Hex(a,b,c),"ENCRYPTED PRIVATE KEY")},getEncryptedPKCS8Hex:function(a,b,d){(e=void 0==d||null==d?{}:JSON.parse(JSON.stringify(d))).plain=a,this.initPBES2Param(e),this.encryptPBES2Param(e,b);var e,f=this.generatePBES2ASN1Param(e);return c.asn1.ASN1Util.newObject(f).tohex()},initPBES2Param:function(a){if(void 0==ax(a,"encalg")&&(a.encalg="aes256-CBC"),void 0==ax(a,"iter")&&(a.iter=2048),void 0==ax(a,"prf")&&(a.prf="hmacWithSHA256"),void 0==ax(a,"salt")&&(a.salt=h.enc.Hex.stringify(h.lib.WordArray.random(8))),void 0==ax(a,"enciv")){var b;"des-EDE3-CBC"==a.encalg&&(b=8),"aes128-CBC"==a.encalg&&(b=16),"aes256-CBC"==a.encalg&&(b=16),a.enciv=h.enc.Hex.stringify(h.lib.WordArray.random(b))}},encryptPBES2Param:function(a,b){var d=az.getDKFromPBES2Param(a,b);try{var e=c.crypto.Cipher.encrypt(a.plain,d,a.encalg,{iv:a.enciv})}catch(b){throw Error("encrypt error: "+a.plain+" "+d+" "+a.encalg+" "+a.enciv)}a.enc=e},generatePBES2ASN1Param:function(a){var b={seq:[{seq:[{oid:"pkcs5PBES2"},{seq:[{seq:[{oid:"pkcs5PBKDF2"},{seq:[{octstr:{hex:a.salt}},{int:{hex:au(new l(String(a.iter),10))}}]}]},{seq:[{oid:a.encalg},{octstr:{hex:a.enciv}}]}]}]},{octstr:{hex:a.enc}}]};return"hmacWithSHA1"!=a.prf&&b.seq[0].seq[1].seq[0].seq[1].seq.push({seq:[{oid:a.prf},{null:""}]}),b},parseHexOfEncryptedPKCS8:function(a){var b=W.getChildIdx,c=W.getV,d={},e=b(a,0);if(2!=e.length)throw Error("malformed format: SEQUENCE(0).items != 2: "+e.length);d.ciphertext=c(a,e[1]);var f=b(a,e[0]);if(2!=f.length)throw Error("malformed format: SEQUENCE(0.0).items != 2: "+f.length);if("2a864886f70d01050d"!=c(a,f[0]))throw Error("this only supports pkcs5PBES2");var g=b(a,f[1]);if(2!=f.length)throw Error("malformed format: SEQUENCE(0.0.1).items != 2: "+g.length);var h=b(a,g[1]);if(2!=h.length)throw Error("malformed format: SEQUENCE(0.0.1.1).items != 2: "+h.length);if("2a864886f70d0307"!=c(a,h[0]))throw"this only supports TripleDES";d.encryptionSchemeAlg="TripleDES",d.encryptionSchemeIV=c(a,h[1]);var i=b(a,g[0]);if(2!=i.length)throw Error("malformed format: SEQUENCE(0.0.1.0).items != 2: "+i.length);if("2a864886f70d01050c"!=c(a,i[0]))throw Error("this only supports pkcs5PBKDF2");var j=b(a,i[1]);if(j.length<2)throw Error("malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+j.length);d.pbkdf2Salt=c(a,j[0]);var k=c(a,j[1]);try{d.pbkdf2Iter=parseInt(k,16)}catch(a){throw Error("malformed format pbkdf2Iter: "+k)}return d},getPBKDF2KeyHexFromParam:function(a,b){var c=h.enc.Hex.parse(a.pbkdf2Salt),d=a.pbkdf2Iter,e=h.PBKDF2(b,c,{keySize:6,iterations:d});return h.enc.Hex.stringify(e)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(a,b){var c=ag(a,"ENCRYPTED PRIVATE KEY"),d=this.parseHexOfEncryptedPKCS8(c),e=az.getPBKDF2KeyHexFromParam(d,b),f={};f.ciphertext=h.enc.Hex.parse(d.ciphertext);var g=h.enc.Hex.parse(e),i=h.enc.Hex.parse(d.encryptionSchemeIV),j=h.TripleDES.decrypt(f,g,{iv:i});return h.enc.Hex.stringify(j)},parsePBES2:function(a){var b=W.parse(a);if("pkcs5PBES2"!=ax(b,"seq.0.seq.0.oid")||"pkcs5PBKDF2"!=ax(b,"seq.0.seq.1.seq.0.seq.0.oid"))throw Error("not pkcs5PBES2 and pkcs5PBKDF2 used");var c=ax(b,"seq.0.seq.1.seq.0.seq.1.seq");if(void 0==c)throw Error("PBKDF2 parameter not found");var d=ax(c,"0.octstr.hex"),e=ax(c,"1.int.hex"),f=ax(c,"2.seq.0.oid","hmacWithSHA1"),g=-1;try{g=parseInt(e,16)}catch(a){throw Error("iter not proper value")}var h=ax(b,"seq.0.seq.1.seq.1.seq.0.oid"),i=ax(b,"seq.0.seq.1.seq.1.seq.1.octstr.hex"),j=ax(b,"seq.1.octstr.hex");if(void 0==h||void 0==i||void 0==j)throw Error("encalg, enciv or enc is undefined");return{salt:d,iter:g,prf:f,encalg:h,enciv:i,enc:j}},getDKFromPBES2Param:function(a,b){var c={hmacWithSHA1:h.algo.SHA1,hmacWithSHA224:h.algo.SHA224,hmacWithSHA256:h.algo.SHA256,hmacWithSHA384:h.algo.SHA384,hmacWithSHA512:h.algo.SHA512}[a.prf];if(void 0==c)throw Error("unsupported prf");var d={"des-EDE3-CBC":6,"aes128-CBC":4,"aes256-CBC":8}[a.encalg];if(void 0==d)throw Error("unsupported encalg");var e=h.enc.Hex.parse(a.salt),f=a.iter;try{var g=h.PBKDF2(b,e,{keySize:d,iterations:f,hasher:c});return h.enc.Hex.stringify(g)}catch(c){throw Error("PBKDF2 error: "+c+" "+JSON.stringify(a)+" "+b)}},getPlainHexFromEncryptedPKCS8PEM:function(a,b){if(-1==a.indexOf("BEGIN ENCRYPTED PRIVATE KEY"))throw Error("not Encrypted PKCS#8 PEM string");var d,e=ag(a);try{d=az.parsePBES2(e)}catch(a){throw Error("malformed PBES2 format: "+a.message)}var f=az.getDKFromPBES2Param(d,b);return c.crypto.Cipher.decrypt(d.enc,f,d.encalg,{iv:d.enciv})},getKeyFromEncryptedPKCS8PEM:function(a,b){var c=this.getPlainHexFromEncryptedPKCS8PEM(a,b);return this.getKeyFromPlainPrivatePKCS8Hex(c)},parsePlainPrivatePKCS8Hex:function(a){var b=W.getChildIdx,c=W.getV,d={};if(d.algparam=null,"30"!=a.substr(0,2))throw Error("malformed plain PKCS8 private key(code:001)");var e=b(a,0);if(e.length<3)throw Error("malformed plain PKCS8 private key(code:002)");if("30"!=a.substr(e[1],2))throw Error("malformed PKCS8 private key(code:003)");var f=b(a,e[1]);if(2!=f.length)throw Error("malformed PKCS8 private key(code:004)");if("06"!=a.substr(f[0],2))throw Error("malformed PKCS8 private key(code:005)");if(d.algoid=c(a,f[0]),"06"==a.substr(f[1],2)&&(d.algparam=c(a,f[1])),"04"!=a.substr(e[2],2))throw Error("malformed PKCS8 private key(code:006)");return d.keyidx=W.getVidx(a,e[2]),d},getKeyFromPlainPrivatePKCS8PEM:function(a){var b=ag(a,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(b)},getKeyFromPlainPrivatePKCS8Hex:function(a){var b,d=this.parsePlainPrivatePKCS8Hex(a);if("2a864886f70d010101"==d.algoid)b=new R;else if("2a8648ce380401"==d.algoid)b=new c.crypto.DSA;else if("2a8648ce3d0201"==d.algoid)b=new c.crypto.ECDSA;else throw Error("unsupported private key algorithm");return b.readPKCS8PrvKeyHex(a),b},_getKeyFromPublicPKCS8Hex:function(a){var b,d=W.getVbyList(a,0,[0,0],"06");if("2a864886f70d010101"===d)b=new R;else if("2a8648ce380401"===d)b=new c.crypto.DSA;else if("2a8648ce3d0201"===d)b=new c.crypto.ECDSA;else throw Error("unsupported PKCS#8 public key hex");return b.readPKCS8PubKeyHex(a),b},parsePublicRawRSAKeyHex:function(a){var b=W.getChildIdx,c=W.getV,d={};if("30"!=a.substr(0,2))throw Error("malformed RSA key(code:001)");var e=b(a,0);if(2!=e.length)throw Error("malformed RSA key(code:002)");if("02"!=a.substr(e[0],2))throw Error("malformed RSA key(code:003)");if(d.n=c(a,e[0]),"02"!=a.substr(e[1],2))throw Error("malformed RSA key(code:004)");return d.e=c(a,e[1]),d},parsePublicPKCS8Hex:function(a){var b=W.getChildIdx,c=W.getV,d={};d.algparam=null;var e=b(a,0);if(2!=e.length)throw Error("outer DERSequence shall have 2 elements: "+e.length);var f=e[0];if("30"!=a.substr(f,2))throw Error("malformed PKCS8 public key(code:001)");var g=b(a,f);if(2!=g.length)throw Error("malformed PKCS8 public key(code:002)");if("06"!=a.substr(g[0],2))throw Error("malformed PKCS8 public key(code:003)");if(d.algoid=c(a,g[0]),"06"==a.substr(g[1],2)?d.algparam=c(a,g[1]):"30"==a.substr(g[1],2)&&(d.algparam={},d.algparam.p=W.getVbyList(a,g[1],[0],"02"),d.algparam.q=W.getVbyList(a,g[1],[1],"02"),d.algparam.g=W.getVbyList(a,g[1],[2],"02")),"03"!=a.substr(e[1],2))throw Error("malformed PKCS8 public key(code:004)");return d.key=c(a,e[1]).substr(2),d}}}();function aA(a,b){for(var c="",d=b/4-a.length,e=0;e<d;e++)c+="0";return c+a}function aB(a,b,c){for(var d="",e=0;d.length<b;)d+=ad(c(ae(a+String.fromCharCode.apply(String,[(0xff000000&e)>>24,(0xff0000&e)>>16,(65280&e)>>8,255&e])))),e+=1;return d}function aC(a){for(var b in c.crypto.Util.DIGESTINFOHEAD){var d=c.crypto.Util.DIGESTINFOHEAD[b],e=d.length;if(a.substring(0,e)==d)return[b,a.substring(e)]}return[]}function aD(a){var b,d=W.getChildIdx,e=W.getV,f=(W.dump,W.parse),g=W.getTLV,h=W.getVbyList,i=W.getVbyListEx,j=W.getTLVbyList,k=W.getTLVbyListEx,l=W.getIdxbyList,m=W.getIdxbyListEx,n=W.getVidx,o=W.getInt,p=W.oidname,q=W.hextooidstr,r=Error;try{b=c.asn1.x509.AlgorithmIdentifier.PSSNAME2ASN1TLV}catch(a){}this.HEX2STAG={"0c":"utf8",13:"prn",16:"ia5","1a":"vis","1e":"bmp"},this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){if(null===this.hex||0!==this.version)return this.version;var a=j(this.hex,0,[0,0]);if("a0"!=a.substr(0,2))return this.version=1,this.foffset=-1,1;var b=o(j(a,0,[0]),0);if(b<0||2<b)throw Error("malformed version field");return this.version=b+1,this.version},this.getSerialNumberHex=function(){return i(this.hex,0,[0,0],"02")},this.getSignatureAlgorithmField=function(){var a=k(this.hex,0,[0,1]);return this.getAlgorithmIdentifierName(a)},this.getAlgorithmIdentifierName=function(a){for(var c in b)if(a===b[c])return c;return p(i(a,0,[0],"06"))},this.getIssuer=function(a,b){return this.getX500Name(this.getIssuerHex(),a,b)},this.getIssuerHex=function(){return j(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return this.getIssuer().str},this.getSubject=function(a,b){return this.getX500Name(this.getSubjectHex(),a,b)},this.getSubjectHex=function(){return j(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return this.getSubject().str},this.getNotBefore=function(){var a=h(this.hex,0,[0,4+this.foffset,0]);return decodeURIComponent(a=a.replace(/(..)/g,"%$1"))},this.getNotAfter=function(){var a=h(this.hex,0,[0,4+this.foffset,1]);return decodeURIComponent(a=a.replace(/(..)/g,"%$1"))},this.getPublicKeyHex=function(){return this.getSPKI()},this.getSPKI=function(){return j(this.hex,0,[0,6+this.foffset],"30")},this.getSPKIValue=function(){var a=this.getSPKI();return null==a?null:h(a,0,[1],"03",!0)},this.getPublicKeyIdx=function(){return l(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var a=this.getPublicKeyIdx();return l(this.hex,a,[1,0],"30")},this.getPublicKey=function(){return az.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){var a=j(this.hex,0,[1],"30");return this.getAlgorithmIdentifierName(a)},this.getSignatureValueHex=function(){return h(this.hex,0,[2],"03",!0)},this.verifySignature=function(a){var b=this.getSignatureAlgorithmField(),d=this.getSignatureValueHex(),e=j(this.hex,0,[0],"30"),f=new c.crypto.Signature({alg:b});return f.init(a),f.updateHex(e),f.verify(d)},this.parseExt=function(a){var b,c,f;if(void 0===a){if(f=this.hex,3!==this.version)return -1;b=l(f,0,[0,7,0],"30"),c=d(f,b)}else{var g=l(f=ag(a),0,[0,3,0,0],"06");if("2a864886f70d01090e"!=e(f,g)){this.aExtInfo=[];return}b=l(f,0,[0,3,0,1,0],"30"),c=d(f,b),this.hex=f}this.aExtInfo=[];for(var i=0;i<c.length;i++){var j={};j.critical=!1;var k=d(f,c[i]),m=0;3===k.length&&(j.critical=!0,m=1),j.oid=W.hextooidstr(h(f,c[i],[0],"06"));var o=l(f,c[i],[1+m]);j.vidx=n(f,o),this.aExtInfo.push(j)}},this.getExtInfo=function(a){var b=this.aExtInfo,d=a;if(a.match(/^[0-9.]+$/)||(d=c.asn1.x509.OID.name2oid(a)),""!==d){for(var e=0;e<b.length;e++)if(b[e].oid===d)return b[e]}},this.getCriticalExtV=function(a,b,c){if(void 0!=b)return[b,c];var d=this.getExtInfo(a);return void 0==d?[null,null]:[g(this.hex,d.vidx),d.critical]},this.getExtBasicConstraints=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("basicConstraints");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var d={extname:"basicConstraints"};if(b&&(d.critical=!0),"3000"===a)return d;if("30030101ff"===a)return d.cA=!0,d;if("30060101ff02"===a.substr(0,12)){var f=parseInt(e(a,10),16);return d.cA=!0,d.pathLen=f,d}throw Error("hExtV parse error: "+a)},this.getExtNameConstraints=function(a,b){var c=this.getCriticalExtV("nameConstraints",a,b);if(a=c[0],b=c[1],null!=a){var e={extname:"nameConstraints"};b&&(e.critical=!0);for(var f=d(a,0),h=0;h<f.length;h++){for(var i=[],j=d(a,f[h]),k=0;k<j.length;k++){var l=g(a,j[k]),m=this.getGeneralSubtree(l);i.push(m)}var n=a.substr(f[h],2);"a0"==n?e.permit=i:"a1"==n&&(e.exclude=i)}return e}},this.getGeneralSubtree=function(a){var b=d(a,0),c=b.length;if(c<1||2<c)throw Error("wrong num elements");for(var f=this.getGeneralName(g(a,b[0])),h=1;h<c;h++){var i=a.substr(b[h],2),j=parseInt(e(a,b[h]),16);"80"==i&&(f.min=j),"81"==i&&(f.max=j)}return f},this.getExtKeyUsage=function(a,b){var c=this.getCriticalExtV("keyUsage",a,b);if(a=c[0],b=c[1],null!=a){var d={extname:"keyUsage"};return b&&(d.critical=!0),d.names=this.getExtKeyUsageString(a).split(","),d}},this.getExtKeyUsageBin=function(a){if(void 0===a){var b=this.getExtInfo("keyUsage");if(void 0===b)return"";a=g(this.hex,b.vidx)}if(8!=a.length&&10!=a.length)throw Error("malformed key usage value: "+a);var c="000000000000000"+parseInt(a.substr(6),16).toString(2);return 8==a.length&&(c=c.slice(-8)),10==a.length&&(c=c.slice(-16)),""==(c=c.replace(/0+$/,""))&&(c="0"),c},this.getExtKeyUsageString=function(a){for(var b=this.getExtKeyUsageBin(a),c=[],d=0;d<b.length;d++)"1"==b.substr(d,1)&&c.push(aD.KEYUSAGE_NAME[d]);return c.join(",")},this.getExtSubjectKeyIdentifier=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("subjectKeyIdentifier");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var d={extname:"subjectKeyIdentifier"};return b&&(d.critical=!0),d.kid={hex:e(a,0)},d},this.getExtAuthorityKeyIdentifier=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("authorityKeyIdentifier");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var f={extname:"authorityKeyIdentifier"};b&&(f.critical=!0);for(var h=d(a,0),i=0;i<h.length;i++){var j=a.substr(h[i],2);if("80"===j&&(f.kid={hex:e(a,h[i])}),"a1"===j){var k=g(a,h[i]);f.issuer=this.getGeneralNames(k)[0].dn}"82"===j&&(f.sn={hex:e(a,h[i])})}return f},this.getExtExtKeyUsage=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("extKeyUsage");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var f={extname:"extKeyUsage",array:[]};b&&(f.critical=!0);for(var h=d(a,0),i=0;i<h.length;i++)f.array.push(p(e(a,h[i])));return f},this.getExtExtKeyUsageName=function(){var a=this.getExtInfo("extKeyUsage");if(void 0===a)return a;var b=[],c=g(this.hex,a.vidx);if(""===c)return b;for(var f=d(c,0),h=0;h<f.length;h++)b.push(p(e(c,f[h])));return b},this.getExtSubjectAltName=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("subjectAltName");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var d={extname:"subjectAltName",array:[]};return b&&(d.critical=!0),d.array=this.getGeneralNames(a),d},this.getExtIssuerAltName=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("issuerAltName");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var d={extname:"issuerAltName",array:[]};return b&&(d.critical=!0),d.array=this.getGeneralNames(a),d},this.getGeneralNames=function(a){for(var b=d(a,0),c=[],e=0;e<b.length;e++){var f=this.getGeneralName(g(a,b[e]));void 0!==f&&c.push(f)}return c},this.getGeneralName=function(a){var b=a.substr(0,2),c=e(a,0),d=ad(c);return"81"==b?{rfc822:d}:"82"==b?{dns:d}:"86"==b?{uri:d}:"87"==b?{ip:al(c)}:"a4"==b?{dn:this.getX500Name(c)}:"a0"==b?{other:this.getOtherName(a)}:void 0},this.getExtSubjectAltName2=function(){var a,b,c,f=this.getExtInfo("subjectAltName");if(void 0===f)return f;for(var h=[],i=g(this.hex,f.vidx),j=d(i,0),k=0;k<j.length;k++)c=i.substr(j[k],2),a=e(i,j[k]),"81"===c&&h.push(["MAIL",b=ac(a)]),"82"===c&&h.push(["DNS",b=ac(a)]),"84"===c&&h.push(["DN",b=aD.hex2dn(a,0)]),"86"===c&&h.push(["URI",b=ac(a)]),"87"===c&&h.push(["IP",b=al(a)]);return h},this.getExtCRLDistributionPoints=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("cRLDistributionPoints");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var e={extname:"cRLDistributionPoints",array:[]};b&&(e.critical=!0);for(var f=d(a,0),h=0;h<f.length;h++){var i=g(a,f[h]);e.array.push(this.getDistributionPoint(i))}return e},this.getDistributionPoint=function(a){for(var b={},c=d(a,0),e=0;e<c.length;e++){var f=a.substr(c[e],2),h=g(a,c[e]);"a0"==f&&(b.dpname=this.getDistributionPointName(h))}return b},this.getDistributionPointName=function(a){for(var b={},c=d(a,0),e=0;e<c.length;e++){var f=a.substr(c[e],2),h=g(a,c[e]);"a0"==f&&(b.full=this.getGeneralNames(h))}return b},this.getExtCRLDistributionPointsURI=function(){var a=this.getExtCRLDistributionPoints();if(void 0==a)return a;for(var b=a.array,c=[],d=0;d<b.length;d++)try{void 0!=b[d].dpname.full[0].uri&&c.push(b[d].dpname.full[0].uri)}catch(a){}return c},this.getExtAIAInfo=function(){var a=this.getExtInfo("authorityInfoAccess");if(void 0===a)return a;for(var b={ocsp:[],caissuer:[]},c=d(this.hex,a.vidx),e=0;e<c.length;e++){var f=h(this.hex,c[e],[0],"06"),g=h(this.hex,c[e],[1],"86");"2b06010505073001"===f&&b.ocsp.push(ac(g)),"2b06010505073002"===f&&b.caissuer.push(ac(g))}return b},this.getExtAuthorityInfoAccess=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("authorityInfoAccess");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var e={extname:"authorityInfoAccess",array:[]};b&&(e.critical=!0);for(var f=d(a,0),j=0;j<f.length;j++){var k=i(a,f[j],[0],"06"),l=ac(h(a,f[j],[1],"86"));if("2b06010505073001"==k)e.array.push({ocsp:l});else if("2b06010505073002"==k)e.array.push({caissuer:l});else throw Error("unknown method: "+k)}return e},this.getExtCertificatePolicies=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("certificatePolicies");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var e={extname:"certificatePolicies",array:[]};b&&(e.critical=!0);for(var f=d(a,0),h=0;h<f.length;h++){var i=g(a,f[h]),j=this.getPolicyInformation(i);e.array.push(j)}return e},this.getPolicyInformation=function(a){var b={};b.policyoid=p(h(a,0,[0],"06"));var c=m(a,0,[1],"30");if(-1!=c){b.array=[];for(var e=d(a,c),f=0;f<e.length;f++){var i=g(a,e[f]),j=this.getPolicyQualifierInfo(i);b.array.push(j)}}return b},this.getOtherName=function(a){var b={},c=d(a,0),e=h(a,c[0],[],"06"),g=h(a,c[1],[]);return b.oid=p(e),b.value=f(g),b},this.getPolicyQualifierInfo=function(a){var b={},c=h(a,0,[0],"06");if("2b06010505070201"===c)b.cps=ad(i(a,0,[1],"16"));else if("2b06010505070202"===c){var d=j(a,0,[1],"30");b.unotice=this.getUserNotice(d)}return b},this.getUserNotice=function(a){var b=null;try{return b=W.parse(a),this._asn1ToUnotice(b)}catch(a){return}},this._asn1ToUnotice=function(a){try{for(var b={},c=ax(a,"seq"),d=0;d<c.length;d++){var e=this._asn1ToNoticeRef(c[d]);void 0!=e&&(b.noticeref=e);var f=this.asn1ToDisplayText(c[d]);void 0!=f&&(b.exptext=f)}if(Object.keys(b).length>0)return b;return}catch(a){return}},this._asn1ToNoticeRef=function(a){try{for(var b={},c=ax(a,"seq"),d=0;d<c.length;d++){var e=this._asn1ToNoticeNum(c[d]);void 0!=e&&(b.noticenum=e);var f=this.asn1ToDisplayText(c[d]);void 0!=f&&(b.org=f)}if(Object.keys(b).length>0)return b;return}catch(a){return}},this._asn1ToNoticeNum=function(a){try{for(var b=ax(a,"seq"),c=[],d=0;d<b.length;d++){var e=b[d];c.push(parseInt(ax(e,"int.hex"),16))}return c}catch(a){return}},this.getDisplayText=function(a){var b={};return b.type=({"0c":"utf8",16:"ia5","1a":"vis","1e":"bmp"})[a.substr(0,2)],b.str=ad(e(a,0)),b},this.asn1ToDisplayText=function(a){return void 0!=a.utf8str?{type:"utf8",str:a.utf8str.str}:void 0!=a.ia5str?{type:"ia5",str:a.ia5str.str}:void 0!=a.visstr?{type:"vis",str:a.visstr.str}:void 0!=a.bmpstr?{type:"bmp",str:a.bmpstr.str}:void 0!=a.prnstr?{type:"prn",str:a.prnstr.str}:void 0},this.getExtPolicyMappings=function(a,b){var c=this.getCriticalExtV("policyMappings",a,b);if(a=c[0],b=c[1],null!=a){var d={extname:"policyMappings"};b&&(d.critical=!0);try{for(var e=f(a).seq,g=[],h=0;h<e.length;h++){var i=e[h].seq;g.push([i[0].oid,i[1].oid])}d.array=g}catch(a){throw new r("malformed policyMappings")}return d}},this.getExtPolicyConstraints=function(a,b){var c=this.getCriticalExtV("policyConstraints",a,b);if(a=c[0],b=c[1],null!=a){var d={extname:"policyConstraints"};b&&(d.critical=!0);var e=f(a);try{for(var g=e.seq,h=0;h<g.length;h++){var i=g[h].tag;!1==i.explicit&&("80"==i.tag&&(d.reqexp=parseInt(i.hex,16)),"81"==i.tag&&(d.inhibit=parseInt(i.hex,16)))}}catch(a){return new r("malformed policyConstraints value")}return d}},this.getExtInhibitAnyPolicy=function(a,b){var c=this.getCriticalExtV("inhibitAnyPolicy",a,b);if(a=c[0],b=c[1],null!=a){var d={extname:"inhibitAnyPolicy"};b&&(d.critical=!0);var e=o(a,0);return -1==e?new r("wrong value"):(d.skip=e,d)}},this.getExtCRLNumber=function(a,b){var c={extname:"cRLNumber"};if(b&&(c.critical=!0),"02"==a.substr(0,2))return c.num={hex:e(a,0)},c;throw new r("hExtV parse error: "+a)},this.getExtCRLReason=function(a,b){var c={extname:"cRLReason"};if(b&&(c.critical=!0),"0a"==a.substr(0,2))return c.code=parseInt(e(a,0),16),c;throw Error("hExtV parse error: "+a)},this.getExtOcspNonce=function(a,b){var c={extname:"ocspNonce"};return b&&(c.critical=!0),c.hex=e(a,0),c},this.getExtOcspNoCheck=function(a,b){var c={extname:"ocspNoCheck"};return b&&(c.critical=!0),c},this.getExtAdobeTimeStamp=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("adobeTimeStamp");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var e={extname:"adobeTimeStamp"};b&&(e.critical=!0);var f=d(a,0);if(f.length>1){var h=g(a,f[1]),i=this.getGeneralName(h);void 0!=i.uri&&(e.uri=i.uri)}if(f.length>2){var j=g(a,f[2]);"0101ff"==j&&(e.reqauth=!0),"010100"==j&&(e.reqauth=!1)}return e},this.getExtSubjectDirectoryAttributes=function(a,b){if(void 0===a&&void 0===b){var c=this.getExtInfo("subjectDirectoryAttributes");if(void 0===c)return;a=g(this.hex,c.vidx),b=c.critical}var d={extname:"subjectDirectoryAttributes"};b&&(d.critical=!0);try{for(var e=f(a),h=[],i=0;i<e.seq.length;i++){var j=e.seq[i],k=ax(j,"seq.0.oid"),l=ax(j,"seq.1.set");if(void 0==k||void 0==l)throw"error";h.push({attr:k,array:l})}return d.array=h,d}catch(a){throw Error("malformed subjectDirectoryAttributes extension value")}};var s=function(a){var b={};try{var d=a.seq[0].oid,e=c.asn1.x509.OID.name2oid(d);b.type=c.asn1.x509.OID.oid2atype(e);var f=a.seq[1];if(void 0!=f.utf8str)b.ds="utf8",b.value=f.utf8str.str;else if(void 0!=f.numstr)b.ds="num",b.value=f.numstr.str;else if(void 0!=f.telstr)b.ds="tel",b.value=f.telstr.str;else if(void 0!=f.prnstr)b.ds="prn",b.value=f.prnstr.str;else if(void 0!=f.ia5str)b.ds="ia5",b.value=f.ia5str.str;else if(void 0!=f.visstr)b.ds="vis",b.value=f.visstr.str;else if(void 0!=f.bmpstr)b.ds="bmp",b.value=f.bmpstr.str;else throw"error";return b}catch(a){throw new Erorr("improper ASN.1 parsed AttrTypeAndValue")}},t=function(a){try{return a.set.map(function(a){return s(a)})}catch(a){throw Error("improper ASN.1 parsed RDN: "+a)}},u=function(a){try{return a.seq.map(function(a){return t(a)})}catch(a){throw Error("improper ASN.1 parsed X500Name: "+a)}};this.getX500NameRule=function(a){for(var b=null,d=[],e=0;e<a.length;e++)for(var f=a[e],g=0;g<f.length;g++)d.push(f[g]);for(var e=0;e<d.length;e++){var h=d[e],i=h.ds,j=h.value,k=h.type;if("prn"!=i&&"utf8"!=i&&"ia5"!=i)return"mixed";if("ia5"==i)if("CN"!=k)return"mixed";else if(!c.lang.String.isMail(j))return"mixed";else continue;if("C"==k)if("prn"==i)continue;else return"mixed";if(null==b)b=i;else if(b!==i)return"mixed"}return null==b?"prn":b},this.getAttrTypeAndValue=function(a){return s(f(a))},this.getRDN=function(a){return t(f(a))},this.getX500NameArray=function(a){return u(f(a))},this.getX500Name=function(a,b,c){var d=this.getX500NameArray(a),e={str:this.dnarraytostr(d)};return e.array=d,!0==c&&(e.hex=a),!0==b&&(e.canon=this.c14nRDNArray(d)),e},this.readCertPEM=function(a){this.readCertHex(ag(a))},this.readCertHex=function(a){this.hex=a,this.getVersion();try{l(this.hex,0,[0,7],"a3"),this.parseExt()}catch(a){}},this.getParam=function(a){var b={};return void 0==a&&(a={}),b.version=this.getVersion(),b.serial={hex:this.getSerialNumberHex()},b.sigalg=this.getSignatureAlgorithmField(),b.issuer=this.getIssuer(a.dncanon,a.dnhex),b.notbefore=this.getNotBefore(),b.notafter=this.getNotAfter(),b.subject=this.getSubject(a.dncanon,a.dnhex),b.sbjpubkey=af(this.getPublicKeyHex(),"PUBLIC KEY"),void 0!=this.aExtInfo&&this.aExtInfo.length>0&&(b.ext=this.getExtParamArray()),b.sighex=this.getSignatureValueHex(),!0==a.tbshex&&(b.tbshex=j(this.hex,0,[0])),!0==a.nodnarray&&(delete b.issuer.array,delete b.subject.array),b},this.getExtParamArray=function(a){void 0==a&&-1!=m(this.hex,0,[0,"[3]"])&&(a=k(this.hex,0,[0,"[3]",0],"30"));for(var b=[],c=d(a,0),e=0;e<c.length;e++){var f=g(a,c[e]),h=this.getExtParam(f);null!=h&&b.push(h)}return b},this.getExtParam=function(a){var b=d(a,0).length;if(2!=b&&3!=b)throw Error("wrong number elements in Extension: "+b+" "+a);var c=q(h(a,0,[0],"06")),e=!1;3==b&&"0101ff"==j(a,0,[1])&&(e=!0);var g=j(a,0,[b-1,0]),i=void 0;if("2.5.29.14"==c?i=this.getExtSubjectKeyIdentifier(g,e):"2.5.29.15"==c?i=this.getExtKeyUsage(g,e):"2.5.29.17"==c?i=this.getExtSubjectAltName(g,e):"2.5.29.18"==c?i=this.getExtIssuerAltName(g,e):"2.5.29.19"==c?i=this.getExtBasicConstraints(g,e):"2.5.29.30"==c?i=this.getExtNameConstraints(g,e):"2.5.29.31"==c?i=this.getExtCRLDistributionPoints(g,e):"2.5.29.32"==c?i=this.getExtCertificatePolicies(g,e):"2.5.29.33"==c?i=this.getExtPolicyMappings(g,e):"2.5.29.35"==c?i=this.getExtAuthorityKeyIdentifier(g,e):"2.5.29.36"==c?i=this.getExtPolicyConstraints(g,e):"2.5.29.37"==c?i=this.getExtExtKeyUsage(g,e):"2.5.29.54"==c?i=this.getExtInhibitAnyPolicy(g,e):"1.3.6.1.5.5.7.1.1"==c?i=this.getExtAuthorityInfoAccess(g,e):"2.5.29.20"==c?i=this.getExtCRLNumber(g,e):"2.5.29.21"==c?i=this.getExtCRLReason(g,e):"2.5.29.9"==c?i=this.getExtSubjectDirectoryAttributes(g,e):"1.3.6.1.5.5.7.48.1.2"==c?i=this.getExtOcspNonce(g,e):"1.3.6.1.5.5.7.48.1.5"==c?i=this.getExtOcspNoCheck(g,e):"1.2.840.113583.1.1.9.1"==c?i=this.getExtAdobeTimeStamp(g,e):void 0!=aD.EXT_PARSER[c]&&(i=aD.EXT_PARSER[c](c,e,g)),void 0!=i)return i;var k={extname:c,extn:g};try{k.extn=f(g)}catch(a){}return e&&(k.critical=!0),k},this.findExt=function(a,b){for(var c=0;c<a.length;c++)if(a[c].extname==b)return a[c];return null},this.updateExtCDPFullURI=function(a,b){var c=this.findExt(a,"cRLDistributionPoints");if(null!=c&&void 0!=c.array){for(var d=c.array,e=0;e<d.length;e++)if(void 0!=d[e].dpname&&void 0!=d[e].dpname.full)for(var f=d[e].dpname.full,g=0;g<f.length;g++){var h=f[e];void 0!=h.uri&&(h.uri=b)}}},this.updateExtAIAOCSP=function(a,b){var c=this.findExt(a,"authorityInfoAccess");if(null!=c&&void 0!=c.array)for(var d=c.array,e=0;e<d.length;e++)void 0!=d[e].ocsp&&(d[e].ocsp=b)},this.updateExtAIACAIssuer=function(a,b){var c=this.findExt(a,"authorityInfoAccess");if(null!=c&&void 0!=c.array)for(var d=c.array,e=0;e<d.length;e++)void 0!=d[e].caissuer&&(d[e].caissuer=b)},this.dnarraytostr=function(a){return"/"+a.map(function(a){return a.map(function(a){var b;return((b=a).type+"="+b.value).replace(/\+/,"\\+")}).join("+").replace(/\//,"\\/")}).join("/")},this.setCanonicalizedDN=function(a){var b;if(void 0!=a.str&&void 0==a.array){var d=new c.asn1.x509.X500Name({str:a.str}).tohex();b=this.getX500NameArray(d)}else b=a.array;void 0==a.canon&&(a.canon=this.c14nRDNArray(b))},this.c14nRDNArray=function(a){for(var b=[],c=0;c<a.length;c++){for(var d=a[c],e=[],f=0;f<d.length;f++){var g=d[f],h=g.value;h=(h=(h=(h=h.replace(/^\s*/,"")).replace(/\s*$/,"")).replace(/\s+/g," ")).toLowerCase(),e.push(g.type.toLowerCase()+"="+h)}b.push(e.join("+"))}return"/"+b.join("/")},this.getInfo=function(){var a,b,d;if(a="Basic Fields\n  serial number: "+this.getSerialNumberHex()+"\n"+("  signature algorithm: "+this.getSignatureAlgorithmField())+"\n"+("  issuer: "+this.getIssuerString())+"\n"+("  notBefore: "+this.getNotBefore())+"\n"+("  notAfter: "+this.getNotAfter())+"\n"+("  subject: "+this.getSubjectString())+"\n  subject public key info: \n"+("    key algorithm: "+(b=this.getPublicKey()).type+"\n"),"RSA"===b.type&&(a+="    n="+as(b.n.toString(16)).substr(0,16)+"...\n",a+="    e="+as(b.e.toString(16))+"\n"),null!=(d=this.aExtInfo)){a+="X509v3 Extensions:\n";for(var e=0;e<d.length;e++){var f=d[e],g=c.asn1.x509.OID.oid2name(f.oid);""===g&&(g=f.oid);var h="";if(!0===f.critical&&(h="CRITICAL"),a+="  "+g+" "+h+":\n","basicConstraints"===g){var i=this.getExtBasicConstraints();void 0===i.cA?a+="    {}\n":(a+="    cA=true",void 0!==i.pathLen&&(a+=", pathLen="+i.pathLen),a+="\n")}else if("policyMappings"==g)a+="    "+this.getExtPolicyMappings().array.map(function(a){return a[0]+":"+a[1]}).join(", ")+"\n";else if("policyConstraints"==g){var j=this.getExtPolicyConstraints();a+="    ",void 0!=j.reqexp&&(a+=" reqexp="+j.reqexp),void 0!=j.inhibit&&(a+=" inhibit="+j.inhibit),a+="\n"}else if("inhibitAnyPolicy"==g){var j=this.getExtInhibitAnyPolicy();a+="    skip="+j.skip+"\n"}else if("keyUsage"==g)a+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"==g)a+="    "+this.getExtSubjectKeyIdentifier().kid.hex+"\n";else if("authorityKeyIdentifier"==g){var k=this.getExtAuthorityKeyIdentifier();void 0!==k.kid&&(a+="    kid="+k.kid.hex+"\n")}else"extKeyUsage"==g?a+="    "+this.getExtExtKeyUsage().array.join(", ")+"\n":"subjectAltName"==g?a+=function(a){for(var b="",c="    ",d=a.array,e=0;e<d.length;e++){var f=d[e];void 0!=f.dn&&(b+=c+"dn: "+f.dn.str+"\n"),void 0!=f.ip&&(b+=c+"ip: "+f.ip+"\n"),void 0!=f.rfc822&&(b+=c+"rfc822: "+f.rfc822+"\n"),void 0!=f.dns&&(b+=c+"dns: "+f.dns+"\n"),void 0!=f.uri&&(b+=c+"uri: "+f.uri+"\n"),void 0!=f.other&&(b+=c+"other: "+f.other.oid+"="+JSON.stringify(f.other.value).replace(/\"/g,"")+"\n")}return b.replace(/\n$/,"")}(this.getExtSubjectAltName())+"\n":"cRLDistributionPoints"==g?a+=function(a){for(var b="",c=a.array,d=0;d<c.length;d++){var e=c[d];try{void 0!==e.dpname.full[0].uri&&(b+="    "+e.dpname.full[0].uri+"\n")}catch(a){}try{void 0!==e.dname.full[0].dn.hex&&(b+="    "+aD.hex2dn(e.dpname.full[0].dn.hex)+"\n")}catch(a){}}return b}(this.getExtCRLDistributionPoints()):"authorityInfoAccess"==g?a+=function(a){for(var b="",c=a.array,d=0;d<c.length;d++){var e=c[d];void 0!==e.caissuer&&(b+="    caissuer: "+e.caissuer+"\n"),void 0!==e.ocsp&&(b+="    ocsp: "+e.ocsp+"\n")}return b}(this.getExtAuthorityInfoAccess()):"certificatePolicies"==g&&(a+=function(a){for(var b="",c=a.array,d=0;d<c.length;d++){var e=c[d];if(b+="    policy oid: "+e.policyoid+"\n",void 0!==e.array)for(var f=0;f<e.array.length;f++){var g=e.array[f];void 0!==g.cps&&(b+="    cps: "+g.cps+"\n")}}return b}(this.getExtCertificatePolicies()))}}return a+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",a+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"},"string"==typeof a&&(-1!=a.indexOf("-----BEGIN")?this.readCertPEM(a):c.lang.String.isHex(a)&&this.readCertHex(a))}az.getKey=function(a,b,d){var e=W,f=e.getChildIdx,g=(e.getV,e.getVbyList),h=c.crypto,i=h.ECDSA,j=h.DSA,k=ag;if(a instanceof R||void 0!==i&&a instanceof i||void 0!==j&&a instanceof j)return a;if(void 0!==a.curve&&void 0!==a.xy&&void 0===a.d)return new i({pub:a.xy,curve:a.curve});if(void 0!==a.curve&&void 0!==a.d)return new i({prv:a.d,curve:a.curve});if(void 0===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0===a.d){var m=new R;return m.setPublic(a.n,a.e),m}if(void 0===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0!==a.d&&void 0!==a.p&&void 0!==a.q&&void 0!==a.dp&&void 0!==a.dq&&void 0!==a.co&&void 0===a.qi){var m=new R;return m.setPrivateEx(a.n,a.e,a.d,a.p,a.q,a.dp,a.dq,a.co),m}if(void 0===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0!==a.d&&void 0===a.p){var m=new R;return m.setPrivate(a.n,a.e,a.d),m}if(void 0!==a.p&&void 0!==a.q&&void 0!==a.g&&void 0!==a.y&&void 0===a.x){var m=new j;return m.setPublic(a.p,a.q,a.g,a.y),m}if(void 0!==a.p&&void 0!==a.q&&void 0!==a.g&&void 0!==a.y&&void 0!==a.x){var m=new j;return m.setPrivate(a.p,a.q,a.g,a.y,a.x),m}if("RSA"===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0===a.d){var m=new R;return m.setPublic(aa(a.n),aa(a.e)),m}if("RSA"===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0!==a.d&&void 0!==a.p&&void 0!==a.q&&void 0!==a.dp&&void 0!==a.dq&&void 0!==a.qi){var m=new R;return m.setPrivateEx(aa(a.n),aa(a.e),aa(a.d),aa(a.p),aa(a.q),aa(a.dp),aa(a.dq),aa(a.qi)),m}if("RSA"===a.kty&&void 0!==a.n&&void 0!==a.e&&void 0!==a.d){var m=new R;return m.setPrivate(aa(a.n),aa(a.e),aa(a.d)),m}if("EC"===a.kty&&void 0!==a.crv&&void 0!==a.x&&void 0!==a.y&&void 0===a.d){var n=new i({curve:a.crv}),o=n.ecparams.keycharlen,p=("0000000000"+aa(a.x)).slice(-o),q=("0000000000"+aa(a.y)).slice(-o),r="04"+p+q;return n.setPublicKeyHex(r),n}if("EC"===a.kty&&void 0!==a.crv&&void 0!==a.x&&void 0!==a.y&&void 0!==a.d){var n=new i({curve:a.crv}),o=n.ecparams.keycharlen,p=("0000000000"+aa(a.x)).slice(-o),q=("0000000000"+aa(a.y)).slice(-o),r="04"+p+q,s=("0000000000"+aa(a.d)).slice(-o);return n.setPublicKeyHex(r),n.setPrivateKeyHex(s),n}if("pkcs5prv"===d){var t,m,e=W;if(9===(t=f(a,0)).length)(m=new R).readPKCS5PrvKeyHex(a);else if(6===t.length)(m=new j).readPKCS5PrvKeyHex(a);else if(t.length>2&&"04"===a.substr(t[1],2))(m=new i).readPKCS5PrvKeyHex(a);else throw Error("unsupported PKCS#1/5 hexadecimal key");return m}if("pkcs8prv"===d){var m=az.getKeyFromPlainPrivatePKCS8Hex(a);return m}if("pkcs8pub"===d)return az._getKeyFromPublicPKCS8Hex(a);if("x509pub"===d)return aD.getPublicKeyFromCertHex(a);if(-1!=a.indexOf("-END CERTIFICATE-",0)||-1!=a.indexOf("-END X509 CERTIFICATE-",0)||-1!=a.indexOf("-END TRUSTED CERTIFICATE-",0))return aD.getPublicKeyFromCertPEM(a);if(-1!=a.indexOf("-END PUBLIC KEY-")){var u=ag(a,"PUBLIC KEY");return az._getKeyFromPublicPKCS8Hex(u)}if(-1!=a.indexOf("-END RSA PRIVATE KEY-")&&-1==a.indexOf("4,ENCRYPTED")){var v=k(a,"RSA PRIVATE KEY");return az.getKey(v,null,"pkcs5prv")}if(-1!=a.indexOf("-END DSA PRIVATE KEY-")&&-1==a.indexOf("4,ENCRYPTED")){var w=k(a,"DSA PRIVATE KEY"),x=g(w,0,[1],"02"),y=g(w,0,[2],"02"),z=g(w,0,[3],"02"),A=g(w,0,[4],"02"),B=g(w,0,[5],"02"),m=new j;return m.setPrivate(new l(x,16),new l(y,16),new l(z,16),new l(A,16),new l(B,16)),m}if(-1!=a.indexOf("-END EC PRIVATE KEY-")&&-1==a.indexOf("4,ENCRYPTED")){var v=k(a,"EC PRIVATE KEY");return az.getKey(v,null,"pkcs5prv")}if(-1!=a.indexOf("-END PRIVATE KEY-"))return az.getKeyFromPlainPrivatePKCS8PEM(a);if(-1!=a.indexOf("-END RSA PRIVATE KEY-")&&-1!=a.indexOf("4,ENCRYPTED")){var C=az.getDecryptedKeyHex(a,b),D=new R;return D.readPKCS5PrvKeyHex(C),D}if(-1!=a.indexOf("-END EC PRIVATE KEY-")&&-1!=a.indexOf("4,ENCRYPTED")){var w=az.getDecryptedKeyHex(a,b),m=g(w,0,[1],"04"),E=g(w,0,[2,0],"06"),F=g(w,0,[3,0],"03").substr(2),G="";if(void 0!==c.crypto.OID.oidhex2name[E])G=c.crypto.OID.oidhex2name[E];else throw Error("undefined OID(hex) in KJUR.crypto.OID: "+E);var n=new i({curve:G});return n.setPublicKeyHex(F),n.setPrivateKeyHex(m),n.isPublic=!1,n}if(-1!=a.indexOf("-END DSA PRIVATE KEY-")&&-1!=a.indexOf("4,ENCRYPTED")){var w=az.getDecryptedKeyHex(a,b),x=g(w,0,[1],"02"),y=g(w,0,[2],"02"),z=g(w,0,[3],"02"),A=g(w,0,[4],"02"),B=g(w,0,[5],"02"),m=new j;return m.setPrivate(new l(x,16),new l(y,16),new l(z,16),new l(A,16),new l(B,16)),m}if(-1!=a.indexOf("-END ENCRYPTED PRIVATE KEY-"))return az.getKeyFromEncryptedPKCS8PEM(a,b);throw Error("not supported argument")},az.generateKeypair=function(a,b){if("RSA"==a){var d=new R;d.generate(b,"10001"),d.isPrivate=!0,d.isPublic=!0;var e=new R,f=d.n.toString(16),g=d.e.toString(16);e.setPublic(f,g),e.isPrivate=!1,e.isPublic=!0;var h={};return h.prvKeyObj=d,h.pubKeyObj=e,h}if("EC"==a){var i=new c.crypto.ECDSA({curve:b}).generateKeyPairHex(),d=new c.crypto.ECDSA({curve:b});d.setPublicKeyHex(i.ecpubhex),d.setPrivateKeyHex(i.ecprvhex),d.isPrivate=!0,d.isPublic=!1;var e=new c.crypto.ECDSA({curve:b});e.setPublicKeyHex(i.ecpubhex),e.isPrivate=!1,e.isPublic=!0;var h={};return h.prvKeyObj=d,h.pubKeyObj=e,h}throw Error("unknown algorithm: "+a)},az.getPEM=function(a,b,d,e,f,g){var h=c,i=h.asn1,j=i.DERObjectIdentifier,k=i.DERInteger,l=i.ASN1Util.newObject,m=i.x509.SubjectPublicKeyInfo,n=h.crypto,o=n.DSA,p=n.ECDSA;function q(a){return l({seq:[{int:0},{int:{bigint:a.n}},{int:a.e},{int:{bigint:a.d}},{int:{bigint:a.p}},{int:{bigint:a.q}},{int:{bigint:a.dmp1}},{int:{bigint:a.dmq1}},{int:{bigint:a.coeff}}]})}function r(a){return l({seq:[{int:1},{octstr:{hex:a.prvKeyHex}},{tag:["a0",!0,{oid:{name:a.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+a.pubKeyHex}}]}]})}function s(a){return l({seq:[{int:0},{int:{bigint:a.p}},{int:{bigint:a.q}},{int:{bigint:a.g}},{int:{bigint:a.y}},{int:{bigint:a.x}}]})}if((void 0!==R&&a instanceof R||void 0!==o&&a instanceof o||void 0!==p&&a instanceof p)&&!0==a.isPublic&&(void 0===b||"PKCS8PUB"==b)){var t=new m(a),u=t.tohex();return af(u,"PUBLIC KEY")}if("PKCS1PRV"==b&&void 0!==R&&a instanceof R&&(void 0===d||null==d)&&!0==a.isPrivate){var t=q(a),u=t.tohex();return af(u,"RSA PRIVATE KEY")}if("PKCS1PRV"==b&&void 0!==p&&a instanceof p&&(void 0===d||null==d)&&!0==a.isPrivate){var v=new j({name:a.curveName}).tohex(),w=r(a).tohex(),x="";return x+=af(v,"EC PARAMETERS"),x+=af(w,"EC PRIVATE KEY")}if("PKCS1PRV"==b&&void 0!==o&&a instanceof o&&(void 0===d||null==d)&&!0==a.isPrivate){var t=s(a),u=t.tohex();return af(u,"DSA PRIVATE KEY")}if("PKCS5PRV"==b&&void 0!==R&&a instanceof R&&void 0!==d&&null!=d&&!0==a.isPrivate){var t=q(a),u=t.tohex();return void 0===e&&(e="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",u,d,e,g)}if("PKCS5PRV"==b&&void 0!==p&&a instanceof p&&void 0!==d&&null!=d&&!0==a.isPrivate){var t=r(a),u=t.tohex();return void 0===e&&(e="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",u,d,e,g)}if("PKCS5PRV"==b&&void 0!==o&&a instanceof o&&void 0!==d&&null!=d&&!0==a.isPrivate){var t=s(a),u=t.tohex();return void 0===e&&(e="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",u,d,e,g)}var y=function(a,b){if("string"==typeof b)return az.getEncryptedPKCS8PEM(a,b);if("object"==typeof b&&void 0!=ax(b,"passcode")){var c=JSON.parse(JSON.stringify(b)),d=c.passcode;return delete c.passcode,az.getEncryptedPKCS8PEM(a,d,c)}};if("PKCS8PRV"==b&&void 0!=R&&a instanceof R&&!0==a.isPrivate){var z=q(a),A=z.tohex(),t=l({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:A}}]}),u=t.tohex();return void 0===d||null==d?af(u,"PRIVATE KEY"):y(u,d)}if("PKCS8PRV"==b&&void 0!==p&&a instanceof p&&!0==a.isPrivate){var B={seq:[{int:1},{octstr:{hex:a.prvKeyHex}}]};"string"==typeof a.pubKeyHex&&B.seq.push({tag:["a1",!0,{bitstr:{hex:"00"+a.pubKeyHex}}]});var z=new l(B),A=z.tohex(),t=l({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:a.curveName}}]},{octstr:{hex:A}}]}),u=t.tohex();return void 0===d||null==d?af(u,"PRIVATE KEY"):y(u,d)}if("PKCS8PRV"==b&&void 0!==o&&a instanceof o&&!0==a.isPrivate){var z=new k({bigint:a.x}),A=z.tohex(),t=l({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:a.p}},{int:{bigint:a.q}},{int:{bigint:a.g}}]}]},{octstr:{hex:A}}]}),u=t.tohex();return void 0===d||null==d?af(u,"PRIVATE KEY"):y(u,d)}throw Error("unsupported object nor format")},az.getKeyFromCSRPEM=function(a){var b=ag(a,"CERTIFICATE REQUEST");return az.getKeyFromCSRHex(b)},az.getKeyFromCSRHex=function(a){var b=az.parseCSRHex(a);return az.getKey(b.p8pubkeyhex,null,"pkcs8pub")},az.parseCSRHex=function(a){var b=W.getChildIdx,c=W.getTLV,d={};if("30"!=a.substr(0,2))throw Error("malformed CSR(code:001)");var e=b(a,0);if(e.length<1)throw Error("malformed CSR(code:002)");if("30"!=a.substr(e[0],2))throw Error("malformed CSR(code:003)");var f=b(a,e[0]);if(f.length<3)throw Error("malformed CSR(code:004)");return d.p8pubkeyhex=c(a,f[2]),d},az.getKeyID=function(a){"string"==typeof a&&-1!=a.indexOf("BEGIN ")&&(a=az.getKey(a));var b=ag(az.getPEM(a)),d=W.getIdxbyList(b,0,[1]),e=W.getV(b,d).substring(2);return c.crypto.Util.hashHex(e,"sha1")},az.getJWK=function(a,b,d,e,f){var g,h,i={},k=c.crypto.Util.hashHex;if("string"==typeof a)g=az.getKey(a),-1!=a.indexOf("CERTIFICATE")&&(h=ag(a));else if("object"==typeof a)a instanceof aD?(g=a.getPublicKey(),h=a.hex):g=a;else throw Error("unsupported keyinfo type");if(g instanceof R&&g.isPrivate)i.kty="RSA",i.n=_(g.n.toString(16)),i.e=_(g.e.toString(16)),i.d=_(g.d.toString(16)),i.p=_(g.p.toString(16)),i.q=_(g.q.toString(16)),i.dp=_(g.dmp1.toString(16)),i.dq=_(g.dmq1.toString(16)),i.qi=_(g.coeff.toString(16));else if(g instanceof R&&g.isPublic)i.kty="RSA",i.n=_(g.n.toString(16)),i.e=_(g.e.toString(16));else if(g instanceof c.crypto.ECDSA&&g.isPrivate){var l=g.getShortNISTPCurveName();if("P-256"!==l&&"P-384"!==l&&"P-521"!==l)throw Error("unsupported curve name for JWT: "+l);var m=g.getPublicKeyXYHex();i.kty="EC",i.crv=l,i.x=_(m.x),i.y=_(m.y),i.d=_(g.prvKeyHex)}else if(g instanceof c.crypto.ECDSA&&g.isPublic){var l=g.getShortNISTPCurveName();if("P-256"!==l&&"P-384"!==l&&"P-521"!==l)throw Error("unsupported curve name for JWT: "+l);var m=g.getPublicKeyXYHex();i.kty="EC",i.crv=l,i.x=_(m.x),i.y=_(m.y)}if(void 0==i.kty)throw Error("unsupported keyinfo");return g.isPrivate||!0==b||(i.kid=c.jws.JWS.getJWKthumbprint(i)),void 0!=h&&!0!=d&&(i.x5c=[j(h)]),void 0!=h&&!0!=e&&(i.x5t=Z(j(k(h,"sha1")))),void 0!=h&&!0!=f&&(i["x5t#S256"]=Z(j(k(h,"sha256")))),i},az.getJWKFromKey=function(a){return az.getJWK(a,!0,!0,!0,!0)},R.getPosArrayOfChildrenFromHex=function(a){return W.getChildIdx(a,0)},R.getHexValueArrayOfChildrenFromHex=function(a){var b=W.getV,c=R.getPosArrayOfChildrenFromHex(a),d=b(a,c[0]),e=b(a,c[1]),f=b(a,c[2]),g=b(a,c[3]),h=b(a,c[4]),i=b(a,c[5]),j=b(a,c[6]),k=b(a,c[7]),l=b(a,c[8]),c=[];return c.push(d,e,f,g,h,i,j,k,l),c},R.prototype.readPrivateKeyFromPEMString=function(a){var b=ag(a),c=R.getHexValueArrayOfChildrenFromHex(b);this.setPrivateEx(c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8])},R.prototype.readPKCS5PrvKeyHex=function(a){var b=R.getHexValueArrayOfChildrenFromHex(a);this.setPrivateEx(b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])},R.prototype.readPKCS8PrvKeyHex=function(a){var b,c,d,e,f,g,h,i,j=W.getVbyListEx;if(!1===W.isASN1HEX(a))throw Error("not ASN.1 hex string");try{b=j(a,0,[2,0,1],"02"),c=j(a,0,[2,0,2],"02"),d=j(a,0,[2,0,3],"02"),e=j(a,0,[2,0,4],"02"),f=j(a,0,[2,0,5],"02"),g=j(a,0,[2,0,6],"02"),h=j(a,0,[2,0,7],"02"),i=j(a,0,[2,0,8],"02")}catch(a){throw Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(b,c,d,e,f,g,h,i)},R.prototype.readPKCS5PubKeyHex=function(a){var b=W.getV;if(!1===W.isASN1HEX(a))throw Error("keyHex is not ASN.1 hex string");var c=W.getChildIdx(a,0);if(2!==c.length||"02"!==a.substr(c[0],2)||"02"!==a.substr(c[1],2))throw Error("wrong hex for PKCS#5 public key");var d=b(a,c[0]),e=b(a,c[1]);this.setPublic(d,e)},R.prototype.readPKCS8PubKeyHex=function(a){if(!1===W.isASN1HEX(a))throw Error("not ASN.1 hex string");if("06092a864886f70d010101"!==W.getTLVbyListEx(a,0,[0,0]))throw Error("not PKCS8 RSA public key");var b=W.getTLVbyListEx(a,0,[1,0]);this.readPKCS5PubKeyHex(b)},R.prototype.readCertPubKeyHex=function(a,b){var c,d;(c=new aD).readCertHex(a),d=c.getPublicKeyHex(),this.readPKCS8PubKeyHex(d)},R.prototype.sign=function(a,b){var d=c.crypto.Util.hashString(a,b);return this.signWithMessageHash(d,b)},R.prototype.signWithMessageHash=function(a,b){var d=Q(c.crypto.Util.getPaddedDigestInfoHex(a,b,this.n.bitLength()),16);return aA(this.doPrivate(d).toString(16),this.n.bitLength())},R.prototype.signPSS=function(a,b,d){var e,f=(e=ae(a),c.crypto.Util.hashHex(e,b));return void 0===d&&(d=-1),this.signWithMessageHashPSS(f,b,d)},R.prototype.signWithMessageHashPSS=function(a,b,d){var e,f=ad(a),g=f.length,h=this.n.bitLength()-1,i=Math.ceil(h/8),j=function(a){return c.crypto.Util.hashHex(a,b)};if(-1===d||void 0===d)d=g;else if(-2===d)d=i-g-2;else if(d<-2)throw Error("invalid salt length");if(i<g+d+2)throw Error("data too long");var k="";d>0&&(k=Array(d),new P().nextBytes(k),k=String.fromCharCode.apply(String,k));var m=ad(j(ae("\0\0\0\0\0\0\0\0"+f+k))),n=[];for(e=0;e<i-d-g-2;e+=1)n[e]=0;var o=String.fromCharCode.apply(String,n)+"\x01"+k,p=aB(m,o.length,j),q=[];for(e=0;e<o.length;e+=1)q[e]=o.charCodeAt(e)^p.charCodeAt(e);for(q[0]&=~(65280>>8*i-h&255),e=0;e<g;e++)q.push(m.charCodeAt(e));return q.push(188),aA(this.doPrivate(new l(q)).toString(16),this.n.bitLength())},R.prototype.verify=function(a,b){if(null==(b=b.toLowerCase()).match(/^[0-9a-f]+$/))return!1;var d=Q(b,16),e=this.n.bitLength();if(d.bitLength()>e)return!1;var f=this.doPublic(d).toString(16);if(f.length+3!=e/4)return!1;var g=aC(f.replace(/^1f+00/,""));if(0==g.length)return!1;var h=g[0];return g[1]==c.crypto.Util.hashString(a,h)},R.prototype.verifyWithMessageHash=function(a,b){if(b.length!=Math.ceil(this.n.bitLength()/4))return!1;var c=Q(b,16);if(c.bitLength()>this.n.bitLength())return 0;var d=aC(this.doPublic(c).toString(16).replace(/^1f+00/,""));return 0!=d.length&&(d[0],d[1]==a)},R.prototype.verifyPSS=function(a,b,d,e){var f,g=(f=ae(a),c.crypto.Util.hashHex(f,d));return void 0===e&&(e=-1),this.verifyWithMessageHashPSS(g,b,d,e)},R.prototype.verifyWithMessageHashPSS=function(a,b,d,e){if(b.length!=Math.ceil(this.n.bitLength()/4))return!1;var f,g=new l(b,16),h=function(a){return c.crypto.Util.hashHex(a,d)},i=ad(a),j=i.length,k=this.n.bitLength()-1,m=Math.ceil(k/8);if(-1===e||void 0===e)e=j;else if(-2===e)e=m-j-2;else if(e<-2)throw Error("invalid salt length");if(m<j+e+2)throw Error("data too long");var n=this.doPublic(g).toByteArray();for(f=0;f<n.length;f+=1)n[f]&=255;for(;n.length<m;)n.unshift(0);if(188!==n[m-1])throw Error("encoded message does not end in 0xbc");var o=(n=String.fromCharCode.apply(String,n)).substr(0,m-j-1),p=n.substr(o.length,j),q=65280>>8*m-k&255;if((o.charCodeAt(0)&q)!=0)throw Error("bits beyond keysize not zero");var r=aB(p,o.length,h),s=[];for(f=0;f<o.length;f+=1)s[f]=o.charCodeAt(f)^r.charCodeAt(f);s[0]&=~q;var t=m-j-e-2;for(f=0;f<t;f+=1)if(0!==s[f])throw Error("leftmost octets not zero");if(1!==s[t])throw Error("0x01 marker not found");return p===ad(h(ae("\0\0\0\0\0\0\0\0"+i+String.fromCharCode.apply(String,s.slice(-e)))))},R.SALT_LEN_HLEN=-1,R.SALT_LEN_MAX=-2,R.SALT_LEN_RECOVER=-2,aD.EXT_PARSER={},aD.registExtParser=function(a,b){aD.EXT_PARSER[a]=b},aD.hex2dn=function(a,b){void 0===b&&(b=0);var c=new aD;return W.getTLV(a,b),c.getX500Name(a).str},aD.hex2rdn=function(a,b){if(void 0===b&&(b=0),"31"!==a.substr(b,2))throw Error("malformed RDN");for(var c=[],d=W.getChildIdx(a,b),e=0;e<d.length;e++)c.push(aD.hex2attrTypeValue(a,d[e]));return(c=c.map(function(a){return a.replace("+","\\+")})).join("+")},aD.hex2attrTypeValue=function(a,b){var d=W.getV;if(void 0===b&&(b=0),"30"!==a.substr(b,2))throw Error("malformed attribute type and value");var e=W.getChildIdx(a,b);2!==e.length||a.substr(e[0],2);var f=d(a,e[0]),g=c.asn1.ASN1Util.oidHexToInt(f);return c.asn1.x509.OID.oid2atype(g)+"="+ad(d(a,e[1]))},aD.getPublicKeyFromCertHex=function(a){var b=new aD;return b.readCertHex(a),b.getPublicKey()},aD.getPublicKeyFromCertPEM=function(a){var b=new aD;return b.readCertPEM(a),b.getPublicKey()},aD.getPublicKeyInfoPropOfCertPEM=function(a){var b,c,d=W.getVbyList,e={};return e.algparam=null,(b=new aD).readCertPEM(a),e.keyhex=d(c=b.getPublicKeyHex(),0,[1],"03").substr(2),e.algoid=d(c,0,[0,0],"06"),"2a8648ce3d0201"===e.algoid&&(e.algparam=d(c,0,[0,1],"06")),e},aD.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==c&&c||(c={}),void 0!==c.jws&&c.jws||(c.jws={}),c.jws.JWS=function(){var a=c.jws.JWS.isSafeJSONString;this.parseJWS=function(b,c){if(void 0===this.parsedJWS||!c&&void 0===this.parsedJWS.sigvalH){var d=b.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==d)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var f=d[1],g=d[2],h=d[3],i=f+"."+g;if(this.parsedJWS={},this.parsedJWS.headB64U=f,this.parsedJWS.payloadB64U=g,this.parsedJWS.sigvalB64U=h,this.parsedJWS.si=i,!c){var j=aa(h),k=Q(j,16);this.parsedJWS.sigvalH=j,this.parsedJWS.sigvalBI=k}var l=e(f),m=e(g);if(this.parsedJWS.headS=l,this.parsedJWS.payloadS=m,!a(l,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+l}}},c.jws.JWS.sign=function(a,b,e,f,g){var h,i,j,k=c,l=k.jws.JWS,m=l.readSafeJSONString,n=l.isSafeJSONString,o=k.crypto,p=(o.ECDSA,o.Mac),q=o.Signature,r=JSON;if("string"!=typeof b&&"object"!=typeof b)throw"spHeader must be JSON string or object: "+b;if("object"==typeof b&&(i=b,h=r.stringify(i)),"string"==typeof b){if(!n(h=b))throw"JWS Head is not safe JSON string: "+h;i=m(h)}if(j=e,"object"==typeof e&&(j=r.stringify(e)),(""==a||null==a)&&void 0!==i.alg&&(a=i.alg),""!=a&&null!=a&&void 0===i.alg&&(i.alg=a,h=r.stringify(i)),a!==i.alg)throw"alg and sHeader.alg doesn't match: "+a+"!="+i.alg;var s=null;if(void 0===l.jwsalg2sigalg[a])throw"unsupported alg name: "+a;s=l.jwsalg2sigalg[a];var t=d(h)+"."+d(j),u="";if("Hmac"==s.substr(0,4)){if(void 0===f)throw"mac key shall be specified for HS* alg";var v=new p({alg:s,prov:"cryptojs",pass:f});v.updateString(t),u=v.doFinal()}else if(-1!=s.indexOf("withECDSA")){var w=new q({alg:s});w.init(f,g),w.updateString(t);var x=w.sign();u=c.crypto.ECDSA.asn1SigToConcatSig(x)}else if("none"!=s){var w=new q({alg:s});w.init(f,g),w.updateString(t),u=w.sign()}return t+"."+_(u)},c.jws.JWS.verify=function(a,b,d){var f=c,g=f.jws.JWS,h=g.readSafeJSONString,i=f.crypto,j=i.ECDSA,k=i.Mac,l=i.Signature;if(!ar(a))return!1;var m=a.split(".");if(3!==m.length)return!1;var n=m[0]+"."+m[1],o=aa(m[2]),p=h(e(m[0])),q=null,r=null;if(void 0===p.alg)throw"algorithm not specified in header";if(r=(q=p.alg).substr(0,2),null!=d&&"[object Array]"===Object.prototype.toString.call(d)&&d.length>0&&-1==(":"+d.join(":")+":").indexOf(":"+q+":"))throw"algorithm '"+q+"' not accepted in the list";if("none"!=q&&null===b)throw"key shall be specified to verify.";if("string"==typeof b&&-1!=b.indexOf("-----BEGIN ")&&(b=az.getKey(b)),("RS"==r||"PS"==r)&&!(b instanceof R))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==r&&!(b instanceof j))throw"key shall be a ECDSA obj for ES* algs";var s=null;if(void 0===g.jwsalg2sigalg[p.alg])throw"unsupported alg name: "+q;if("none"==(s=g.jwsalg2sigalg[q]))throw"not supported";if("Hmac"==s.substr(0,4)){if(void 0===b)throw"hexadecimal key shall be specified for HMAC";var t=new k({alg:s,pass:b});return t.updateString(n),o==t.doFinal()}if(-1!=s.indexOf("withECDSA")){var u=null;try{u=j.concatSigToASN1Sig(o)}catch(a){return!1}var v=new l({alg:s});return v.init(b),v.updateString(n),v.verify(u)}var v=new l({alg:s});return v.init(b),v.updateString(n),v.verify(o)},c.jws.JWS.parse=function(a){var b,d,f,g=a.split("."),h={};if(2!=g.length&&3!=g.length)throw"malformed sJWS: wrong number of '.' splitted elements";return b=g[0],d=g[1],3==g.length&&(f=g[2]),h.headerObj=c.jws.JWS.readSafeJSONString(e(b)),h.payloadObj=c.jws.JWS.readSafeJSONString(e(d)),h.headerPP=JSON.stringify(h.headerObj,null,"  "),null==h.payloadObj?h.payloadPP=e(d):h.payloadPP=JSON.stringify(h.payloadObj,null,"  "),void 0!==f&&(h.sigHex=aa(f)),h},c.jws.JWS.verifyJWT=function(a,b,d){var f=c.jws,g=f.JWS,h=g.readSafeJSONString,i=g.inArray,j=g.includedArray;if(!ar(a))return!1;var k=a.split(".");if(3!=k.length)return!1;var l=k[0],m=k[1];aa(k[2]);var n=h(e(l)),o=h(e(m));if(void 0===n.alg)return!1;if(void 0===d.alg)throw"acceptField.alg shall be specified";if(!i(n.alg,d.alg)||void 0!==o.iss&&"object"==typeof d.iss&&!i(o.iss,d.iss)||void 0!==o.sub&&"object"==typeof d.sub&&!i(o.sub,d.sub))return!1;if(void 0!==o.aud&&"object"==typeof d.aud){if("string"==typeof o.aud){if(!i(o.aud,d.aud))return!1}else if("object"==typeof o.aud&&!j(o.aud,d.aud))return!1}var p=f.IntDate.getNow();return void 0!==d.verifyAt&&"number"==typeof d.verifyAt&&(p=d.verifyAt),(void 0===d.gracePeriod||"number"!=typeof d.gracePeriod)&&(d.gracePeriod=0),(void 0===o.exp||"number"!=typeof o.exp||!(o.exp+d.gracePeriod<p))&&(void 0===o.nbf||"number"!=typeof o.nbf||!(p<o.nbf-d.gracePeriod))&&(void 0===o.iat||"number"!=typeof o.iat||!(p<o.iat-d.gracePeriod))&&(void 0===o.jti||void 0===d.jti||o.jti===d.jti)&&!!g.verify(a,b,d.alg)&&!0},c.jws.JWS.includedArray=function(a,b){var d=c.jws.JWS.inArray;if(null===a||"object"!=typeof a||"number"!=typeof a.length)return!1;for(var e=0;e<a.length;e++)if(!d(a[e],b))return!1;return!0},c.jws.JWS.inArray=function(a,b){if(null===b||"object"!=typeof b||"number"!=typeof b.length)return!1;for(var c=0;c<b.length;c++)if(b[c]==a)return!0;return!1},c.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",ES512:"SHA512withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},c.jws.JWS.isSafeJSONString=function(a,b,c){var d=null;try{if(d=V(a),"object"!=typeof d||d.constructor===Array)return 0;return b&&(b[c]=d),1}catch(a){return 0}},c.jws.JWS.readSafeJSONString=function(a){var b=null;try{if(b=V(a),"object"!=typeof b||b.constructor===Array)return null;return b}catch(a){return null}},c.jws.JWS.getEncodedSignatureValueFromJWS=function(a){var b=a.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==b)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return b[1]},c.jws.JWS.getJWKthumbprint=function(a){if("RSA"!==a.kty&&"EC"!==a.kty&&"oct"!==a.kty)throw"unsupported algorithm for JWK Thumprint";var b="{";if("RSA"===a.kty){if("string"!=typeof a.n||"string"!=typeof a.e)throw"wrong n and e value for RSA key";b+='"e":"'+a.e+'",'+('"kty":"'+a.kty)+'",'+('"n":"'+a.n)+'"}'}else if("EC"===a.kty){if("string"!=typeof a.crv||"string"!=typeof a.x||"string"!=typeof a.y)throw"wrong crv, x and y value for EC key";b+='"crv":"'+a.crv+'",'+('"kty":"'+a.kty)+'",'+('"x":"'+a.x)+'",'+('"y":"'+a.y)+'"}'}else if("oct"===a.kty){if("string"!=typeof a.k)throw"wrong k value for oct(symmetric) key";b+='"kty":"'+a.kty+'",'+('"k":"'+a.k)+'"}'}var d=ae(b);return _(c.crypto.Util.hashHex(d,"sha256"))},c.jws.IntDate={},c.jws.IntDate.get=function(a){var b=c.jws.IntDate,d=b.getNow,e=b.getZulu;if("now"==a)return d();if("now + 1hour"==a)return d()+3600;if("now + 1day"==a)return d()+86400;if("now + 1month"==a)return d()+2592e3;if("now + 1year"==a)return d()+31536e3;else if(a.match(/Z$/))return e(a);else if(a.match(/^[0-9]+$/))return parseInt(a);throw"unsupported format: "+a},c.jws.IntDate.getZulu=function(a){return Math.round(function(a){var b,c,d,e,f,g,h,i,j;if(j=(a=function(a){return a.match(/^[0-9]{12}Z$/)||a.match(/^[0-9]{12}[.][0-9]*Z$/)?a.match(/^[0-4]/)?"20"+a:"19"+a:a}(a)).match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return b=parseInt(j[1]),c=parseInt(j[2])-1,d=parseInt(j[3]),e=parseInt(j[4]),f=parseInt(j[5]),g=parseInt(j[6]),h=0,""!==(i=j[7])&&(h=parseInt((i.substr(1)+"00").substr(0,3))),Date.UTC(b,c,d,e,f,g,h);throw Error("unsupported zulu format: "+a)}(a)/1e3)},c.jws.IntDate.getNow=function(){return~~(new Date/1e3)},c.jws.IntDate.intDate2UTCString=function(a){return new Date(1e3*a).toUTCString()},c.jws.IntDate.intDate2Zulu=function(a){var b=new Date(1e3*a);return("0000"+b.getUTCFullYear()).slice(-4)+("00"+(b.getUTCMonth()+1)).slice(-2)+("00"+b.getUTCDate()).slice(-2)+("00"+b.getUTCHours()).slice(-2)+("00"+b.getUTCMinutes()).slice(-2)+("00"+b.getUTCSeconds()).slice(-2)+"Z"},void 0!==c&&c||(c={}),void 0!==c.jws&&c.jws||(c.jws={}),c.jws.JWSJS=function(){var a=c.jws.JWS,b=a.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(a){this.init();var b=a.split(".");if(3!=b.length)throw"malformed input JWS";this.aHeader.push(b[0]),this.sPayload=b[1],this.aSignature.push(b[2])},this.addSignature=function(a,b,d,e){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var f=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var g=c.jws.JWS.sign(a,b,this.sPayload,d,e).split(".");g[0],g[2],this.aHeader.push(g[0]),this.aSignature.push(g[2])}catch(a){throw this.aHeader.length>f&&this.aHeader.pop(),this.aSignature.length>f&&this.aSignature.pop(),"addSignature failed: "+a}},this.verifyAll=function(a){if(this.aHeader.length!==a.length||this.aSignature.length!==a.length)return!1;for(var b=0;b<a.length;b++){var c=a[b];if(2!==c.length||!1===this.verifyNth(b,c[0],c[1]))return!1}return!0},this.verifyNth=function(b,c,d){if(this.aHeader.length<=b||this.aSignature.length<=b)return!1;var e=this.aHeader[b],f=this.aSignature[b],g=e+"."+this.sPayload+"."+f,h=!1;try{h=a.verify(g,c,d)}catch(a){return!1}return h},this.readJWSJS=function(a){if("string"==typeof a){var c=b(a);if(null==c)throw"argument is not safe JSON object string";this.aHeader=c.headers,this.sPayload=c.payload,this.aSignature=c.signatures}else try{if(a.headers.length>0)this.aHeader=a.headers;else throw"malformed header";if("string"==typeof a.payload)this.sPayload=a.payload;else throw"malformed signatures";if(a.signatures.length>0)this.aSignature=a.signatures;else throw"malformed signatures"}catch(a){throw"malformed JWS-JS JSON object: "+a}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return+(0==this.aHeader.length)}},c.crypto.ECDSA,c.crypto.DSA,c.crypto.Signature,c.crypto.MessageDigest,c.crypto.Mac,b.pj=c,c.crypto,c.asn1,c.jws,c.lang},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},96487:()=>{}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[586,692],()=>b(b.s=8483));module.exports=c})();